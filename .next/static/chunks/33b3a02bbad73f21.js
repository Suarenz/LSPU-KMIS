(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,70065,e=>{"use strict";var t=e.i(43476),r=e.i(47163);function s({className:e,...s}){return(0,t.jsx)("div",{"data-slot":"card",className:(0,r.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",e),...s})}function a({className:e,...s}){return(0,t.jsx)("div",{"data-slot":"card-header",className:(0,r.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",e),...s})}function n({className:e,...s}){return(0,t.jsx)("div",{"data-slot":"card-title",className:(0,r.cn)("leading-none font-semibold",e),...s})}function i({className:e,...s}){return(0,t.jsx)("div",{"data-slot":"card-description",className:(0,r.cn)("text-muted-foreground text-sm",e),...s})}function o({className:e,...s}){return(0,t.jsx)("div",{"data-slot":"card-content",className:(0,r.cn)("px-6",e),...s})}e.s(["Card",()=>s,"CardContent",()=>o,"CardDescription",()=>i,"CardHeader",()=>a,"CardTitle",()=>n])},10708,e=>{"use strict";var t=e.i(43476),r=e.i(71645),s=e.i(48425),a=r.forwardRef((e,r)=>(0,t.jsx)(s.Primitive.label,{...e,ref:r,onMouseDown:t=>{t.target.closest("button, input, select, textarea")||(e.onMouseDown?.(t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));a.displayName="Label";var n=e.i(47163);function i({className:e,...r}){return(0,t.jsx)(a,{"data-slot":"label",className:(0,n.cn)("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",e),...r})}e.s(["Label",()=>i],10708)},23750,e=>{"use strict";var t=e.i(43476),r=e.i(47163);function s({className:e,type:s,...a}){return(0,t.jsx)("input",{type:s,"data-slot":"input",className:(0,r.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",e),...a})}e.s(["Input",()=>s])},59411,e=>{"use strict";var t=e.i(71645),r=e.i(48425),s=e.i(43476),a=t.forwardRef((e,t)=>(0,s.jsx)(r.Primitive.span,{...e,ref:t,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...e.style}}));a.displayName="VisuallyHidden",e.s(["Root",()=>a,"VisuallyHidden",()=>a])},7486,e=>{"use strict";let t=(0,e.i(75254).default)("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);e.s(["Building2",()=>t],7486)},73375,e=>{"use strict";let t=(0,e.i(75254).default)("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);e.s(["ChevronLeft",()=>t],73375)},12900,e=>{"use strict";var t=e.i(43476),r=e.i(71645);function s({children:e,fallback:s=null}){let[a,n]=(0,r.useState)(!1);return((0,r.useEffect)(()=>{n(!0)},[]),a)?(0,t.jsx)(t.Fragment,{children:e}):(0,t.jsx)(t.Fragment,{children:s})}e.s(["ClientOnly",()=>s])},74117,e=>{"use strict";var t=e.i(71645);let r=0,s=new Map,a=e=>{if(s.has(e))return;let t=setTimeout(()=>{s.delete(e),o({type:"REMOVE_TOAST",toastId:e})},1e6);s.set(e,t)},n=[],i={toasts:[]};function o(e){i=((e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:r}=t;return r?a(r):e.toasts.forEach(e=>{a(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===r||void 0===r?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}})(i,e),n.forEach(e=>{e(i)})}function l({...e}){let t=(r=(r+1)%Number.MAX_SAFE_INTEGER).toString(),s=()=>o({type:"DISMISS_TOAST",toastId:t});return o({type:"ADD_TOAST",toast:{...e,id:t,open:!0,onOpenChange:e=>{e||s()}}}),{id:t,dismiss:s,update:e=>o({type:"UPDATE_TOAST",toast:{...e,id:t}})}}function d(){let[e,r]=t.useState(i);return t.useEffect(()=>(n.push(r),()=>{let e=n.indexOf(r);e>-1&&n.splice(e,1)}),[e]),{...e,toast:l,dismiss:e=>o({type:"DISMISS_TOAST",toastId:e})}}e.s(["useToast",()=>d])},63059,78237,e=>{"use strict";var t=e.i(46349);e.s(["ChevronRight",()=>t.default],63059);var r=e.i(43476),s=e.i(67881),a=e.i(71645),n=e.i(81140),i=e.i(20783),o=e.i(30030),l=e.i(26330),d=e.i(10772),c=e.i(53660),u=e.i(74606),p=e.i(96626),m=e.i(48425),x=e.i(91918),h=e.i(69340),f=e.i(59411),[g,v]=(0,o.createContextScope)("Tooltip",[c.createPopperScope]),b=(0,c.createPopperScope)(),y="TooltipProvider",j="tooltip.open",[w,N]=g(y),C=e=>{let{__scopeTooltip:t,delayDuration:s=700,skipDelayDuration:n=300,disableHoverableContent:i=!1,children:o}=e,[l,d]=a.useState(!0),c=a.useRef(!1),u=a.useRef(0);return a.useEffect(()=>{let e=u.current;return()=>window.clearTimeout(e)},[]),(0,r.jsx)(w,{scope:t,isOpenDelayed:l,delayDuration:s,onOpen:a.useCallback(()=>{window.clearTimeout(u.current),d(!1)},[]),onClose:a.useCallback(()=>{window.clearTimeout(u.current),u.current=window.setTimeout(()=>d(!0),n)},[n]),isPointerInTransitRef:c,onPointerInTransitChange:a.useCallback(e=>{c.current=e},[]),disableHoverableContent:i,children:o})};C.displayName=y;var T="Tooltip",[k,S]=g(T),E=e=>{let{__scopeTooltip:t,children:s,open:n,defaultOpen:i=!1,onOpenChange:o,disableHoverableContent:l,delayDuration:u}=e,p=N(T,e.__scopeTooltip),m=b(t),[x,f]=a.useState(null),g=(0,d.useId)(),v=a.useRef(0),y=l??p.disableHoverableContent,w=u??p.delayDuration,C=a.useRef(!1),[S=!1,E]=(0,h.useControllableState)({prop:n,defaultProp:i,onChange:e=>{e?(p.onOpen(),document.dispatchEvent(new CustomEvent(j))):p.onClose(),o?.(e)}}),A=a.useMemo(()=>S?C.current?"delayed-open":"instant-open":"closed",[S]),L=a.useCallback(()=>{window.clearTimeout(v.current),v.current=0,C.current=!1,E(!0)},[E]),R=a.useCallback(()=>{window.clearTimeout(v.current),v.current=0,E(!1)},[E]),M=a.useCallback(()=>{window.clearTimeout(v.current),v.current=window.setTimeout(()=>{C.current=!0,E(!0),v.current=0},w)},[w,E]);return a.useEffect(()=>()=>{v.current&&(window.clearTimeout(v.current),v.current=0)},[]),(0,r.jsx)(c.Root,{...m,children:(0,r.jsx)(k,{scope:t,contentId:g,open:S,stateAttribute:A,trigger:x,onTriggerChange:f,onTriggerEnter:a.useCallback(()=>{p.isOpenDelayed?M():L()},[p.isOpenDelayed,M,L]),onTriggerLeave:a.useCallback(()=>{y?R():(window.clearTimeout(v.current),v.current=0)},[R,y]),onOpen:L,onClose:R,disableHoverableContent:y,children:s})})};E.displayName=T;var A="TooltipTrigger",L=a.forwardRef((e,t)=>{let{__scopeTooltip:s,...o}=e,l=S(A,s),d=N(A,s),u=b(s),p=a.useRef(null),x=(0,i.useComposedRefs)(t,p,l.onTriggerChange),h=a.useRef(!1),f=a.useRef(!1),g=a.useCallback(()=>h.current=!1,[]);return a.useEffect(()=>()=>document.removeEventListener("pointerup",g),[g]),(0,r.jsx)(c.Anchor,{asChild:!0,...u,children:(0,r.jsx)(m.Primitive.button,{"aria-describedby":l.open?l.contentId:void 0,"data-state":l.stateAttribute,...o,ref:x,onPointerMove:(0,n.composeEventHandlers)(e.onPointerMove,e=>{"touch"!==e.pointerType&&(f.current||d.isPointerInTransitRef.current||(l.onTriggerEnter(),f.current=!0))}),onPointerLeave:(0,n.composeEventHandlers)(e.onPointerLeave,()=>{l.onTriggerLeave(),f.current=!1}),onPointerDown:(0,n.composeEventHandlers)(e.onPointerDown,()=>{h.current=!0,document.addEventListener("pointerup",g,{once:!0})}),onFocus:(0,n.composeEventHandlers)(e.onFocus,()=>{h.current||l.onOpen()}),onBlur:(0,n.composeEventHandlers)(e.onBlur,l.onClose),onClick:(0,n.composeEventHandlers)(e.onClick,l.onClose)})})});L.displayName=A;var R="TooltipPortal",[M,P]=g(R,{forceMount:void 0}),U=e=>{let{__scopeTooltip:t,forceMount:s,children:a,container:n}=e,i=S(R,t);return(0,r.jsx)(M,{scope:t,forceMount:s,children:(0,r.jsx)(p.Presence,{present:s||i.open,children:(0,r.jsx)(u.Portal,{asChild:!0,container:n,children:a})})})};U.displayName=R;var D="TooltipContent",O=a.forwardRef((e,t)=>{let s=P(D,e.__scopeTooltip),{forceMount:a=s.forceMount,side:n="top",...i}=e,o=S(D,e.__scopeTooltip);return(0,r.jsx)(p.Presence,{present:a||o.open,children:o.disableHoverableContent?(0,r.jsx)(H,{side:n,...i,ref:t}):(0,r.jsx)(I,{side:n,...i,ref:t})})}),I=a.forwardRef((e,t)=>{let s=S(D,e.__scopeTooltip),n=N(D,e.__scopeTooltip),o=a.useRef(null),l=(0,i.useComposedRefs)(t,o),[d,c]=a.useState(null),{trigger:u,onClose:p}=s,m=o.current,{onPointerInTransitChange:x}=n,h=a.useCallback(()=>{c(null),x(!1)},[x]),f=a.useCallback((e,t)=>{let r,s=e.currentTarget,a={x:e.clientX,y:e.clientY},n=function(e,t){let r=Math.abs(t.top-e.y),s=Math.abs(t.bottom-e.y),a=Math.abs(t.right-e.x),n=Math.abs(t.left-e.x);switch(Math.min(r,s,a,n)){case n:return"left";case a:return"right";case r:return"top";case s:return"bottom";default:throw Error("unreachable")}}(a,s.getBoundingClientRect());c(((r=[...function(e,t,r=5){let s=[];switch(t){case"top":s.push({x:e.x-r,y:e.y+r},{x:e.x+r,y:e.y+r});break;case"bottom":s.push({x:e.x-r,y:e.y-r},{x:e.x+r,y:e.y-r});break;case"left":s.push({x:e.x+r,y:e.y-r},{x:e.x+r,y:e.y+r});break;case"right":s.push({x:e.x-r,y:e.y-r},{x:e.x-r,y:e.y+r})}return s}(a,n),...function(e){let{top:t,right:r,bottom:s,left:a}=e;return[{x:a,y:t},{x:r,y:t},{x:r,y:s},{x:a,y:s}]}(t.getBoundingClientRect())].slice()).sort((e,t)=>e.x<t.x?-1:e.x>t.x?1:e.y<t.y?-1:1*!!(e.y>t.y)),function(e){if(e.length<=1)return e.slice();let t=[];for(let r=0;r<e.length;r++){let s=e[r];for(;t.length>=2;){let e=t[t.length-1],r=t[t.length-2];if((e.x-r.x)*(s.y-r.y)>=(e.y-r.y)*(s.x-r.x))t.pop();else break}t.push(s)}t.pop();let r=[];for(let t=e.length-1;t>=0;t--){let s=e[t];for(;r.length>=2;){let e=r[r.length-1],t=r[r.length-2];if((e.x-t.x)*(s.y-t.y)>=(e.y-t.y)*(s.x-t.x))r.pop();else break}r.push(s)}return(r.pop(),1===t.length&&1===r.length&&t[0].x===r[0].x&&t[0].y===r[0].y)?t:t.concat(r)}(r))),x(!0)},[x]);return a.useEffect(()=>()=>h(),[h]),a.useEffect(()=>{if(u&&m){let e=e=>f(e,m),t=e=>f(e,u);return u.addEventListener("pointerleave",e),m.addEventListener("pointerleave",t),()=>{u.removeEventListener("pointerleave",e),m.removeEventListener("pointerleave",t)}}},[u,m,f,h]),a.useEffect(()=>{if(d){let e=e=>{let t=e.target,r={x:e.clientX,y:e.clientY},s=u?.contains(t)||m?.contains(t),a=!function(e,t){let{x:r,y:s}=e,a=!1;for(let e=0,n=t.length-1;e<t.length;n=e++){let i=t[e].x,o=t[e].y,l=t[n].x,d=t[n].y;o>s!=d>s&&r<(l-i)*(s-o)/(d-o)+i&&(a=!a)}return a}(r,d);s?h():a&&(h(),p())};return document.addEventListener("pointermove",e),()=>document.removeEventListener("pointermove",e)}},[u,m,d,p,h]),(0,r.jsx)(H,{...e,ref:l})}),[B,_]=g(T,{isInside:!1}),H=a.forwardRef((e,t)=>{let{__scopeTooltip:s,children:n,"aria-label":i,onEscapeKeyDown:o,onPointerDownOutside:d,...u}=e,p=S(D,s),m=b(s),{onClose:h}=p;return a.useEffect(()=>(document.addEventListener(j,h),()=>document.removeEventListener(j,h)),[h]),a.useEffect(()=>{if(p.trigger){let e=e=>{let t=e.target;t?.contains(p.trigger)&&h()};return window.addEventListener("scroll",e,{capture:!0}),()=>window.removeEventListener("scroll",e,{capture:!0})}},[p.trigger,h]),(0,r.jsx)(l.DismissableLayer,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:o,onPointerDownOutside:d,onFocusOutside:e=>e.preventDefault(),onDismiss:h,children:(0,r.jsxs)(c.Content,{"data-state":p.stateAttribute,...m,...u,ref:t,style:{...u.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[(0,r.jsx)(x.Slottable,{children:n}),(0,r.jsx)(B,{scope:s,isInside:!0,children:(0,r.jsx)(f.Root,{id:p.contentId,role:"tooltip",children:i||n})})]})})});O.displayName=D;var $="TooltipArrow",z=a.forwardRef((e,t)=>{let{__scopeTooltip:s,...a}=e,n=b(s);return _($,s).isInside?null:(0,r.jsx)(c.Arrow,{...n,...a,ref:t})});z.displayName=$;var F=e.i(47163);function V({delayDuration:e=0,...t}){return(0,r.jsx)(C,{"data-slot":"tooltip-provider",delayDuration:e,...t})}function X({...e}){return(0,r.jsx)(V,{children:(0,r.jsx)(E,{"data-slot":"tooltip",...e})})}function q({...e}){return(0,r.jsx)(L,{"data-slot":"tooltip-trigger",...e})}function G({className:e,sideOffset:t=0,children:s,...a}){return(0,r.jsx)(U,{children:(0,r.jsxs)(O,{"data-slot":"tooltip-content",sideOffset:t,className:(0,F.cn)("bg-foreground text-background animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-fit origin-(--radix-tooltip-content-transform-origin) rounded-md px-3 py-1.5 text-xs text-balance",e),...a,children:[s,(0,r.jsx)(z,{className:"bg-foreground fill-foreground z-50 size-2.5 translate-y-[calc(-50%_-_2px)] rotate-45 rounded-[2px]"})]})})}var J=e.i(7486);let K=(0,e.i(75254).default)("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);var Y=e.i(18566);function Z({units:e,currentUnit:t,onUnitSelect:a,userRole:n,userUnit:i}){(0,Y.usePathname)();let o=(0,Y.useRouter)();return(0,r.jsxs)("div",{className:"w-64 bg-white border-r p-4 h-full flex flex-col",style:{boxShadow:"2px 0 4px rgba(0,0,0,0.05)"},children:[(0,r.jsx)("div",{className:"mb-6",children:(0,r.jsxs)("div",{className:"mb-3 flex items-center gap-2",children:[(0,r.jsx)("div",{className:"p-2 rounded-lg",style:{backgroundColor:"rgba(43, 67, 133, 0.1)"},children:(0,r.jsx)(J.Building2,{className:"w-6 h-6",style:{color:"#2B4385"}})}),(0,r.jsx)("h2",{className:"text-xl font-bold",style:{color:"#2B4385"},children:"Units"})]})}),(0,r.jsx)("div",{className:"space-y-1 flex-1 py-2 overflow-y-auto max-h-[calc(100vh-150px)]",children:(0,r.jsx)(V,{children:e.map(e=>{let n=t===e.id;return(0,r.jsx)("div",{className:"mb-1",children:(0,r.jsxs)(X,{children:[(0,r.jsx)(q,{asChild:!0,children:(0,r.jsx)(s.Button,{variant:"ghost",className:"w-full justify-start h-auto transition-all duration-200 max-w-full overflow-hidden relative",style:{padding:"12px 16px",backgroundColor:n?"rgba(43, 67, 133, 0.1)":"transparent",borderLeft:n?"4px solid #2B4385":"4px solid transparent",borderRadius:"0 8px 8px 0"},onClick:()=>{a(e.id)},children:(0,r.jsxs)("div",{className:"flex-1 text-left min-w-0 overflow-hidden",children:[(0,r.jsx)("div",{className:"font-semibold truncate",style:{fontSize:"16px",color:n?"#2B4385":"#374151"},children:e.code||e.name}),e.code&&(0,r.jsx)("div",{className:"mt-1 leading-tight truncate",style:{fontSize:"14px",color:n?"#2B4385":"#6B7280"},children:e.name})]})})}),(0,r.jsx)(G,{children:(0,r.jsx)("p",{children:e.name})})]})},e.id)})})}),("ADMIN"===n||"UNIT_ADMIN"===n||"ADMIN"===n)&&(0,r.jsx)("div",{className:"mt-auto pt-4 border-t border-gray-200 sticky bottom-0 bg-white",children:(0,r.jsxs)(s.Button,{className:"w-full gap-2",style:{backgroundColor:"#2B4385",color:"white",borderRadius:"8px"},onClick:()=>o.push("/units/new"),children:[(0,r.jsx)(K,{className:"w-4 h-4"}),"Add New Unit"]})})]})}e.s(["UnitSidebar",()=>Z],78237)},15843,e=>{"use strict";var t=e.i(43476),r=e.i(71645),s=e.i(18566),a=e.i(91432),n=e.i(63780),i=e.i(67881),o=e.i(23750),l=e.i(47163);function d({className:e,...r}){return(0,t.jsx)("textarea",{"data-slot":"textarea",className:(0,l.cn)("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),...r})}var c=e.i(70065),u=e.i(10708),p=e.i(74117),m=e.i(60865),x=e.i(7486);let h=(0,e.i(75254).default)("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);var f=e.i(37727);function g({initialData:e,onSubmit:s,onCreated:a,onCancel:n}){let{toast:l}=(0,p.useToast)(),[g,v]=(0,r.useState)(e?.name||""),[b,y]=(0,r.useState)(e?.code||""),[j,w]=(0,r.useState)(e?.description||""),[N,C]=(0,r.useState)(!1),[T,k]=(0,r.useState)({}),S=async t=>{let r;if(t.preventDefault(),r={},g.trim()||(r.name="Unit name is required"),b.trim()&&b.length>10?r.code="Unit code must be 10 characters or less":b.trim()&&!/^[A-Z0-9 _-]+$/.test(b)&&(r.code="Unit code can only contain uppercase letters, numbers, spaces, underscores, and hyphens"),j.length>500&&(r.description="Description must be 500 characters or less"),k(r),0===Object.keys(r).length){C(!0);try{let t,r=await m.default.getAccessToken();if(!r)throw Error("No authentication token found");let n={name:g.trim(),code:b.trim()?b.trim().toUpperCase():void 0,description:j.trim()};if(!(t=e?await fetch(`/api/units/${e.id}`,{method:"PUT",headers:{Authorization:`Bearer ${r}`,"Content-Type":"application/json"},body:JSON.stringify(n)}):await fetch("/api/units",{method:"POST",headers:{Authorization:`Bearer ${r}`,"Content-Type":"application/json"},body:JSON.stringify(n)})).ok){let r=await t.json().catch(()=>({}));throw Error(r.error||`Failed to ${e?"update":"create"} unit: ${t.status} ${t.statusText}`)}let i=await t.json();s(i.unit),l({title:`Unit ${e?"updated":"created"} successfully`,description:`The unit "${i.unit.name}" has been ${e?"updated":"added"} to the system.`}),!e&&a&&a(i.unit),v(""),y(""),w(""),k({})}catch(t){console.error(`Error ${e?"updating":"creating"} unit:`,t),l({title:`Failed to ${e?"update":"create"} unit`,description:t instanceof Error?t.message:"An unexpected error occurred",variant:"destructive"})}finally{C(!1)}}};return(0,t.jsxs)(c.Card,{className:"w-full max-w-2xl mx-auto border-0 shadow-xl bg-gradient-to-br from-background to-muted",children:[(0,t.jsx)(c.CardHeader,{className:"pb-4",children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-10 h-10 rounded-lg bg-primary/10 flex items-center justify-center",children:(0,t.jsx)(x.Building2,{className:"w-5 h-5 text-primary"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)(c.CardTitle,{className:"text-2xl font-bold",children:e?"Edit Unit":"Create New Unit"}),(0,t.jsx)(c.CardDescription,{className:"mt-1",children:e?"Update the details for this academic unit.":"Add a new academic unit to the repository system. All fields are required unless marked optional."})]})]})}),(0,t.jsx)(c.CardContent,{children:(0,t.jsxs)("form",{onSubmit:S,className:"space-y-6",children:[(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("div",{className:"flex items-center gap-2",children:(0,t.jsxs)(u.Label,{htmlFor:"name",className:"text-base",children:["Unit Name ",(0,t.jsx)("span",{className:"text-destructive",children:"*"})]})}),(0,t.jsx)("div",{className:"relative",children:(0,t.jsx)(o.Input,{id:"name",value:g,onChange:e=>v(e.target.value),placeholder:"Enter full unit name (e.g., College of Arts and Sciences)",disabled:N,className:"py-5 text-lg"})}),T.name&&(0,t.jsxs)("p",{className:"text-sm text-destructive flex items-center gap-1 mt-1",children:[(0,t.jsx)(f.X,{className:"w-4 h-4"})," ",T.name]}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"The full name of the academic unit (e.g., College of Arts and Sciences)"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("div",{className:"flex items-center gap-2",children:(0,t.jsx)(u.Label,{htmlFor:"code",className:"text-base",children:"Unit Code"})}),(0,t.jsx)("div",{className:"relative",children:(0,t.jsx)(o.Input,{id:"code",value:b,onChange:e=>y(e.target.value.toUpperCase()),placeholder:"Enter unit code (e.g., CAS)",disabled:N,maxLength:10,className:"py-5 text-lg"})}),T.code&&(0,t.jsxs)("p",{className:"text-sm text-destructive flex items-center gap-1 mt-1",children:[(0,t.jsx)(f.X,{className:"w-4 h-4"})," ",T.code]}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Short code for the unit (max 10 characters, uppercase letters, numbers, spaces, underscores, and hyphens only)"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("div",{className:"flex items-center gap-2",children:(0,t.jsx)(u.Label,{htmlFor:"description",className:"text-base",children:"Description"})}),(0,t.jsx)(d,{id:"description",value:j,onChange:e=>w(e.target.value),placeholder:"Enter unit description (optional)",disabled:N,maxLength:500,rows:4,className:"py-3"}),T.description&&(0,t.jsxs)("p",{className:"text-sm text-destructive flex items-center gap-1 mt-1",children:[(0,t.jsx)(f.X,{className:"w-4 h-4"})," ",T.description]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Brief description of the unit (max 50 characters)"}),(0,t.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:[j.length,"/500"]})]})]})]}),(0,t.jsxs)("div",{className:"flex justify-end gap-3 pt-6 border-t",children:[(0,t.jsx)(i.Button,{type:"button",variant:"outline",onClick:n,disabled:N,className:"px-6",children:"Cancel"}),(0,t.jsx)(i.Button,{type:"submit",disabled:N,className:"px-6 bg-gradient-to-r from-primary to-primary/90 hover:from-primary/90 hover:to-primary shadow-md",children:N?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{className:"mr-2",children:"Processing..."}),(0,t.jsx)("span",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(h,{className:"w-4 h-4 mr-2"}),e?"Update Unit":"Create Unit"]})})]})]})})]})}var v=e.i(73375),b=e.i(63059),y=e.i(12900),j=e.i(57688),w=e.i(78237);function N(){let e=(0,s.useRouter)(),{user:o,isAuthenticated:l,isLoading:d}=(0,a.useAuth)(),[u,p]=(0,r.useState)(!0),[h,f]=(0,r.useState)([]);return((0,r.useEffect)(()=>{let t=async()=>{try{if(!l||!o)return void e.push("/");let t=await m.default.getAccessToken();if(!t){await m.default.logout(),e.push("/");return}let r=await fetch("/api/units",{headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"}});if(!r.ok){let e=await r.json().catch(()=>({}));throw Error(e.error||`Failed to fetch units: ${r.status} ${r.statusText}`)}let s=await r.json();f(s.units||[])}catch(t){console.error("Error fetching units:",t),f([]),t instanceof Error&&t.message.includes("No authentication token found")&&e.push("/")}};l&&o&&t()},[l,o,e]),(0,r.useEffect)(()=>{d||l?!d&&l&&o&&"ADMIN"!==o.role&&e.push("/repository"):e.push("/")},[l,d,o,e]),!d&&(l||o))?l?o?"ADMIN"!==o.role?(0,t.jsx)("div",{className:"min-h-screen bg-background flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center max-w-md",children:[(0,t.jsx)("div",{className:"w-16 h-16 flex items-center justify-center mx-auto mb-4 overflow-hidden",children:(0,t.jsx)(x.Building2,{className:"w-12 h-12 text-muted-foreground"})}),(0,t.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"Access Denied"}),(0,t.jsx)("p",{className:"text-muted-foreground mb-4",children:"Only administrators can create new units. Contact your system administrator for access."}),(0,t.jsx)(i.Button,{onClick:()=>e.push("/repository"),children:"Go to Repository"})]})}):(0,t.jsx)(y.ClientOnly,{children:(0,t.jsxs)("div",{className:"min-h-screen bg-background",children:[(0,t.jsx)(n.Navbar,{}),(0,t.jsxs)("div",{className:"flex",children:[u&&(0,t.jsx)("div",{className:"w-64 border-r bg-muted/10 hidden lg:block",children:(0,t.jsx)(w.UnitSidebar,{units:h,currentUnit:null,onUnitSelect:t=>{t?e.push(`/units/${t}`):e.push("/repository")},userRole:o?.role||"",userUnit:o?.unitId||null})}),(0,t.jsx)("main",{className:"flex-1 lg:ml-0",children:(0,t.jsxs)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,t.jsx)("div",{className:"mb-8",children:(0,t.jsx)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(i.Button,{variant:"ghost",size:"icon",className:"lg:hidden",onClick:()=>p(!u),children:u?(0,t.jsx)(v.ChevronLeft,{className:"w-5 h-5"}):(0,t.jsx)(b.ChevronRight,{className:"w-5 h-5"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-foreground",children:"Create New Unit"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Add a new academic unit to the repository system"})]})]})})}),(0,t.jsxs)(c.Card,{className:"animate-fade-in",children:[(0,t.jsxs)(c.CardHeader,{children:[(0,t.jsxs)(c.CardTitle,{className:"flex items-center gap-2",children:[(0,t.jsx)(x.Building2,{className:"w-5 h-5"}),"Unit Information"]}),(0,t.jsx)(c.CardDescription,{children:"Enter the details for the new academic unit. The unit code should be a short identifier (e.g., CAS for College of Arts and Sciences)."})]}),(0,t.jsx)(c.CardContent,{children:(0,t.jsx)(g,{onSubmit:t=>{e.push("/repository"),e.refresh()},onCreated:t=>{setTimeout(()=>{e.push(`/units/${t.id}`),e.refresh()},1500)},onCancel:()=>{e.push("/repository")}})})]})]})})]})]})}):(0,t.jsx)("div",{className:"min-h-screen bg-background flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"w-16 h-16 flex items-center justify-center mx-auto mb-4 overflow-hidden",children:(0,t.jsx)(j.default,{src:"/LSPULogo.png",alt:"LSPU Logo",width:64,height:64,className:"object-contain animate-spin"})}),(0,t.jsx)("p",{className:"text-lg text-muted-foreground",children:"Loading user data..."})]})}):(0,t.jsx)("div",{className:"min-h-screen bg-background flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"w-16 h-16 flex items-center justify-center mx-auto mb-4 overflow-hidden",children:(0,t.jsx)(j.default,{src:"/LSPULogo.png",alt:"LSPU Logo",width:64,height:64,className:"object-contain animate-spin"})}),(0,t.jsx)("p",{className:"text-lg text-muted-foreground",children:"Redirecting to login..."})]})}):(0,t.jsx)("div",{className:"min-h-screen bg-background flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"w-16 h-16 flex items-center justify-center mx-auto mb-4 overflow-hidden",children:(0,t.jsx)(j.default,{src:"/LSPULogo.png",alt:"LSPU Logo",width:64,height:64,className:"object-contain animate-spin"})}),(0,t.jsx)("p",{className:"text-lg text-muted-foreground",children:"Loading..."})]})})}e.s(["default",()=>N],15843)}]);