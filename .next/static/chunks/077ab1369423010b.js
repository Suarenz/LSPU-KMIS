(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,30967,e=>{"use strict";var t=e.i(43476),s=e.i(71645),l=e.i(18566),a=e.i(60865),n=e.i(91432),r=e.i(63780),i=e.i(70065),o=e.i(67881),d=e.i(62870),c=e.i(27341),u=e.i(40160),m=e.i(86536),h=e.i(78583),x=e.i(73375),p=e.i(63059),g=e.i(69074),f=e.i(27612);let j=(0,e.i(75254).default)("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);var b=e.i(23585),w=e.i(78078),v=e.i(94008),N=e.i(94918),y=e.i(3559),C=e.i(57688),T=e.i(63415),k=e.i(12900),D=e.i(74117),E=e.i(78237),S=e.i(30374),A=e.i(30009);function L(){let{toast:e}=(0,D.useToast)(),{user:L,isAuthenticated:U,isLoading:$}=(0,n.useAuth)(),B=(0,l.useRouter)(),F=(0,l.useParams)().id,[z,P]=(0,s.useState)(null),[R,M]=(0,s.useState)([]),[I,O]=(0,s.useState)(!0),[Q,q]=(0,s.useState)(null),[V,Y]=(0,s.useState)(null),[H,K]=(0,s.useState)(!0),[J,X]=(0,s.useState)([]),[G,W]=(0,s.useState)(!1),[Z,_]=(0,s.useState)(!1),[ee,et]=(0,s.useState)(0),[es,el]=(0,s.useState)(null),[ea,en]=(0,s.useState)(null),[er,ei]=(0,s.useState)(!1),[eo,ed]=(0,s.useState)(null),[ec,eu]=(0,s.useState)(null),[em,eh]=(0,s.useState)(null),[ex,ep]=(0,s.useState)(null),[eg,ef]=(0,s.useState)(null),ej=L?.role==="ADMIN"||L?.role==="FACULTY";return((0,s.useEffect)(()=>{G||(et(0),_(!1),el(null),en(null))},[G]),(0,s.useEffect)(()=>{$||U||B.push("/")},[U,$,B]),(0,s.useEffect)(()=>{let e=async()=>{try{let e=await a.default.getAccessToken();if(!e)throw Error("No authentication token found");let t=await fetch("/api/units",{headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}});if(!t.ok){let e=await t.json().catch(()=>({}));throw Error(e.error||`Failed to fetch units: ${t.status} ${t.statusText}`)}let s=await t.json();X(s.units||[])}catch(e){console.error("Error fetching units:",e),X([]),q(e instanceof Error?e.message:"Failed to load units. Some functionality may be limited.")}};U&&L&&e()},[U,L]),(0,s.useEffect)(()=>{F&&(P(null),M([]),q(null))},[F]),(0,s.useEffect)(()=>{(async()=>{if(U&&!$&&L&&F)try{O(!0);let e=await a.default.getAccessToken();if(!e)throw Error("No authentication token found");let t=await fetch(`/api/units/${F}`,{headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}});if(!t.ok){let e=await t.json().catch(()=>({}));throw Error(e.error||`Failed to fetch unit: ${t.status} ${t.statusText}`)}let s=await t.json();P(s.unit);let l=new URLSearchParams({unit:F});ex&&l.append("year",ex.toString()),eg&&l.append("quarter",eg.toString());let n=await fetch(`/api/documents?${l.toString()}`,{headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}});if(!n.ok){let e=await n.json().catch(()=>({}));throw Error(e.error||`Failed to fetch documents: ${n.status} ${n.statusText}`)}let r=await n.json();M(r.documents||[]),q(null)}catch(e){console.error("Error fetching unit data:",e),q(e instanceof Error?e.message:"Failed to load unit data. Please try again later.")}finally{O(!1)}})()},[F,U,$,L,ex,eg]),(0,s.useEffect)(()=>{let e=async()=>{if("visible"===document.visibilityState&&F){let e=a.default.getLastAuthCheck(),t=Date.now();if(!e||t-e>3e5){console.log("Page became visible, refreshing unit documents");try{let e=await a.default.getAccessToken();if(e){let s=await fetch(`/api/documents?unit=${F}`,{headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}});if(!s.ok){let e=await s.json().catch(()=>({}));if(401===s.status){console.error("Authentication token expired, redirecting to login"),B.push("/");return}throw Error(e.error||`Failed to fetch documents: ${s.status} ${s.statusText}`)}let l=await s.json();M(l.documents||[]),q(null),a.default.setLastAuthCheck(t)}else console.log("No valid token found on visibility change, triggering auth revalidation"),await a.default.getCurrentUser()||(console.log("No current user found, redirecting to login"),B.push("/"))}catch(e){console.error("Error during visibility change document refresh:",e)}}}};return document.addEventListener("visibilitychange",e),()=>{document.removeEventListener("visibilitychange",e)}},[F,B]),!$||z&&U)?U||$?L||$?(0,t.jsx)(k.ClientOnly,{children:(0,t.jsxs)("div",{className:"min-h-screen bg-background",children:[(0,t.jsx)(r.Navbar,{}),(0,t.jsxs)("div",{className:"flex flex-col lg:flex-row",children:[H&&(0,t.jsx)("div",{className:"w-full lg:w-64 border-r bg-muted/10 lg:block hidden",children:(0,t.jsx)(E.UnitSidebar,{units:J,currentUnit:F,onUnitSelect:e=>{e?B.push(`/units/${e}`):B.push("/repository")},userRole:L?.role||"",userUnit:L?.unitId||null})}),(0,t.jsx)("main",{className:"flex-1",children:(0,t.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,t.jsx)("div",{className:"mb-8 animate-fade-in",children:(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(o.Button,{variant:"ghost",size:"icon",className:"lg:hidden",onClick:()=>K(!H),children:H?(0,t.jsx)(x.ChevronLeft,{className:"w-5 h-5"}):(0,t.jsx)(p.ChevronRight,{className:"w-5 h-5"})}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("h1",{className:"text-2xl md:text-3xl font-bold text-foreground mb-2",children:[z?.name||"Unit"," Documents"]}),(0,t.jsxs)("p",{className:"text-muted-foreground",children:["All documents for ",z?.name||"this unit",ex&&` • ${ex}`,eg&&` Q${eg}`]})]})]}),(0,t.jsxs)("div",{className:"flex flex-wrap gap-2",children:[U&&L&&ej&&(0,t.jsxs)(o.Button,{className:"gap-2",onClick:()=>W(!0),children:[(0,t.jsx)(g.Upload,{className:"w-4 h-4"}),"Upload Document"]}),U&&L&&(0,t.jsxs)(o.Button,{className:"gap-2",onClick:()=>B.push("/repository"),children:[(0,t.jsx)(h.FileText,{className:"w-4 h-4"}),"View All Documents"]})]})]})}),(0,t.jsx)("div",{className:"mb-6 animate-fade-in",children:(0,t.jsx)(i.Card,{className:"p-4",children:(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 items-start sm:items-center",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(j,{className:"w-4 h-4 text-muted-foreground"}),(0,t.jsx)("span",{className:"text-sm font-medium",children:"Filter by Period:"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("label",{className:"text-sm text-muted-foreground whitespace-nowrap",children:"Year:"}),(0,t.jsxs)(d.Select,{value:ex?.toString()||"all",onValueChange:e=>ep("all"===e?null:parseInt(e)),children:[(0,t.jsx)(d.SelectTrigger,{className:"w-[120px]",children:(0,t.jsx)(d.SelectValue,{placeholder:"All Years"})}),(0,t.jsxs)(d.SelectContent,{children:[(0,t.jsx)(d.SelectItem,{value:"all",children:"All Years"}),[2025,2026,2027,2028,2029].map(e=>(0,t.jsx)(d.SelectItem,{value:e.toString(),children:e},e))]})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("label",{className:"text-sm text-muted-foreground whitespace-nowrap",children:"Quarter:"}),(0,t.jsx)(c.Tabs,{value:eg?.toString()||"all",onValueChange:e=>ef("all"===e?null:parseInt(e)),children:(0,t.jsxs)(c.TabsList,{children:[(0,t.jsx)(c.TabsTrigger,{value:"all",className:"px-3",children:"All"}),[1,2,3,4].map(e=>(0,t.jsxs)(c.TabsTrigger,{value:e.toString(),className:"px-3",children:["Q",e]},e))]})})]}),(ex||eg)&&(0,t.jsx)(o.Button,{variant:"ghost",size:"sm",onClick:()=>{ep(null),ef(null)},children:"Clear Filters"})]})})}),eo&&(0,t.jsxs)("div",{className:"mb-4 p-3 bg-green-10 text-green-80 rounded-md flex items-center gap-2 animate-fade-in",children:[(0,t.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 20 20",fill:"currentColor",children:(0,t.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 10-16 8 8 0 00 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 0 01.414 0l4-4z",clipRule:"evenodd"})}),eo]}),I?(0,t.jsx)("div",{className:"animate-fade-in",children:(0,t.jsx)("div",{className:"flex justify-center py-12",children:(0,t.jsx)("div",{className:"w-16 h-16 flex items-center justify-center",children:(0,t.jsx)(C.default,{src:"/LSPULogo.png",alt:"LSPULogo",width:64,height:64,className:"object-contain animate-spin"})})})}):Q?(0,t.jsx)(i.Card,{className:"animate-fade-in",children:(0,t.jsxs)(i.CardContent,{className:"py-12 text-center",children:[(0,t.jsx)("div",{className:"text-destructive mb-4",children:"⚠️"}),(0,t.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Error Loading Documents"}),(0,t.jsx)("p",{className:"text-muted-foreground mb-4",children:Q}),(0,t.jsx)(o.Button,{onClick:()=>window.location.reload(),children:"Retry"})]})}):(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:R.map((s,l)=>{var n;let{icon:r,color:i,bgColor:d}=(e=>{let t=e.split(".").pop()?.toLowerCase()||"";if(["pdf"].includes(t))return{icon:h.FileText,color:"#DC2626",bgColor:"rgba(220, 38, 38, 0.1)"};if(["doc","docx"].includes(t))return{icon:h.FileText,color:"#2563EB",bgColor:"rgba(37, 99, 235, 0.1)"};if(["xls","xlsx","csv"].includes(t))return{icon:N.FileSpreadsheet,color:"#16A34A",bgColor:"rgba(22, 163, 74, 0.1)"};if(["ppt","pptx"].includes(t))return{icon:h.FileText,color:"#EA580C",bgColor:"rgba(234, 88, 12, 0.1)"};if(["jpg","jpeg","png","gif"].includes(t))return{icon:y.FileImage,color:"#7C3AED",bgColor:"rgba(124, 58, 237, 0.1)"};else return{icon:v.File,color:"#6B7280",bgColor:"rgba(107, 114, 128, 0.1)"}})(s.fileName||s.title),c=L&&("ADMIN"===L.role||s.uploadedById===L.id);return(0,t.jsxs)("div",{className:"animate-fade-in bg-white rounded-xl overflow-hidden transition-all duration-300 hover:shadow-xl group flex flex-col",style:{animationDelay:`${.05*l}s`,boxShadow:"0 4px 6px -1px rgba(0,0,0,0.1), 0 2px 4px -1px rgba(0,0,0,0.06)",borderRadius:"12px"},onMouseEnter:e=>{e.currentTarget.style.transform="translateY(-4px)"},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0)"},children:[(0,t.jsxs)("div",{className:"p-4 pb-0 flex-1 flex flex-col",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between gap-2 mb-3",children:[(0,t.jsx)("div",{className:"w-12 h-12 rounded-lg flex items-center justify-center shrink-0",style:{backgroundColor:d},children:(0,t.jsx)(r,{className:"w-6 h-6",style:{color:i}})}),(c||s.isQproDocument)&&(0,t.jsxs)(T.DropdownMenu,{children:[(0,t.jsx)(T.DropdownMenuTrigger,{asChild:!0,children:(0,t.jsx)(o.Button,{variant:"ghost",size:"icon",className:"h-8 w-8 opacity-0 group-hover:opacity-100 transition-opacity",children:(0,t.jsx)(b.MoreVertical,{className:"w-4 h-4 text-gray-500"})})}),(0,t.jsxs)(T.DropdownMenuContent,{align:"end",children:[s.isQproDocument&&(0,t.jsxs)(T.DropdownMenuItem,{onClick:async t=>{t.stopPropagation();try{let t=await a.default.getAccessToken();if(!t){await a.default.logout(),B.push("/");return}let l=await fetch(`/api/qpro/by-document/${s.id}`,{headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"}});if(l.ok){let t=await l.json();t.analysis?B.push(`/qpro/analysis/${t.analysis.id}`):e({title:"No Analysis Found",description:"This QPRO document hasn't been analyzed yet.",variant:"default"})}else e({title:"No Analysis Found",description:"This QPRO document hasn't been analyzed yet.",variant:"default"})}catch(t){console.error("Error fetching QPRO analysis:",t),e({title:"Error",description:"Failed to fetch QPRO analysis.",variant:"destructive"})}},children:[(0,t.jsx)(h.FileText,{className:"w-4 h-4 mr-2"}),"View QPRO Analysis"]}),c&&(0,t.jsxs)(T.DropdownMenuItem,{className:"text-red-600 focus:text-red-600 focus:bg-red-50",onClick:e=>{e.stopPropagation(),eh(s)},disabled:ec===s.id,children:[(0,t.jsx)(f.Trash2,{className:"w-4 h-4 mr-2"}),ec===s.id?"Deleting...":"Delete"]})]})]})]}),(0,t.jsx)("h4",{className:"text-lg font-semibold text-gray-900 line-clamp-2 mb-1 min-h-[3.5rem]",children:s.title.toLowerCase().split(" ").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ")}),(0,t.jsx)("p",{className:"text-sm text-gray-500 line-clamp-2 mb-3 min-h-[2.5rem]",children:s.description}),(0,t.jsxs)("p",{className:"text-xs text-gray-400 mb-3",children:["Uploaded by ",s.uploadedBy," • ",(n=s.fileSize)<1024?n+" B":n<1048576?(n/1024).toFixed(1)+" KB":(n/1048576).toFixed(1)+" MB"]}),(0,t.jsx)("div",{className:"flex flex-wrap gap-2 mb-4 min-h-[2rem]",children:s.category&&"Uncategorized"!==s.category&&(0,t.jsx)("span",{className:"px-3 py-1 text-xs font-medium rounded-full",style:{backgroundColor:"#F3F4F6",color:"#6B7280"},children:s.category})})]}),(0,t.jsxs)("div",{className:"px-4 pb-4 mt-auto",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 text-sm text-gray-500 mb-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(u.Download,{className:"w-4 h-4"}),(0,t.jsx)("span",{children:s.downloadsCount})]}),(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(m.Eye,{className:"w-4 h-4"}),(0,t.jsx)("span",{children:s.viewsCount})]}),(0,t.jsxs)("span",{className:"ml-auto text-xs",children:["v",s.version]})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[V===s.id?(0,t.jsxs)(o.Button,{className:"flex-1 gap-2",size:"sm",disabled:!0,style:{backgroundColor:"#2B4385",color:"white",borderRadius:"8px"},children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Downloading..."]}):(0,t.jsxs)(o.Button,{className:"flex-1 gap-2",size:"sm",style:{backgroundColor:"#2B4385",color:"white",borderRadius:"8px"},onClick:async e=>{e.stopPropagation(),Y(s.id);try{if(!U||!L)return;let e=await a.default.getAccessToken();if(!e){await a.default.logout(),B.push("/");return}let t=`/api/documents/${s.id}/download-direct?token=${e}`,l=document.createElement("a");l.href=t,l.download=s.fileName||`document-${s.id}`,document.body.appendChild(l),l.click(),document.body.removeChild(l)}catch(e){console.error("Download error:",e),alert(e instanceof Error?e.message:"Failed to download document.")}finally{Y(null)}},children:[(0,t.jsx)(u.Download,{className:"w-4 h-4"}),"Download"]}),(0,t.jsxs)(o.Button,{className:"gap-2",size:"sm",variant:"ghost",style:{color:"#2B4385",borderRadius:"8px"},onClick:t=>{t.stopPropagation(),s.id&&"undefined"!==s.id&&!s.id.includes("undefined")?B.push(`/repository/preview/${s.id}`):e({title:"Error",description:"Cannot preview this document.",variant:"destructive"})},children:[(0,t.jsx)(w.EyeIcon,{className:"w-4 h-4"}),"Preview"]})]})]})]},s.id)})}),0===R.length&&!I&&!Q&&(0,t.jsx)(i.Card,{className:"animate-fade-in",children:(0,t.jsxs)(i.CardContent,{className:"py-12 text-center",children:[(0,t.jsx)(h.FileText,{className:"w-12 h-12 text-muted-foreground mx-auto mb-4"}),(0,t.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"No documents found"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"This unit currently has no documents"})]})})]})})]}),G&&(0,t.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:(0,t.jsxs)("div",{className:"bg-background rounded-lg max-w-md w-full p-6",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Upload Document"}),es&&(0,t.jsxs)("div",{className:"mb-4 p-3 bg-destructive/20 text-destructive rounded-md flex items-center gap-2",children:[(0,t.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:(0,t.jsx)("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 0 016 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 0 00-1 1v4a1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),es]}),Z&&(0,t.jsx)("div",{className:"mb-4",children:(0,t.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:(0,t.jsx)("div",{className:"bg-blue-600 h-2.5 rounded-full transition-all duration-300",style:{width:`${ee}%`}})})}),ea&&(0,t.jsxs)("div",{className:"mb-4 p-3 bg-green-10 text-green-80 rounded-md flex items-center gap-2 animate-fade-in",children:[(0,t.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:(0,t.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 00 16zm3.707-9.293a1 1 0 0-1.414-1.414L9 10.586 7.707 9.293a1 1 0 0-1.414 1.414l2 2a1 1 0 01.414 0l4-4z",clipRule:"evenodd"})}),ea]}),(0,t.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),_(!0),et(0),el(null),en(null);try{let t=new FormData(e.currentTarget),s=t.get("file");if(!s||0===s.size)throw Error("Please select a file to upload");let l=await a.default.getAccessToken();if(!l)throw Error("No authentication token found");let n=new FormData;n.append("title",t.get("title")),n.append("description",t.get("description")),n.append("file",s),n.append("unitId",F);let r=new XMLHttpRequest;return new Promise((e,t)=>{r.upload.addEventListener("progress",e=>{if(e.lengthComputable){let t=Math.floor(e.loaded/e.total*100);et(t),console.log(`Upload progress: ${t}% (${e.loaded} / ${e.total} bytes)`)}else console.log("Upload progress: Length not computable")}),r.addEventListener("loadstart",()=>{console.log("Upload loadstart event fired")}),r.addEventListener("loadend",()=>{console.log("Upload loadend event fired")}),r.upload.addEventListener("loadstart",()=>{console.log("Upload upload loadstart event fired")}),r.upload.addEventListener("loadend",()=>{console.log("Upload upload loadend event fired")}),r.upload.addEventListener("error",e=>{console.error("Upload error event fired:",e)}),r.upload.addEventListener("abort",e=>{console.log("Upload abort event fired:",e)}),r.addEventListener("readystatechange",()=>{console.log(`Ready state changed: ${r.readyState}`)}),r.addEventListener("load",()=>{if(r.status>=200&&r.status<300)fetch(`/api/documents?unit=${F}`,{headers:{Authorization:`Bearer ${l}`,"Content-Type":"application/json"}}).then(e=>e.json()).then(t=>{M(t.documents||[]),W(!1),en("Document uploaded successfully!"),setTimeout(()=>{en(null)},3e3),ei(!0),setTimeout(()=>{},100),e()}).catch(t=>{console.error("Failed to refresh documents:",t),W(!1),en("Document uploaded successfully, but there was an issue refreshing the document list."),setTimeout(()=>{en(null)},500),ei(!0),e()});else{let e={};try{e=JSON.parse(r.responseText)}catch{e={error:`Upload failed: ${r.status} - ${r.statusText||"Unknown error"}`}}let s=e.error||`Upload failed: ${r.status} ${r.statusText}`;el(s),_(!1),en(null),console.error("Upload error details:",{status:r.status,statusText:r.statusText,responseText:r.responseText,error:s}),t(Error(s))}}),r.addEventListener("error",()=>{el("Network error occurred during upload"),_(!1),en(null),t(Error("Network error occurred during upload"))}),r.addEventListener("abort",()=>{el("Upload was cancelled"),_(!1),en(null),t(Error("Upload was cancelled"))}),r.open("POST","/api/documents"),r.setRequestHeader("Authorization",`Bearer ${l}`),r.send(n)})}catch(e){console.error("Upload error:",e),el(e instanceof Error?e.message:"Failed to upload document"),_(!1),en(null)}},children:[(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Title *"}),(0,t.jsx)("input",{name:"title",required:!0,placeholder:"Document title",className:"w-full p-2 border-input rounded-md bg-background"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Description"}),(0,t.jsx)("textarea",{name:"description",className:"w-full min-h-20 p-2 border border-input rounded-md bg-background",placeholder:"Document description (optional)"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-1",children:"File *"}),(0,t.jsx)("input",{type:"file",name:"file",required:!0,accept:".pdf,.doc,.docx,.ppt,.pptx,.xls,.xlsx,.txt,.jpg,.jpeg,.png,.gif",className:"w-full p-2 border-input rounded-md bg-background"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Unit"}),(0,t.jsx)("input",{type:"text",value:z?.name||"",readOnly:!0,className:"w-full p-2 border-input rounded-md bg-background bg-gray-10 cursor-not-allowed"}),(0,t.jsx)("input",{type:"hidden",name:"unitId",value:F}),(0,t.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:["Document will be uploaded to this unit: ",z?.code," - ",z?.name]})]})]}),(0,t.jsxs)("div",{className:"flex gap-2 mt-6",children:[(0,t.jsx)(o.Button,{type:"button",variant:"outline",onClick:()=>{W(!1),_(!1),et(0),el(null),en(null),ei(!1)},disabled:Z,children:"Cancel"}),(0,t.jsx)(o.Button,{type:"submit",disabled:Z,children:Z?"Uploading...":"Upload"})]})]})]})}),(0,t.jsx)(S.Dialog,{open:er,onOpenChange:ei,children:(0,t.jsxs)(S.DialogContent,{className:"sm:max-w-md",children:[(0,t.jsxs)(S.DialogHeader,{children:[(0,t.jsx)(S.DialogTitle,{children:"Upload Successful!"}),(0,t.jsx)(S.DialogDescription,{children:"Your document has been uploaded successfully to the repository."})]}),(0,t.jsx)("div",{className:"py-4 flex justify-center",children:(0,t.jsx)("div",{className:"w-16 h-16 rounded-full bg-green-100 flex items-center justify-center",children:(0,t.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-10 w-10 text-green-60",viewBox:"0 0 20",fill:"currentColor",children:(0,t.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 00 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 01.414 0l4-4z",clipRule:"evenodd"})})})}),(0,t.jsx)("div",{className:"flex justify-end",children:(0,t.jsx)(o.Button,{onClick:()=>{ei(!1),et(0),_(!1),en(null)},children:"OK"})})]})}),(0,t.jsx)(A.AlertDialog,{open:!!em,onOpenChange:e=>!e&&eh(null),children:(0,t.jsxs)(A.AlertDialogContent,{children:[(0,t.jsxs)(A.AlertDialogHeader,{children:[(0,t.jsx)(A.AlertDialogTitle,{children:"Are you sure?"}),(0,t.jsxs)(A.AlertDialogDescription,{children:["This will permanently delete ",(0,t.jsxs)("span",{className:"font-semibold",children:['"',em?.title,'"']}),". This action cannot be undone."]})]}),(0,t.jsxs)(A.AlertDialogFooter,{children:[(0,t.jsx)(A.AlertDialogCancel,{disabled:!!ec,children:"Cancel"}),(0,t.jsx)(A.AlertDialogAction,{disabled:!!ec,className:"bg-red-600 hover:bg-red-700 focus:ring-red-600",onClick:async t=>{if(t.preventDefault(),em){eu(em.id);try{let t=await a.default.getAccessToken();if(!t){await a.default.logout(),B.push("/");return}let s=await fetch(`/api/documents/${em.id}`,{method:"DELETE",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"}});if(s.ok){ed("Document deleted successfully!"),setTimeout(()=>ed(null),3e3),eh(null);let e=await fetch(`/api/documents?unit=${F}`,{headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"}});if(e.ok){let t=await e.json();M(t.documents||[])}}else{let t=await s.json();e({title:403===s.status?"Access Denied":"Error",description:t.error||"Failed to delete document",variant:"destructive"})}}catch(t){e({title:"Error",description:"Failed to delete document",variant:"destructive"})}finally{eu(null)}}},children:ec?"Deleting...":"Delete"})]})]})})]})}):(0,t.jsx)("div",{className:"min-h-screen bg-background flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"w-16 h-16 flex items-center justify-center mx-auto mb-4 overflow-hidden",children:(0,t.jsx)(C.default,{src:"/LSPULogo.png",alt:"LSPU Logo",width:64,height:64,className:"object-contain animate-spin"})}),(0,t.jsx)("p",{className:"text-lg text-muted-foreground",children:"Loading user data..."})]})}):(0,t.jsx)("div",{className:"min-h-screen bg-background flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"w-16 h-16 flex items-center justify-center mx-auto mb-4 overflow-hidden",children:(0,t.jsx)(C.default,{src:"/LSPULogo.png",alt:"LSPU Logo",width:64,height:64,className:"object-contain animate-spin"})}),(0,t.jsx)("p",{className:"text-lg text-muted-foreground",children:"Redirecting to login..."})]})}):(0,t.jsx)("div",{className:"min-h-screen bg-background flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"w-16 h-16 flex items-center justify-center mx-auto mb-4 overflow-hidden",children:(0,t.jsx)(C.default,{src:"/LSPULogo.png",alt:"LSPU Logo",width:64,height:64,className:"object-contain animate-spin"})}),(0,t.jsx)("p",{className:"text-lg text-muted-foreground",children:"Loading unit..."})]})})}e.s(["default",()=>L],30967)}]);