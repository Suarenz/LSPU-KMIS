(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,7486,e=>{"use strict";let t=(0,e.i(75254).default)("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);e.s(["Building2",()=>t],7486)},94179,e=>{"use strict";var t=e.i(43476),r=e.i(91918),a=e.i(25913),s=e.i(47163);let l=(0,a.cva)("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function i({className:e,variant:a,asChild:i=!1,...n}){let c=i?r.Slot:"span";return(0,t.jsx)(c,{"data-slot":"badge",className:(0,s.cn)(l({variant:a}),e),...n})}e.s(["Badge",()=>i])},25652,e=>{"use strict";let t=(0,e.i(75254).default)("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);e.s(["TrendingUp",()=>t],25652)},63209,e=>{"use strict";let t=(0,e.i(75254).default)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);e.s(["AlertCircle",()=>t],63209)},95468,e=>{"use strict";let t=(0,e.i(75254).default)("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);e.s(["CheckCircle2",()=>t],95468)},16715,e=>{"use strict";let t=(0,e.i(75254).default)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);e.s(["RefreshCw",()=>t],16715)},4302,e=>{"use strict";var t=e.i(43476),r=e.i(71645),a=e.i(18566),s=e.i(47163),l=e.i(75254);let i=(0,l.default)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);var n=e.i(63209),c=e.i(25652),d=e.i(95468),o=e.i(78583),u=e.i(16715);let g=(0,l.default)("ListChecks",[["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"m3 7 2 2 4-4",key:"1obspn"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]]);var x=e.i(7486),m=e.i(94179),p=e.i(67881),h=e.i(23257),b=e.i(91432),f=e.i(60865),y=e.i(20783),v=e.i(30030),j=e.i(81140),N=e.i(69340),k=e.i(99682),w=e.i(35804),C=e.i(96626),S=e.i(48425),$="Checkbox",[E,T]=(0,v.createContextScope)($),[A,I]=E($),P=r.forwardRef((e,a)=>{let{__scopeCheckbox:s,name:l,checked:i,defaultChecked:n,required:c,disabled:d,value:o="on",onCheckedChange:u,form:g,...x}=e,[m,p]=r.useState(null),h=(0,y.useComposedRefs)(a,e=>p(e)),b=r.useRef(!1),f=!m||g||!!m.closest("form"),[v=!1,k]=(0,N.useControllableState)({prop:i,defaultProp:n,onChange:u}),w=r.useRef(v);return r.useEffect(()=>{let e=m?.form;if(e){let t=()=>k(w.current);return e.addEventListener("reset",t),()=>e.removeEventListener("reset",t)}},[m,k]),(0,t.jsxs)(A,{scope:s,state:v,disabled:d,children:[(0,t.jsx)(S.Primitive.button,{type:"button",role:"checkbox","aria-checked":O(v)?"mixed":v,"aria-required":c,"data-state":B(v),"data-disabled":d?"":void 0,disabled:d,value:o,...x,ref:h,onKeyDown:(0,j.composeEventHandlers)(e.onKeyDown,e=>{"Enter"===e.key&&e.preventDefault()}),onClick:(0,j.composeEventHandlers)(e.onClick,e=>{k(e=>!!O(e)||!e),f&&(b.current=e.isPropagationStopped(),b.current||e.stopPropagation())})}),f&&(0,t.jsx)(R,{control:m,bubbles:!b.current,name:l,value:o,checked:v,required:c,disabled:d,form:g,style:{transform:"translateX(-100%)"},defaultChecked:!O(n)&&n})]})});P.displayName=$;var _="CheckboxIndicator",M=r.forwardRef((e,r)=>{let{__scopeCheckbox:a,forceMount:s,...l}=e,i=I(_,a);return(0,t.jsx)(C.Presence,{present:s||O(i.state)||!0===i.state,children:(0,t.jsx)(S.Primitive.span,{"data-state":B(i.state),"data-disabled":i.disabled?"":void 0,...l,ref:r,style:{pointerEvents:"none",...e.style}})})});M.displayName=_;var R=e=>{let{control:a,checked:s,bubbles:l=!0,defaultChecked:i,...n}=e,c=r.useRef(null),d=(0,k.usePrevious)(s),o=(0,w.useSize)(a);r.useEffect(()=>{let e=c.current,t=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set;if(d!==s&&t){let r=new Event("click",{bubbles:l});e.indeterminate=O(s),t.call(e,!O(s)&&s),e.dispatchEvent(r)}},[d,s,l]);let u=r.useRef(!O(s)&&s);return(0,t.jsx)("input",{type:"checkbox","aria-hidden":!0,defaultChecked:i??u.current,...n,tabIndex:-1,ref:c,style:{...e.style,...o,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function O(e){return"indeterminate"===e}function B(e){return O(e)?"indeterminate":e?"checked":"unchecked"}var L=e.i(78784);function q({className:e,...r}){return(0,t.jsx)(P,{"data-slot":"checkbox",className:(0,s.cn)("peer border-input dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",e),...r,children:(0,t.jsx)(M,{"data-slot":"checkbox-indicator",className:"flex items-center justify-center text-current transition-none",children:(0,t.jsx)(L.CheckIcon,{className:"size-3.5"})})})}var z=e.i(62870);function F({targetType:e,value:r,onChange:a,placeholder:l="",className:i,disabled:n=!1}){switch(e){case"MILESTONE":return(0,t.jsx)(D,{value:r,onChange:a,className:i,disabled:n});case"COUNT":return(0,t.jsx)(K,{value:r,onChange:a,placeholder:l,className:i,disabled:n});case"PERCENTAGE":return(0,t.jsx)(U,{value:r,onChange:a,placeholder:l,className:i,disabled:n});case"FINANCIAL":return(0,t.jsx)(V,{value:r,onChange:a,placeholder:l,className:i,disabled:n});case"TEXT_CONDITION":return(0,t.jsx)(H,{value:r,onChange:a,className:i,disabled:n});default:return(0,t.jsx)("input",{type:"text",value:r,onChange:e=>a(e.target.value),placeholder:l,disabled:n,className:(0,s.cn)("w-full px-3 py-2 text-sm border border-gray-300 rounded-md","focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",n&&"bg-gray-100 cursor-not-allowed",i)})}}function D({value:e,onChange:r,className:a,disabled:l}){let i=1===e||"1"===e;return(0,t.jsxs)("div",{className:(0,s.cn)("flex items-center gap-2",a),children:[(0,t.jsx)(q,{checked:i,onCheckedChange:e=>r(+!!e),disabled:l,className:"h-5 w-5"}),(0,t.jsx)("span",{className:"text-sm text-gray-600",children:i?"Achieved":"Pending"})]})}function K({value:e,onChange:r,placeholder:a,className:l,disabled:i}){return(0,t.jsx)("input",{type:"text",inputMode:"numeric",value:e,onChange:e=>{let t=e.target.value;(""===t||/^\d+$/.test(t))&&r(""===t?"":parseInt(t,10))},placeholder:a||"0",disabled:i,className:(0,s.cn)("w-32 px-3 py-2 text-sm text-right border border-gray-300 rounded-md","focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",i&&"bg-gray-100 cursor-not-allowed",l)})}function U({value:e,onChange:r,placeholder:a,className:l,disabled:i}){return(0,t.jsxs)("div",{className:(0,s.cn)("flex items-center gap-1",l),children:[(0,t.jsx)("input",{type:"text",inputMode:"decimal",value:e,onChange:e=>{let t=e.target.value;if(""===t||/^\d*\.?\d*$/.test(t)){let e=parseFloat(t);(""===t||e>=0&&e<=100)&&r(t)}},placeholder:a||"0",disabled:i,className:(0,s.cn)("w-24 px-3 py-2 text-sm text-right border border-gray-300 rounded-md","focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",i&&"bg-gray-100 cursor-not-allowed")}),(0,t.jsx)("span",{className:"text-sm text-gray-500 font-medium",children:"%"})]})}function V({value:e,onChange:r,placeholder:a,className:l,disabled:i}){let n=(e=>{if(!e&&0!==e)return"";let[t,r]=e.toString().replace(/,/g,"").split("."),a=t.replace(/\B(?=(\d{3})+(?!\d))/g,",");return void 0!==r?`${a}.${r}`:a})(e);return(0,t.jsxs)("div",{className:(0,s.cn)("flex items-center gap-1",l),children:[(0,t.jsx)("span",{className:"text-sm text-gray-500 font-medium",children:"₱"}),(0,t.jsx)("input",{type:"text",inputMode:"decimal",value:n,onChange:e=>{let t=e.target.value.replace(/,/g,"");(""===t||/^\d*\.?\d{0,2}$/.test(t))&&r(t)},placeholder:a||"0.00",disabled:i,className:(0,s.cn)("w-36 px-3 py-2 text-sm text-right border border-gray-300 rounded-md","focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",i&&"bg-gray-100 cursor-not-allowed")})]})}function H({value:e,onChange:r,className:a,disabled:l}){return(0,t.jsxs)(z.Select,{value:e.toString(),onValueChange:r,disabled:l,children:[(0,t.jsx)(z.SelectTrigger,{className:(0,s.cn)("w-40",a),children:(0,t.jsx)(z.SelectValue,{placeholder:"Select status..."})}),(0,t.jsx)(z.SelectContent,{children:[{value:"Met",label:"Met"},{value:"Not Met",label:"Not Met"},{value:"In Progress",label:"In Progress"}].map(e=>(0,t.jsx)(z.SelectItem,{value:e.value,children:e.label},e.value))})]})}function X(e){if(!e)return"COUNT";let t=e.toLowerCase().trim();return t.includes("milestone")||t.includes("binary")||"boolean"===t?"MILESTONE":t.includes("percentage")||t.includes("percent")||t.includes("rate")?"PERCENTAGE":t.includes("currency")||t.includes("financial")||t.includes("budget")||t.includes("revenue")||t.includes("cost")?"FINANCIAL":t.includes("text")||t.includes("condition")||t.includes("status")||t.includes("qualitative")?"TEXT_CONDITION":(t.includes("count")||t.includes("numeric")||t.includes("number")||t.includes("quantity"),"COUNT")}let Y=["bg-red-100 text-red-800","bg-blue-100 text-blue-800","bg-green-100 text-green-800","bg-yellow-100 text-yellow-800","bg-purple-100 text-purple-800","bg-pink-100 text-pink-800","bg-indigo-100 text-indigo-800","bg-cyan-100 text-cyan-800","bg-orange-100 text-orange-800","bg-teal-100 text-teal-800","bg-lime-100 text-lime-800","bg-rose-100 text-rose-800","bg-sky-100 text-sky-800","bg-violet-100 text-violet-800","bg-amber-100 text-amber-800","bg-emerald-100 text-emerald-800","bg-fuchsia-100 text-fuchsia-800","bg-cyan-100 text-cyan-800","bg-red-200 text-red-900","bg-blue-200 text-blue-900","bg-green-200 text-green-900","bg-purple-200 text-purple-900"],G=e=>e?Array.isArray(e)?e:"string"==typeof e?[e]:[]:[];function J(){let e=(0,a.useParams)(),l=(0,a.useRouter)(),{isAuthenticated:y,isLoading:v,user:j}=(0,b.useAuth)(),N=decodeURIComponent(e.kraId),[k,w]=(0,r.useState)(null),[C,S]=(0,r.useState)(!1),[$,E]=(0,r.useState)(null),[T,A]=(0,r.useState)(!1),[I,P]=(0,r.useState)(new Date().getFullYear()),[_,M]=(0,r.useState)(0),[R,O]=(0,r.useState)({}),[B,L]=(0,r.useState)({}),[q,z]=(0,r.useState)(null),[D,K]=(0,r.useState)({}),[U,V]=(0,r.useState)(null),[H,J]=(0,r.useState)({}),[Q,W]=(0,r.useState)(null),Z=(0,r.useCallback)((e,t,r)=>{if(!$)return 0;let a=$.initiatives?.find(t=>t.id===e);if(!a)return 0;if(!r)return(a.progress?.filter(e=>e.year===t)||[]).reduce((e,t)=>e+("number"==typeof t.currentValue?t.currentValue:parseFloat(String(t.currentValue))||0),0);{let e=a.progress?.find(e=>e.year===t&&e.quarter===r);return e?.currentValue??0}},[$]),ee=(0,r.useCallback)((e,t,r)=>{if(!$)return"none";let a=$.initiatives?.find(t=>t.id===e);if(!a)return"none";if(r){let e=a.progress?.find(e=>e.year===t&&e.quarter===r);return e?.valueSource||"none"}{let e=a.progress?.filter(e=>e.year===t)||[];return e.some(e=>"manual"===e.valueSource)?"manual":e.some(e=>"qpro"===e.valueSource)?"qpro":"none"}},[$]),et=(0,r.useCallback)(async(e,t,r,a,s,l)=>{let i=`${e}-${t}-${r}`;z(i);try{let n=await f.default.getAccessToken(),c=await fetch("/api/kpi-progress",{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${n}`},body:JSON.stringify({kraId:N,initiativeId:e,year:t,quarter:r,value:a,reason:s,targetType:l})});if(!c.ok){let e={};try{e=await c.json()}catch{e={message:`HTTP ${c.status}`}}return console.error("Failed to save override:",e,"Status:",c.status),!1}L(e=>{let t={...e};return delete t[i],t});let d=new URLSearchParams({kraId:N,year:I.toString(),_t:Date.now().toString()}),o=await fetch(`/api/kpi-progress?${d}`,{headers:{Authorization:`Bearer ${n}`}});if(o.ok){let e=await o.json();E(e.data)}return!0}catch(e){return console.error("Error saving manual override:",e),!1}finally{z(null)}},[N,I]),er=(0,r.useCallback)((e,t,r,a)=>{let s=`${e}-${t}-${r}`,l=""===a?0:a;L(e=>({...e,[s]:{value:l}}))},[]),ea=(0,r.useCallback)((e,t,r)=>{let a=`${e}-${t}-${r}`;return void 0!==B[a]?B[a].value:Z(e,t,r)},[B,Z]),es=(0,r.useCallback)((e,t,r)=>void 0!==B[`${e}-${t}-${r}`],[B]);(0,r.useCallback)(()=>{L({})},[]);let el=(0,r.useCallback)(async()=>{try{let e=await f.default.getAccessToken(),t=new URLSearchParams({kraId:N}),r=await fetch(`/api/kpi-targets?${t}`,{headers:{Authorization:`Bearer ${e}`}});if(r.ok){let e=await r.json(),t={};e.targets?.forEach(e=>{t[`${e.initiative_id}-${e.year}-${e.quarter||"annual"}`]=e}),K(t)}}catch(e){console.error("Error fetching KPI targets:",e)}},[N]),ei=(0,r.useCallback)((e,t,r,a)=>{let s=`${e}-${t}-${r}`;if(void 0!==H[s])return H[s];let l=D[s];return l?l.target_value:a},[H,D]),en=(0,r.useCallback)((e,t,r,a)=>{let s=`${e}-${t}-${r}`;J(e=>({...e,[s]:a}))},[]),ec=(0,r.useCallback)(async(e,t,r,a,s,l)=>{let i=`${e}-${t}-${r}`;W(i);try{let n=await f.default.getAccessToken(),c=await fetch("/api/kpi-targets",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${n}`},body:JSON.stringify({kra_id:N,initiative_id:e,year:t,quarter:r,target_value:a,target_type:s,description:l})});if(c.ok)return J(e=>{let t={...e};return delete t[i],t}),await el(),V(null),!0;{let e=await c.json();return console.error("Failed to save target:",e),!1}}catch(e){return console.error("Error saving target:",e),!1}finally{W(null)}},[N,el]),ed=(0,r.useCallback)(()=>{J({}),V(null)},[]),eo=h.default.kras||[],eu=e=>{let t=decodeURIComponent(e),r=t.match(/KRA\s*(\d+)/i);return r?`KRA ${r[1]}`:t},eg=eu(N),ex=eo.find(e=>eu(e.kra_id)===eg)||null,em=ex?Y[(parseInt(ex.kra_id.split(" ")[1])-1)%Y.length]:Y[0],ep=(0,r.useMemo)(()=>{if(!ex)return[new Date().getFullYear()];let e=new Set;ex.initiatives.forEach(t=>{t.targets?.timeline_data?.forEach(t=>e.add(t.year))});let t=Array.from(e).sort();return t.length>0?t:[new Date().getFullYear()]},[ex]);return((0,r.useEffect)(()=>{ep.length>0&&!ep.includes(I)&&P(ep[0])},[ep,I]),(0,r.useEffect)(()=>{!y||v||(async()=>{try{S(!0);let e=await f.default.getAccessToken(),t=await fetch(`/api/qpro-analyses?kraId=${N}`,{headers:{Authorization:`Bearer ${e}`}});if(t.ok){let e=await t.json();w(e)}}catch(e){console.error("Error fetching analysis data:",e)}finally{S(!1)}})()},[N,y,v]),(0,r.useEffect)(()=>{y&&!v&&N&&((async()=>{try{A(!0);let e=await f.default.getAccessToken(),t=new URLSearchParams({kraId:N,year:I.toString(),_t:Date.now().toString()}),r=await fetch(`/api/kpi-progress?${t}`,{headers:{Authorization:`Bearer ${e}`,"Cache-Control":"no-cache"}});if(r.ok){let e=await r.json();E(e.data);let t={};for(let r of e.data.initiatives||[])for(let e of(r.progress||[]).filter(e=>e.year===I))t[`${r.id}-${e.year}-${e.quarter}`]=e.currentValue||0;O(t)}}catch(e){console.error("Error fetching KPI progress:",e)}finally{A(!1)}})(),el())},[N,y,v,I,el,_]),(0,r.useEffect)(()=>{let e=()=>{"visible"===document.visibilityState&&y&&!v&&M(e=>e+1)};return document.addEventListener("visibilitychange",e),()=>document.removeEventListener("visibilitychange",e)},[y,v]),v)?(0,t.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,t.jsx)("div",{className:"text-lg text-gray-600",children:"Loading..."})}):y?ex?(0,t.jsxs)("div",{className:"min-h-screen bg-gray-50 p-4 sm:p-8",children:[(0,t.jsxs)(p.Button,{variant:"outline",onClick:()=>l.back(),className:"mb-6",children:[(0,t.jsx)(i,{className:"w-4 h-4 mr-2"}),"Back to Strategic Commitments"]}),(0,t.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 p-6 sm:p-8 mb-8",children:(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-start gap-4",children:[(0,t.jsx)(m.Badge,{className:`${em} text-lg font-bold w-fit`,children:ex.kra_id}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900 mb-3",children:ex.kra_title}),(0,t.jsx)("div",{className:"bg-gray-100 rounded p-4",children:(0,t.jsxs)("p",{className:"text-gray-700 text-sm sm:text-base",children:[(0,t.jsx)("span",{className:"font-semibold",children:"Guiding Principle: "}),ex.guiding_principle]})})]})]})}),(0,t.jsx)("div",{className:"mb-8",children:(0,t.jsx)("div",{className:"flex items-center gap-2 overflow-x-auto pb-2 no-scrollbar",children:ep.map(e=>(0,t.jsx)("button",{onClick:()=>P(e),className:(0,s.cn)("px-6 py-2 rounded-full text-sm font-medium transition-all whitespace-nowrap",I===e?"bg-blue-600 text-white shadow-md ring-2 ring-blue-600 ring-offset-2":"bg-white text-gray-600 hover:bg-gray-100 border border-gray-200 hover:border-gray-300"),children:e},e))})}),(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Key Performance Indicators (KPIs)"}),ex.initiatives&&ex.initiatives.length>0?(0,t.jsx)("div",{className:"grid gap-6",children:ex.initiatives.map((e,r)=>{let a,l,i,n,m=$?.initiatives?.find(t=>t.id===e.id),h=e.targets?.timeline_data?.find(e=>e.year===I),b=m?.progress?.filter(e=>e.year===I)||[],f=b.reduce((e,t)=>e+("number"==typeof t.currentValue?t.currentValue:parseFloat(String(t.currentValue))||0),0),y=h?function(e){if("number"==typeof e)return e;let t=parseFloat(e.replace(/[₱$,\s]/g,"").replace(/PHP/gi,"").trim());return isNaN(t)?0:t}(h.target_value):0,v=y>0?Math.min(100,Math.round(f/y*100)):0;return(0,t.jsxs)("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden mb-8",children:[(0,t.jsxs)("div",{className:"p-6 border-b border-gray-100",children:[(0,t.jsxs)("div",{className:"flex flex-col md:flex-row md:items-start justify-between gap-4 mb-6",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("h3",{className:"text-xl font-bold text-gray-900",children:e.id}),(0,t.jsxs)("div",{className:"mt-3 space-y-2",children:[(0,t.jsx)("div",{className:"bg-blue-50/50 p-3 rounded-md border border-blue-100",children:(0,t.jsxs)("p",{className:"text-sm text-gray-800",children:[(0,t.jsx)("span",{className:"font-bold text-blue-800 uppercase text-xs tracking-wide block mb-1",children:"Output"}),e.key_performance_indicator?.outputs]})}),(0,t.jsx)("div",{className:"bg-green-50/50 p-3 rounded-md border border-green-100",children:(0,t.jsxs)("p",{className:"text-sm text-gray-800",children:[(0,t.jsx)("span",{className:"font-bold text-green-800 uppercase text-xs tracking-wide block mb-1",children:"Outcome"}),e.key_performance_indicator?.outcomes]})})]})]}),(0,t.jsx)("div",{className:"flex items-center gap-2 shrink-0",children:(0,t.jsxs)(p.Button,{size:"sm",variant:"outline",onClick:()=>M(e=>e+1),disabled:T,className:"flex items-center gap-1 text-blue-600 border-blue-300 hover:bg-blue-50",children:[(0,t.jsx)(u.RefreshCw,{className:`h-3 w-3 ${T?"animate-spin":""}`}),"Refresh"]})})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,t.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 border-l-4 border-purple-500 h-full",children:[(0,t.jsxs)("h4",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-3 flex items-center gap-2",children:[(0,t.jsx)(c.TrendingUp,{className:"w-3 h-3"})," Strategies"]}),(0,t.jsx)("ul",{className:"text-sm text-gray-700 space-y-2 pl-1",children:G(e.strategies).map((e,r)=>(0,t.jsxs)("li",{className:"flex gap-2",children:[(0,t.jsx)("span",{className:"text-purple-400 mt-1",children:"•"}),(0,t.jsx)("span",{children:e})]},r))})]}),(0,t.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 border-l-4 border-blue-500 h-full",children:[(0,t.jsxs)("h4",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-3 flex items-center gap-2",children:[(0,t.jsx)(g,{className:"w-3 h-3"})," Activities"]}),(0,t.jsx)("ul",{className:"text-sm text-gray-700 space-y-2 pl-1",children:G(e.programs_activities).map((e,r)=>(0,t.jsxs)("li",{className:"flex gap-2",children:[(0,t.jsx)("span",{className:"text-blue-400 mt-1",children:"•"}),(0,t.jsx)("span",{children:e})]},r))})]}),(0,t.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 border-l-4 border-green-500 h-full",children:[(0,t.jsxs)("h4",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-3 flex items-center gap-2",children:[(0,t.jsx)(x.Building2,{className:"w-3 h-3"})," Responsible Offices"]}),(0,t.jsx)("ul",{className:"text-sm text-gray-700 space-y-2 pl-1",children:G(e.responsible_offices).map((e,r)=>(0,t.jsxs)("li",{className:"flex gap-2",children:[(0,t.jsx)("span",{className:"text-green-400 mt-1",children:"•"}),(0,t.jsx)("span",{children:e})]},r))})]})]})]}),h?(0,t.jsx)("div",{className:"bg-blue-50/50 p-6 border-b border-gray-100",children:(0,t.jsx)("div",{className:"flex flex-col md:flex-row items-center justify-between gap-8",children:(0,t.jsxs)("div",{className:"flex items-center gap-6",children:[(0,t.jsxs)("div",{className:"relative w-24 h-24 flex items-center justify-center",children:[(0,t.jsxs)("svg",{className:"w-full h-full transform -rotate-90",children:[(0,t.jsx)("circle",{cx:"48",cy:"48",r:"40",stroke:"currentColor",strokeWidth:"8",fill:"transparent",className:"text-gray-200"}),(0,t.jsx)("circle",{cx:"48",cy:"48",r:"40",stroke:"currentColor",strokeWidth:"8",fill:"transparent",strokeDasharray:251.2,strokeDashoffset:251.2-251.2*v/100,className:v>=100?"text-green-500":"text-blue-500"})]}),(0,t.jsx)("div",{className:"absolute inset-0 flex items-center justify-center flex-col",children:(0,t.jsxs)("span",{className:"text-xl font-bold text-gray-900",children:[v,"%"]})})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("h4",{className:"text-lg font-semibold text-gray-900",children:[I," Overview"]}),(0,t.jsxs)("div",{className:"flex items-baseline gap-2 mt-1",children:[(0,t.jsx)("span",{className:"text-3xl font-bold text-gray-900",children:f}),(0,t.jsx)("span",{className:"text-gray-500",children:"/"}),(l=U===(a=`${e.id}-${h.year}-1`),i=ei(e.id,h.year,1,h.target_value),n=j&&("ADMIN"===j.role||"FACULTY"===j.role),l?(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("input",{type:"number",className:"w-24 px-2 py-1 border border-blue-500 rounded text-lg font-bold focus:outline-none",value:H[a]??i,onChange:t=>en(e.id,h.year,1,parseFloat(t.target.value)||0),autoFocus:!0}),(0,t.jsx)(p.Button,{size:"sm",onClick:()=>ec(e.id,h.year,1,"number"==typeof(H[a]??i)?H[a]??i:parseFloat(String(H[a]??i))||0,X(e.targets?.type||"count"),e.key_performance_indicator?.outputs),disabled:Q===a,children:"Save"}),(0,t.jsx)(p.Button,{size:"sm",variant:"ghost",onClick:ed,children:"Cancel"})]}):(0,t.jsxs)("div",{className:"flex items-center gap-2 group",children:[(0,t.jsx)("span",{className:"text-xl font-medium text-gray-600",children:"number"==typeof i?i.toLocaleString():i}),n&&(0,t.jsx)("button",{onClick:()=>V(a),className:"opacity-0 group-hover:opacity-100 text-blue-600 hover:text-blue-800 transition-opacity",children:(0,t.jsx)(o.FileText,{className:"w-4 h-4"})})]})),(0,t.jsx)("span",{className:"text-sm text-gray-500 ml-1",children:e.targets.unit_basis})]})]})]})})}):(0,t.jsxs)("div",{className:"p-6 text-center text-gray-500",children:["No target data for ",I]}),h&&(0,t.jsx)("div",{className:"p-6 bg-gray-50",children:(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[1,2,3,4].map(r=>{let a=b.find(e=>e.quarter===r),l=ea(e.id,h.year,r),i=a?.valueSource||ee(e.id,h.year,r),n=es(e.id,h.year,r),c=q===`${e.id}-${h.year}-${r}`;e.targets.type,e.targets.currency,e.targets.low_count_threshold;let o=X(e.targets?.type||"count"),u=0!==l&&"0"!==l&&""!==l&&!n;return(0,t.jsxs)("div",{className:(0,s.cn)("bg-white rounded-lg border p-4 transition-all",u?"border-green-200 shadow-sm":"border-gray-200 shadow-sm","hover:border-blue-300 hover:shadow-md"),children:[(0,t.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,t.jsxs)("span",{className:(0,s.cn)("text-xs font-bold px-2 py-1 rounded uppercase",u?"bg-green-100 text-green-700":"bg-blue-100 text-blue-700"),children:["Q",r]}),"qpro"===i&&(0,t.jsxs)("span",{className:"text-xs text-green-600 font-medium flex items-center gap-1",children:[(0,t.jsx)(d.CheckCircle2,{className:"w-3 h-3"})," QPRO"]})]}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("label",{className:"text-xs font-medium text-gray-500 uppercase",children:"Actual Value"}),(0,t.jsx)("div",{className:"flex items-center gap-2",children:(0,t.jsx)(F,{targetType:o,value:l??"",onChange:t=>er(e.id,h.year,r,t),placeholder:"0",className:"text-lg font-semibold h-10"})}),n&&(0,t.jsx)(p.Button,{size:"sm",className:"w-full mt-2",onClick:()=>{let t=B[`${e.id}-${h.year}-${r}`]?.value,a=null;if("MILESTONE"===o)a=+(1===t||"1"===t);else if("TEXT_CONDITION"===o)a=t?String(t):null;else{let e="string"==typeof t?parseFloat(t.replace(/,/g,"")):t;a="number"!=typeof e||Number.isNaN(e)?null:e}let s=Z(e.id,h.year,r);"number"==typeof a&&0===a&&0===s&&(a=null),et(e.id,h.year,r,a,void 0,o)},disabled:c,children:c?"Saving...":"Save Changes"})]})]},r)})})})]},r)})}):(0,t.jsx)("div",{className:"bg-white rounded-lg border border-gray-300 p-8 text-center",children:(0,t.jsx)("p",{className:"text-gray-600",children:"No KPIs found for this KRA."})})]})]}):(0,t.jsxs)("div",{className:"min-h-screen bg-gray-50 p-8",children:[(0,t.jsxs)(p.Button,{variant:"outline",onClick:()=>l.back(),className:"mb-4",children:[(0,t.jsx)(i,{className:"w-4 h-4 mr-2"}),"Back to Strategic Commitments"]}),(0,t.jsx)("div",{className:"bg-white rounded-lg border border-gray-300 p-8",children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)(n.AlertCircle,{className:"w-6 h-6 text-red-500"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"KRA Not Found"}),(0,t.jsx)("p",{className:"text-gray-600 mt-1",children:"The requested KRA could not be found."})]})]})})]}):(0,t.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,t.jsx)("div",{className:"text-lg text-gray-600",children:"Please log in to view this page."})})}e.s(["default",()=>J],4302)}]);