{"version":3,"sources":["../../../../app/qpro/review/%5Bid%5D/page.tsx","../../../../node_modules/%40radix-ui/react-scroll-area/dist/index.mjs","../../../../components/ui/scroll-area.tsx","../../../../components/qpro/activity-card-redesigned.tsx","../../../../components/qpro/review-qpro-modal.tsx","../../../../node_modules/lucide-react/src/icons/pen.ts","../../../../node_modules/%40radix-ui/react-scroll-area/src/ScrollArea.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { useEffect, useState } from 'react';\r\nimport { useParams, useRouter } from 'next/navigation';\r\nimport { useAuth } from '@/lib/auth-context';\r\nimport { Navbar } from '@/components/navbar';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Card } from '@/components/ui/card';\r\nimport { Loader2, ChevronLeft } from 'lucide-react';\r\nimport ReviewQProModal from '@/components/qpro/review-qpro-modal';\r\n\r\nexport default function ReviewPage() {\r\n  const params = useParams();\r\n  const router = useRouter();\r\n  const { isAuthenticated, isLoading } = useAuth();\r\n\r\n  const analysisId = params.id as string;\r\n\r\n  // Redirect if not authenticated\r\n  useEffect(() => {\r\n    if (!isLoading && !isAuthenticated) {\r\n      router.push('/');\r\n    }\r\n  }, [isLoading, isAuthenticated, router]);\r\n\r\n  const handleCloseModal = () => {\r\n    // Go back to the previous page or QPRO page\r\n    router.back();\r\n  };\r\n\r\n  const handleApproveSuccess = () => {\r\n    console.log('[Review Page] handleApproveSuccess called - redirecting to QPRO page...');\r\n    // Redirect to QPRO dashboard after successful approval\r\n    // This avoids reloading the same analysis which is now APPROVED\r\n    router.push('/qpro');\r\n  };\r\n\r\n  if (isLoading) {\r\n    return (\r\n      <div className=\"flex items-center justify-center min-h-screen\">\r\n        <Loader2 className=\"w-8 h-8 animate-spin text-primary\" />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (!isAuthenticated) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <Navbar />\r\n      <div className=\"min-h-screen bg-background\">\r\n        {/* Header */}\r\n        <div className=\"border-b bg-card\">\r\n          <div className=\"container mx-auto px-4 py-6\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <h1 className=\"text-3xl font-bold tracking-tight\">\r\n                Review QPRO Analysis\r\n              </h1>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Review Content */}\r\n        <div className=\"container mx-auto px-4 py-6\">\r\n          <div className=\"space-y-4\">\r\n            <Button\r\n              variant=\"ghost\"\r\n              onClick={handleCloseModal}\r\n              className=\"gap-2\"\r\n            >\r\n              <ChevronLeft className=\"w-4 h-4\" />\r\n              Back\r\n            </Button>\r\n\r\n            {analysisId ? (\r\n              <div className=\"w-full\">\r\n                {/* Render review modal as full page */}\r\n                <ReviewQProModal\r\n                  isOpen={true}\r\n                  onClose={handleCloseModal}\r\n                  analysisId={analysisId}\r\n                  onApprove={handleApproveSuccess}\r\n                  forceFullPage={true}\r\n                />\r\n              </div>\r\n            ) : (\r\n              <Card>\r\n                <div className=\"flex items-start gap-3 p-6\">\r\n                  <p className=\"font-medium text-red-900\">Invalid Analysis ID</p>\r\n                  <p className=\"text-sm text-red-700 mt-1\">\r\n                    No analysis ID was provided\r\n                  </p>\r\n                </div>\r\n              </Card>\r\n            )}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </>\r\n  );\r\n}\r\n","\"use client\";\n\n// packages/react/scroll-area/src/ScrollArea.tsx\nimport * as React2 from \"react\";\nimport { Primitive } from \"@radix-ui/react-primitive\";\nimport { Presence } from \"@radix-ui/react-presence\";\nimport { createContextScope } from \"@radix-ui/react-context\";\nimport { useComposedRefs } from \"@radix-ui/react-compose-refs\";\nimport { useCallbackRef } from \"@radix-ui/react-use-callback-ref\";\nimport { useDirection } from \"@radix-ui/react-direction\";\nimport { useLayoutEffect } from \"@radix-ui/react-use-layout-effect\";\nimport { clamp } from \"@radix-ui/number\";\nimport { composeEventHandlers } from \"@radix-ui/primitive\";\n\n// packages/react/scroll-area/src/useStateMachine.ts\nimport * as React from \"react\";\nfunction useStateMachine(initialState, machine) {\n  return React.useReducer((state, event) => {\n    const nextState = machine[state][event];\n    return nextState ?? state;\n  }, initialState);\n}\n\n// packages/react/scroll-area/src/ScrollArea.tsx\nimport { Fragment, jsx, jsxs } from \"react/jsx-runtime\";\nvar SCROLL_AREA_NAME = \"ScrollArea\";\nvar [createScrollAreaContext, createScrollAreaScope] = createContextScope(SCROLL_AREA_NAME);\nvar [ScrollAreaProvider, useScrollAreaContext] = createScrollAreaContext(SCROLL_AREA_NAME);\nvar ScrollArea = React2.forwardRef(\n  (props, forwardedRef) => {\n    const {\n      __scopeScrollArea,\n      type = \"hover\",\n      dir,\n      scrollHideDelay = 600,\n      ...scrollAreaProps\n    } = props;\n    const [scrollArea, setScrollArea] = React2.useState(null);\n    const [viewport, setViewport] = React2.useState(null);\n    const [content, setContent] = React2.useState(null);\n    const [scrollbarX, setScrollbarX] = React2.useState(null);\n    const [scrollbarY, setScrollbarY] = React2.useState(null);\n    const [cornerWidth, setCornerWidth] = React2.useState(0);\n    const [cornerHeight, setCornerHeight] = React2.useState(0);\n    const [scrollbarXEnabled, setScrollbarXEnabled] = React2.useState(false);\n    const [scrollbarYEnabled, setScrollbarYEnabled] = React2.useState(false);\n    const composedRefs = useComposedRefs(forwardedRef, (node) => setScrollArea(node));\n    const direction = useDirection(dir);\n    return /* @__PURE__ */ jsx(\n      ScrollAreaProvider,\n      {\n        scope: __scopeScrollArea,\n        type,\n        dir: direction,\n        scrollHideDelay,\n        scrollArea,\n        viewport,\n        onViewportChange: setViewport,\n        content,\n        onContentChange: setContent,\n        scrollbarX,\n        onScrollbarXChange: setScrollbarX,\n        scrollbarXEnabled,\n        onScrollbarXEnabledChange: setScrollbarXEnabled,\n        scrollbarY,\n        onScrollbarYChange: setScrollbarY,\n        scrollbarYEnabled,\n        onScrollbarYEnabledChange: setScrollbarYEnabled,\n        onCornerWidthChange: setCornerWidth,\n        onCornerHeightChange: setCornerHeight,\n        children: /* @__PURE__ */ jsx(\n          Primitive.div,\n          {\n            dir: direction,\n            ...scrollAreaProps,\n            ref: composedRefs,\n            style: {\n              position: \"relative\",\n              // Pass corner sizes as CSS vars to reduce re-renders of context consumers\n              [\"--radix-scroll-area-corner-width\"]: cornerWidth + \"px\",\n              [\"--radix-scroll-area-corner-height\"]: cornerHeight + \"px\",\n              ...props.style\n            }\n          }\n        )\n      }\n    );\n  }\n);\nScrollArea.displayName = SCROLL_AREA_NAME;\nvar VIEWPORT_NAME = \"ScrollAreaViewport\";\nvar ScrollAreaViewport = React2.forwardRef(\n  (props, forwardedRef) => {\n    const { __scopeScrollArea, children, nonce, ...viewportProps } = props;\n    const context = useScrollAreaContext(VIEWPORT_NAME, __scopeScrollArea);\n    const ref = React2.useRef(null);\n    const composedRefs = useComposedRefs(forwardedRef, ref, context.onViewportChange);\n    return /* @__PURE__ */ jsxs(Fragment, { children: [\n      /* @__PURE__ */ jsx(\n        \"style\",\n        {\n          dangerouslySetInnerHTML: {\n            __html: `[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}`\n          },\n          nonce\n        }\n      ),\n      /* @__PURE__ */ jsx(\n        Primitive.div,\n        {\n          \"data-radix-scroll-area-viewport\": \"\",\n          ...viewportProps,\n          ref: composedRefs,\n          style: {\n            /**\n             * We don't support `visible` because the intention is to have at least one scrollbar\n             * if this component is used and `visible` will behave like `auto` in that case\n             * https://developer.mozilla.org/en-US/docs/Web/CSS/overflow#description\n             *\n             * We don't handle `auto` because the intention is for the native implementation\n             * to be hidden if using this component. We just want to ensure the node is scrollable\n             * so could have used either `scroll` or `auto` here. We picked `scroll` to prevent\n             * the browser from having to work out whether to render native scrollbars or not,\n             * we tell it to with the intention of hiding them in CSS.\n             */\n            overflowX: context.scrollbarXEnabled ? \"scroll\" : \"hidden\",\n            overflowY: context.scrollbarYEnabled ? \"scroll\" : \"hidden\",\n            ...props.style\n          },\n          children: /* @__PURE__ */ jsx(\"div\", { ref: context.onContentChange, style: { minWidth: \"100%\", display: \"table\" }, children })\n        }\n      )\n    ] });\n  }\n);\nScrollAreaViewport.displayName = VIEWPORT_NAME;\nvar SCROLLBAR_NAME = \"ScrollAreaScrollbar\";\nvar ScrollAreaScrollbar = React2.forwardRef(\n  (props, forwardedRef) => {\n    const { forceMount, ...scrollbarProps } = props;\n    const context = useScrollAreaContext(SCROLLBAR_NAME, props.__scopeScrollArea);\n    const { onScrollbarXEnabledChange, onScrollbarYEnabledChange } = context;\n    const isHorizontal = props.orientation === \"horizontal\";\n    React2.useEffect(() => {\n      isHorizontal ? onScrollbarXEnabledChange(true) : onScrollbarYEnabledChange(true);\n      return () => {\n        isHorizontal ? onScrollbarXEnabledChange(false) : onScrollbarYEnabledChange(false);\n      };\n    }, [isHorizontal, onScrollbarXEnabledChange, onScrollbarYEnabledChange]);\n    return context.type === \"hover\" ? /* @__PURE__ */ jsx(ScrollAreaScrollbarHover, { ...scrollbarProps, ref: forwardedRef, forceMount }) : context.type === \"scroll\" ? /* @__PURE__ */ jsx(ScrollAreaScrollbarScroll, { ...scrollbarProps, ref: forwardedRef, forceMount }) : context.type === \"auto\" ? /* @__PURE__ */ jsx(ScrollAreaScrollbarAuto, { ...scrollbarProps, ref: forwardedRef, forceMount }) : context.type === \"always\" ? /* @__PURE__ */ jsx(ScrollAreaScrollbarVisible, { ...scrollbarProps, ref: forwardedRef }) : null;\n  }\n);\nScrollAreaScrollbar.displayName = SCROLLBAR_NAME;\nvar ScrollAreaScrollbarHover = React2.forwardRef((props, forwardedRef) => {\n  const { forceMount, ...scrollbarProps } = props;\n  const context = useScrollAreaContext(SCROLLBAR_NAME, props.__scopeScrollArea);\n  const [visible, setVisible] = React2.useState(false);\n  React2.useEffect(() => {\n    const scrollArea = context.scrollArea;\n    let hideTimer = 0;\n    if (scrollArea) {\n      const handlePointerEnter = () => {\n        window.clearTimeout(hideTimer);\n        setVisible(true);\n      };\n      const handlePointerLeave = () => {\n        hideTimer = window.setTimeout(() => setVisible(false), context.scrollHideDelay);\n      };\n      scrollArea.addEventListener(\"pointerenter\", handlePointerEnter);\n      scrollArea.addEventListener(\"pointerleave\", handlePointerLeave);\n      return () => {\n        window.clearTimeout(hideTimer);\n        scrollArea.removeEventListener(\"pointerenter\", handlePointerEnter);\n        scrollArea.removeEventListener(\"pointerleave\", handlePointerLeave);\n      };\n    }\n  }, [context.scrollArea, context.scrollHideDelay]);\n  return /* @__PURE__ */ jsx(Presence, { present: forceMount || visible, children: /* @__PURE__ */ jsx(\n    ScrollAreaScrollbarAuto,\n    {\n      \"data-state\": visible ? \"visible\" : \"hidden\",\n      ...scrollbarProps,\n      ref: forwardedRef\n    }\n  ) });\n});\nvar ScrollAreaScrollbarScroll = React2.forwardRef((props, forwardedRef) => {\n  const { forceMount, ...scrollbarProps } = props;\n  const context = useScrollAreaContext(SCROLLBAR_NAME, props.__scopeScrollArea);\n  const isHorizontal = props.orientation === \"horizontal\";\n  const debounceScrollEnd = useDebounceCallback(() => send(\"SCROLL_END\"), 100);\n  const [state, send] = useStateMachine(\"hidden\", {\n    hidden: {\n      SCROLL: \"scrolling\"\n    },\n    scrolling: {\n      SCROLL_END: \"idle\",\n      POINTER_ENTER: \"interacting\"\n    },\n    interacting: {\n      SCROLL: \"interacting\",\n      POINTER_LEAVE: \"idle\"\n    },\n    idle: {\n      HIDE: \"hidden\",\n      SCROLL: \"scrolling\",\n      POINTER_ENTER: \"interacting\"\n    }\n  });\n  React2.useEffect(() => {\n    if (state === \"idle\") {\n      const hideTimer = window.setTimeout(() => send(\"HIDE\"), context.scrollHideDelay);\n      return () => window.clearTimeout(hideTimer);\n    }\n  }, [state, context.scrollHideDelay, send]);\n  React2.useEffect(() => {\n    const viewport = context.viewport;\n    const scrollDirection = isHorizontal ? \"scrollLeft\" : \"scrollTop\";\n    if (viewport) {\n      let prevScrollPos = viewport[scrollDirection];\n      const handleScroll = () => {\n        const scrollPos = viewport[scrollDirection];\n        const hasScrollInDirectionChanged = prevScrollPos !== scrollPos;\n        if (hasScrollInDirectionChanged) {\n          send(\"SCROLL\");\n          debounceScrollEnd();\n        }\n        prevScrollPos = scrollPos;\n      };\n      viewport.addEventListener(\"scroll\", handleScroll);\n      return () => viewport.removeEventListener(\"scroll\", handleScroll);\n    }\n  }, [context.viewport, isHorizontal, send, debounceScrollEnd]);\n  return /* @__PURE__ */ jsx(Presence, { present: forceMount || state !== \"hidden\", children: /* @__PURE__ */ jsx(\n    ScrollAreaScrollbarVisible,\n    {\n      \"data-state\": state === \"hidden\" ? \"hidden\" : \"visible\",\n      ...scrollbarProps,\n      ref: forwardedRef,\n      onPointerEnter: composeEventHandlers(props.onPointerEnter, () => send(\"POINTER_ENTER\")),\n      onPointerLeave: composeEventHandlers(props.onPointerLeave, () => send(\"POINTER_LEAVE\"))\n    }\n  ) });\n});\nvar ScrollAreaScrollbarAuto = React2.forwardRef((props, forwardedRef) => {\n  const context = useScrollAreaContext(SCROLLBAR_NAME, props.__scopeScrollArea);\n  const { forceMount, ...scrollbarProps } = props;\n  const [visible, setVisible] = React2.useState(false);\n  const isHorizontal = props.orientation === \"horizontal\";\n  const handleResize = useDebounceCallback(() => {\n    if (context.viewport) {\n      const isOverflowX = context.viewport.offsetWidth < context.viewport.scrollWidth;\n      const isOverflowY = context.viewport.offsetHeight < context.viewport.scrollHeight;\n      setVisible(isHorizontal ? isOverflowX : isOverflowY);\n    }\n  }, 10);\n  useResizeObserver(context.viewport, handleResize);\n  useResizeObserver(context.content, handleResize);\n  return /* @__PURE__ */ jsx(Presence, { present: forceMount || visible, children: /* @__PURE__ */ jsx(\n    ScrollAreaScrollbarVisible,\n    {\n      \"data-state\": visible ? \"visible\" : \"hidden\",\n      ...scrollbarProps,\n      ref: forwardedRef\n    }\n  ) });\n});\nvar ScrollAreaScrollbarVisible = React2.forwardRef((props, forwardedRef) => {\n  const { orientation = \"vertical\", ...scrollbarProps } = props;\n  const context = useScrollAreaContext(SCROLLBAR_NAME, props.__scopeScrollArea);\n  const thumbRef = React2.useRef(null);\n  const pointerOffsetRef = React2.useRef(0);\n  const [sizes, setSizes] = React2.useState({\n    content: 0,\n    viewport: 0,\n    scrollbar: { size: 0, paddingStart: 0, paddingEnd: 0 }\n  });\n  const thumbRatio = getThumbRatio(sizes.viewport, sizes.content);\n  const commonProps = {\n    ...scrollbarProps,\n    sizes,\n    onSizesChange: setSizes,\n    hasThumb: Boolean(thumbRatio > 0 && thumbRatio < 1),\n    onThumbChange: (thumb) => thumbRef.current = thumb,\n    onThumbPointerUp: () => pointerOffsetRef.current = 0,\n    onThumbPointerDown: (pointerPos) => pointerOffsetRef.current = pointerPos\n  };\n  function getScrollPosition(pointerPos, dir) {\n    return getScrollPositionFromPointer(pointerPos, pointerOffsetRef.current, sizes, dir);\n  }\n  if (orientation === \"horizontal\") {\n    return /* @__PURE__ */ jsx(\n      ScrollAreaScrollbarX,\n      {\n        ...commonProps,\n        ref: forwardedRef,\n        onThumbPositionChange: () => {\n          if (context.viewport && thumbRef.current) {\n            const scrollPos = context.viewport.scrollLeft;\n            const offset = getThumbOffsetFromScroll(scrollPos, sizes, context.dir);\n            thumbRef.current.style.transform = `translate3d(${offset}px, 0, 0)`;\n          }\n        },\n        onWheelScroll: (scrollPos) => {\n          if (context.viewport) context.viewport.scrollLeft = scrollPos;\n        },\n        onDragScroll: (pointerPos) => {\n          if (context.viewport) {\n            context.viewport.scrollLeft = getScrollPosition(pointerPos, context.dir);\n          }\n        }\n      }\n    );\n  }\n  if (orientation === \"vertical\") {\n    return /* @__PURE__ */ jsx(\n      ScrollAreaScrollbarY,\n      {\n        ...commonProps,\n        ref: forwardedRef,\n        onThumbPositionChange: () => {\n          if (context.viewport && thumbRef.current) {\n            const scrollPos = context.viewport.scrollTop;\n            const offset = getThumbOffsetFromScroll(scrollPos, sizes);\n            thumbRef.current.style.transform = `translate3d(0, ${offset}px, 0)`;\n          }\n        },\n        onWheelScroll: (scrollPos) => {\n          if (context.viewport) context.viewport.scrollTop = scrollPos;\n        },\n        onDragScroll: (pointerPos) => {\n          if (context.viewport) context.viewport.scrollTop = getScrollPosition(pointerPos);\n        }\n      }\n    );\n  }\n  return null;\n});\nvar ScrollAreaScrollbarX = React2.forwardRef((props, forwardedRef) => {\n  const { sizes, onSizesChange, ...scrollbarProps } = props;\n  const context = useScrollAreaContext(SCROLLBAR_NAME, props.__scopeScrollArea);\n  const [computedStyle, setComputedStyle] = React2.useState();\n  const ref = React2.useRef(null);\n  const composeRefs = useComposedRefs(forwardedRef, ref, context.onScrollbarXChange);\n  React2.useEffect(() => {\n    if (ref.current) setComputedStyle(getComputedStyle(ref.current));\n  }, [ref]);\n  return /* @__PURE__ */ jsx(\n    ScrollAreaScrollbarImpl,\n    {\n      \"data-orientation\": \"horizontal\",\n      ...scrollbarProps,\n      ref: composeRefs,\n      sizes,\n      style: {\n        bottom: 0,\n        left: context.dir === \"rtl\" ? \"var(--radix-scroll-area-corner-width)\" : 0,\n        right: context.dir === \"ltr\" ? \"var(--radix-scroll-area-corner-width)\" : 0,\n        [\"--radix-scroll-area-thumb-width\"]: getThumbSize(sizes) + \"px\",\n        ...props.style\n      },\n      onThumbPointerDown: (pointerPos) => props.onThumbPointerDown(pointerPos.x),\n      onDragScroll: (pointerPos) => props.onDragScroll(pointerPos.x),\n      onWheelScroll: (event, maxScrollPos) => {\n        if (context.viewport) {\n          const scrollPos = context.viewport.scrollLeft + event.deltaX;\n          props.onWheelScroll(scrollPos);\n          if (isScrollingWithinScrollbarBounds(scrollPos, maxScrollPos)) {\n            event.preventDefault();\n          }\n        }\n      },\n      onResize: () => {\n        if (ref.current && context.viewport && computedStyle) {\n          onSizesChange({\n            content: context.viewport.scrollWidth,\n            viewport: context.viewport.offsetWidth,\n            scrollbar: {\n              size: ref.current.clientWidth,\n              paddingStart: toInt(computedStyle.paddingLeft),\n              paddingEnd: toInt(computedStyle.paddingRight)\n            }\n          });\n        }\n      }\n    }\n  );\n});\nvar ScrollAreaScrollbarY = React2.forwardRef((props, forwardedRef) => {\n  const { sizes, onSizesChange, ...scrollbarProps } = props;\n  const context = useScrollAreaContext(SCROLLBAR_NAME, props.__scopeScrollArea);\n  const [computedStyle, setComputedStyle] = React2.useState();\n  const ref = React2.useRef(null);\n  const composeRefs = useComposedRefs(forwardedRef, ref, context.onScrollbarYChange);\n  React2.useEffect(() => {\n    if (ref.current) setComputedStyle(getComputedStyle(ref.current));\n  }, [ref]);\n  return /* @__PURE__ */ jsx(\n    ScrollAreaScrollbarImpl,\n    {\n      \"data-orientation\": \"vertical\",\n      ...scrollbarProps,\n      ref: composeRefs,\n      sizes,\n      style: {\n        top: 0,\n        right: context.dir === \"ltr\" ? 0 : void 0,\n        left: context.dir === \"rtl\" ? 0 : void 0,\n        bottom: \"var(--radix-scroll-area-corner-height)\",\n        [\"--radix-scroll-area-thumb-height\"]: getThumbSize(sizes) + \"px\",\n        ...props.style\n      },\n      onThumbPointerDown: (pointerPos) => props.onThumbPointerDown(pointerPos.y),\n      onDragScroll: (pointerPos) => props.onDragScroll(pointerPos.y),\n      onWheelScroll: (event, maxScrollPos) => {\n        if (context.viewport) {\n          const scrollPos = context.viewport.scrollTop + event.deltaY;\n          props.onWheelScroll(scrollPos);\n          if (isScrollingWithinScrollbarBounds(scrollPos, maxScrollPos)) {\n            event.preventDefault();\n          }\n        }\n      },\n      onResize: () => {\n        if (ref.current && context.viewport && computedStyle) {\n          onSizesChange({\n            content: context.viewport.scrollHeight,\n            viewport: context.viewport.offsetHeight,\n            scrollbar: {\n              size: ref.current.clientHeight,\n              paddingStart: toInt(computedStyle.paddingTop),\n              paddingEnd: toInt(computedStyle.paddingBottom)\n            }\n          });\n        }\n      }\n    }\n  );\n});\nvar [ScrollbarProvider, useScrollbarContext] = createScrollAreaContext(SCROLLBAR_NAME);\nvar ScrollAreaScrollbarImpl = React2.forwardRef((props, forwardedRef) => {\n  const {\n    __scopeScrollArea,\n    sizes,\n    hasThumb,\n    onThumbChange,\n    onThumbPointerUp,\n    onThumbPointerDown,\n    onThumbPositionChange,\n    onDragScroll,\n    onWheelScroll,\n    onResize,\n    ...scrollbarProps\n  } = props;\n  const context = useScrollAreaContext(SCROLLBAR_NAME, __scopeScrollArea);\n  const [scrollbar, setScrollbar] = React2.useState(null);\n  const composeRefs = useComposedRefs(forwardedRef, (node) => setScrollbar(node));\n  const rectRef = React2.useRef(null);\n  const prevWebkitUserSelectRef = React2.useRef(\"\");\n  const viewport = context.viewport;\n  const maxScrollPos = sizes.content - sizes.viewport;\n  const handleWheelScroll = useCallbackRef(onWheelScroll);\n  const handleThumbPositionChange = useCallbackRef(onThumbPositionChange);\n  const handleResize = useDebounceCallback(onResize, 10);\n  function handleDragScroll(event) {\n    if (rectRef.current) {\n      const x = event.clientX - rectRef.current.left;\n      const y = event.clientY - rectRef.current.top;\n      onDragScroll({ x, y });\n    }\n  }\n  React2.useEffect(() => {\n    const handleWheel = (event) => {\n      const element = event.target;\n      const isScrollbarWheel = scrollbar?.contains(element);\n      if (isScrollbarWheel) handleWheelScroll(event, maxScrollPos);\n    };\n    document.addEventListener(\"wheel\", handleWheel, { passive: false });\n    return () => document.removeEventListener(\"wheel\", handleWheel, { passive: false });\n  }, [viewport, scrollbar, maxScrollPos, handleWheelScroll]);\n  React2.useEffect(handleThumbPositionChange, [sizes, handleThumbPositionChange]);\n  useResizeObserver(scrollbar, handleResize);\n  useResizeObserver(context.content, handleResize);\n  return /* @__PURE__ */ jsx(\n    ScrollbarProvider,\n    {\n      scope: __scopeScrollArea,\n      scrollbar,\n      hasThumb,\n      onThumbChange: useCallbackRef(onThumbChange),\n      onThumbPointerUp: useCallbackRef(onThumbPointerUp),\n      onThumbPositionChange: handleThumbPositionChange,\n      onThumbPointerDown: useCallbackRef(onThumbPointerDown),\n      children: /* @__PURE__ */ jsx(\n        Primitive.div,\n        {\n          ...scrollbarProps,\n          ref: composeRefs,\n          style: { position: \"absolute\", ...scrollbarProps.style },\n          onPointerDown: composeEventHandlers(props.onPointerDown, (event) => {\n            const mainPointer = 0;\n            if (event.button === mainPointer) {\n              const element = event.target;\n              element.setPointerCapture(event.pointerId);\n              rectRef.current = scrollbar.getBoundingClientRect();\n              prevWebkitUserSelectRef.current = document.body.style.webkitUserSelect;\n              document.body.style.webkitUserSelect = \"none\";\n              if (context.viewport) context.viewport.style.scrollBehavior = \"auto\";\n              handleDragScroll(event);\n            }\n          }),\n          onPointerMove: composeEventHandlers(props.onPointerMove, handleDragScroll),\n          onPointerUp: composeEventHandlers(props.onPointerUp, (event) => {\n            const element = event.target;\n            if (element.hasPointerCapture(event.pointerId)) {\n              element.releasePointerCapture(event.pointerId);\n            }\n            document.body.style.webkitUserSelect = prevWebkitUserSelectRef.current;\n            if (context.viewport) context.viewport.style.scrollBehavior = \"\";\n            rectRef.current = null;\n          })\n        }\n      )\n    }\n  );\n});\nvar THUMB_NAME = \"ScrollAreaThumb\";\nvar ScrollAreaThumb = React2.forwardRef(\n  (props, forwardedRef) => {\n    const { forceMount, ...thumbProps } = props;\n    const scrollbarContext = useScrollbarContext(THUMB_NAME, props.__scopeScrollArea);\n    return /* @__PURE__ */ jsx(Presence, { present: forceMount || scrollbarContext.hasThumb, children: /* @__PURE__ */ jsx(ScrollAreaThumbImpl, { ref: forwardedRef, ...thumbProps }) });\n  }\n);\nvar ScrollAreaThumbImpl = React2.forwardRef(\n  (props, forwardedRef) => {\n    const { __scopeScrollArea, style, ...thumbProps } = props;\n    const scrollAreaContext = useScrollAreaContext(THUMB_NAME, __scopeScrollArea);\n    const scrollbarContext = useScrollbarContext(THUMB_NAME, __scopeScrollArea);\n    const { onThumbPositionChange } = scrollbarContext;\n    const composedRef = useComposedRefs(\n      forwardedRef,\n      (node) => scrollbarContext.onThumbChange(node)\n    );\n    const removeUnlinkedScrollListenerRef = React2.useRef(void 0);\n    const debounceScrollEnd = useDebounceCallback(() => {\n      if (removeUnlinkedScrollListenerRef.current) {\n        removeUnlinkedScrollListenerRef.current();\n        removeUnlinkedScrollListenerRef.current = void 0;\n      }\n    }, 100);\n    React2.useEffect(() => {\n      const viewport = scrollAreaContext.viewport;\n      if (viewport) {\n        const handleScroll = () => {\n          debounceScrollEnd();\n          if (!removeUnlinkedScrollListenerRef.current) {\n            const listener = addUnlinkedScrollListener(viewport, onThumbPositionChange);\n            removeUnlinkedScrollListenerRef.current = listener;\n            onThumbPositionChange();\n          }\n        };\n        onThumbPositionChange();\n        viewport.addEventListener(\"scroll\", handleScroll);\n        return () => viewport.removeEventListener(\"scroll\", handleScroll);\n      }\n    }, [scrollAreaContext.viewport, debounceScrollEnd, onThumbPositionChange]);\n    return /* @__PURE__ */ jsx(\n      Primitive.div,\n      {\n        \"data-state\": scrollbarContext.hasThumb ? \"visible\" : \"hidden\",\n        ...thumbProps,\n        ref: composedRef,\n        style: {\n          width: \"var(--radix-scroll-area-thumb-width)\",\n          height: \"var(--radix-scroll-area-thumb-height)\",\n          ...style\n        },\n        onPointerDownCapture: composeEventHandlers(props.onPointerDownCapture, (event) => {\n          const thumb = event.target;\n          const thumbRect = thumb.getBoundingClientRect();\n          const x = event.clientX - thumbRect.left;\n          const y = event.clientY - thumbRect.top;\n          scrollbarContext.onThumbPointerDown({ x, y });\n        }),\n        onPointerUp: composeEventHandlers(props.onPointerUp, scrollbarContext.onThumbPointerUp)\n      }\n    );\n  }\n);\nScrollAreaThumb.displayName = THUMB_NAME;\nvar CORNER_NAME = \"ScrollAreaCorner\";\nvar ScrollAreaCorner = React2.forwardRef(\n  (props, forwardedRef) => {\n    const context = useScrollAreaContext(CORNER_NAME, props.__scopeScrollArea);\n    const hasBothScrollbarsVisible = Boolean(context.scrollbarX && context.scrollbarY);\n    const hasCorner = context.type !== \"scroll\" && hasBothScrollbarsVisible;\n    return hasCorner ? /* @__PURE__ */ jsx(ScrollAreaCornerImpl, { ...props, ref: forwardedRef }) : null;\n  }\n);\nScrollAreaCorner.displayName = CORNER_NAME;\nvar ScrollAreaCornerImpl = React2.forwardRef((props, forwardedRef) => {\n  const { __scopeScrollArea, ...cornerProps } = props;\n  const context = useScrollAreaContext(CORNER_NAME, __scopeScrollArea);\n  const [width, setWidth] = React2.useState(0);\n  const [height, setHeight] = React2.useState(0);\n  const hasSize = Boolean(width && height);\n  useResizeObserver(context.scrollbarX, () => {\n    const height2 = context.scrollbarX?.offsetHeight || 0;\n    context.onCornerHeightChange(height2);\n    setHeight(height2);\n  });\n  useResizeObserver(context.scrollbarY, () => {\n    const width2 = context.scrollbarY?.offsetWidth || 0;\n    context.onCornerWidthChange(width2);\n    setWidth(width2);\n  });\n  return hasSize ? /* @__PURE__ */ jsx(\n    Primitive.div,\n    {\n      ...cornerProps,\n      ref: forwardedRef,\n      style: {\n        width,\n        height,\n        position: \"absolute\",\n        right: context.dir === \"ltr\" ? 0 : void 0,\n        left: context.dir === \"rtl\" ? 0 : void 0,\n        bottom: 0,\n        ...props.style\n      }\n    }\n  ) : null;\n});\nfunction toInt(value) {\n  return value ? parseInt(value, 10) : 0;\n}\nfunction getThumbRatio(viewportSize, contentSize) {\n  const ratio = viewportSize / contentSize;\n  return isNaN(ratio) ? 0 : ratio;\n}\nfunction getThumbSize(sizes) {\n  const ratio = getThumbRatio(sizes.viewport, sizes.content);\n  const scrollbarPadding = sizes.scrollbar.paddingStart + sizes.scrollbar.paddingEnd;\n  const thumbSize = (sizes.scrollbar.size - scrollbarPadding) * ratio;\n  return Math.max(thumbSize, 18);\n}\nfunction getScrollPositionFromPointer(pointerPos, pointerOffset, sizes, dir = \"ltr\") {\n  const thumbSizePx = getThumbSize(sizes);\n  const thumbCenter = thumbSizePx / 2;\n  const offset = pointerOffset || thumbCenter;\n  const thumbOffsetFromEnd = thumbSizePx - offset;\n  const minPointerPos = sizes.scrollbar.paddingStart + offset;\n  const maxPointerPos = sizes.scrollbar.size - sizes.scrollbar.paddingEnd - thumbOffsetFromEnd;\n  const maxScrollPos = sizes.content - sizes.viewport;\n  const scrollRange = dir === \"ltr\" ? [0, maxScrollPos] : [maxScrollPos * -1, 0];\n  const interpolate = linearScale([minPointerPos, maxPointerPos], scrollRange);\n  return interpolate(pointerPos);\n}\nfunction getThumbOffsetFromScroll(scrollPos, sizes, dir = \"ltr\") {\n  const thumbSizePx = getThumbSize(sizes);\n  const scrollbarPadding = sizes.scrollbar.paddingStart + sizes.scrollbar.paddingEnd;\n  const scrollbar = sizes.scrollbar.size - scrollbarPadding;\n  const maxScrollPos = sizes.content - sizes.viewport;\n  const maxThumbPos = scrollbar - thumbSizePx;\n  const scrollClampRange = dir === \"ltr\" ? [0, maxScrollPos] : [maxScrollPos * -1, 0];\n  const scrollWithoutMomentum = clamp(scrollPos, scrollClampRange);\n  const interpolate = linearScale([0, maxScrollPos], [0, maxThumbPos]);\n  return interpolate(scrollWithoutMomentum);\n}\nfunction linearScale(input, output) {\n  return (value) => {\n    if (input[0] === input[1] || output[0] === output[1]) return output[0];\n    const ratio = (output[1] - output[0]) / (input[1] - input[0]);\n    return output[0] + ratio * (value - input[0]);\n  };\n}\nfunction isScrollingWithinScrollbarBounds(scrollPos, maxScrollPos) {\n  return scrollPos > 0 && scrollPos < maxScrollPos;\n}\nvar addUnlinkedScrollListener = (node, handler = () => {\n}) => {\n  let prevPosition = { left: node.scrollLeft, top: node.scrollTop };\n  let rAF = 0;\n  (function loop() {\n    const position = { left: node.scrollLeft, top: node.scrollTop };\n    const isHorizontalScroll = prevPosition.left !== position.left;\n    const isVerticalScroll = prevPosition.top !== position.top;\n    if (isHorizontalScroll || isVerticalScroll) handler();\n    prevPosition = position;\n    rAF = window.requestAnimationFrame(loop);\n  })();\n  return () => window.cancelAnimationFrame(rAF);\n};\nfunction useDebounceCallback(callback, delay) {\n  const handleCallback = useCallbackRef(callback);\n  const debounceTimerRef = React2.useRef(0);\n  React2.useEffect(() => () => window.clearTimeout(debounceTimerRef.current), []);\n  return React2.useCallback(() => {\n    window.clearTimeout(debounceTimerRef.current);\n    debounceTimerRef.current = window.setTimeout(handleCallback, delay);\n  }, [handleCallback, delay]);\n}\nfunction useResizeObserver(element, onResize) {\n  const handleResize = useCallbackRef(onResize);\n  useLayoutEffect(() => {\n    let rAF = 0;\n    if (element) {\n      const resizeObserver = new ResizeObserver(() => {\n        cancelAnimationFrame(rAF);\n        rAF = window.requestAnimationFrame(handleResize);\n      });\n      resizeObserver.observe(element);\n      return () => {\n        window.cancelAnimationFrame(rAF);\n        resizeObserver.unobserve(element);\n      };\n    }\n  }, [element, handleResize]);\n}\nvar Root = ScrollArea;\nvar Viewport = ScrollAreaViewport;\nvar Scrollbar = ScrollAreaScrollbar;\nvar Thumb = ScrollAreaThumb;\nvar Corner = ScrollAreaCorner;\nexport {\n  Corner,\n  Root,\n  ScrollArea,\n  ScrollAreaCorner,\n  ScrollAreaScrollbar,\n  ScrollAreaThumb,\n  ScrollAreaViewport,\n  Scrollbar,\n  Thumb,\n  Viewport,\n  createScrollAreaScope\n};\n//# sourceMappingURL=index.mjs.map\n","'use client'\n\nimport * as React from 'react'\nimport * as ScrollAreaPrimitive from '@radix-ui/react-scroll-area'\n\nimport { cn } from '@/lib/utils'\n\nfunction ScrollArea({\n  className,\n  children,\n  ...props\n}: React.ComponentProps<typeof ScrollAreaPrimitive.Root>) {\n  return (\n    <ScrollAreaPrimitive.Root\n      data-slot=\"scroll-area\"\n      className={cn('relative', className)}\n      {...props}\n    >\n      <ScrollAreaPrimitive.Viewport\n        data-slot=\"scroll-area-viewport\"\n        className=\"focus-visible:ring-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] outline-none focus-visible:ring-[3px] focus-visible:outline-1\"\n      >\n        {children}\n      </ScrollAreaPrimitive.Viewport>\n      <ScrollBar />\n      <ScrollAreaPrimitive.Corner />\n    </ScrollAreaPrimitive.Root>\n  )\n}\n\nfunction ScrollBar({\n  className,\n  orientation = 'vertical',\n  ...props\n}: React.ComponentProps<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>) {\n  return (\n    <ScrollAreaPrimitive.ScrollAreaScrollbar\n      data-slot=\"scroll-area-scrollbar\"\n      orientation={orientation}\n      className={cn(\n        'flex touch-none p-px transition-colors select-none',\n        orientation === 'vertical' &&\n          'h-full w-2.5 border-l border-l-transparent',\n        orientation === 'horizontal' &&\n          'h-2.5 flex-col border-t border-t-transparent',\n        className,\n      )}\n      {...props}\n    >\n      <ScrollAreaPrimitive.ScrollAreaThumb\n        data-slot=\"scroll-area-thumb\"\n        className=\"bg-border relative flex-1 rounded-full\"\n      />\n    </ScrollAreaPrimitive.ScrollAreaScrollbar>\n  )\n}\n\nexport { ScrollArea, ScrollBar }\n","'use client';\r\n\r\nimport React from 'react';\r\nimport { Label } from '@/components/ui/label';\r\nimport {\r\n  Select,\r\n  SelectContent,\r\n  SelectItem,\r\n  SelectTrigger,\r\n  SelectValue,\r\n} from '@/components/ui/select';\r\nimport { cn } from '@/lib/utils';\r\nimport { Trash2, FileText } from 'lucide-react';\r\n\r\nexport interface ActivityCardRedesignedProps {\r\n  activity: {\r\n    name: string;\r\n    kraId: string;\r\n    initiativeId?: string;\r\n    reported: number;\r\n    target: number;\r\n    achievement: number;\r\n    status: string;\r\n    dataType?: string;\r\n    confidenceScore?: number;\r\n    confidence?: number;\r\n    evidenceSnippet?: string;\r\n    prescriptiveNote?: string;\r\n  };\r\n  editedKRA?: string;\r\n  editedKPI?: string;\r\n  onKRAChange?: (kraId: string) => void;\r\n  onKPIChange?: (kpiId: string) => void;\r\n  onReportedChange?: (value: number) => void;\r\n  onTargetChange?: (value: number) => void;\r\n  onDelete?: () => void;\r\n  kraChanged?: boolean;\r\n  availableKRAs?: Array<{ id: string; title: string }>;\r\n  availableKPIs?: Array<{ id: string; title: string; target?: number; targetType?: string }>;\r\n  index?: number;\r\n  mismatches?: boolean;\r\n  kraValidationError?: string;\r\n  kpiValidationError?: string;\r\n}\r\n\r\n/**\r\n * Activity Card - Simplified Layout\r\n * Shows KRA/KPI assignment and evidence only (removed per-activity performance metrics to avoid confusion)\r\n */\r\nexport function ActivityCardRedesigned({\r\n  activity,\r\n  editedKRA,\r\n  editedKPI,\r\n  onKRAChange,\r\n  onKPIChange,\r\n  onDelete,\r\n  kraChanged,\r\n  availableKRAs = [],\r\n  availableKPIs = [],\r\n  mismatches,\r\n  kraValidationError,\r\n  kpiValidationError,\r\n}: ActivityCardRedesignedProps) {\r\n\r\n  return (\r\n    <div className=\"w-full bg-white rounded-2xl border border-gray-200 p-6 mb-4 shadow-sm\">\r\n      {/* Header */}\r\n      <div className=\"flex items-start justify-between mb-5\">\r\n        <div className=\"flex-1\">\r\n          <h3 className=\"text-lg font-bold text-gray-900\">{activity.name}</h3>\r\n        </div>\r\n        <div className=\"flex items-center gap-2\">\r\n          <button\r\n            onClick={onDelete}\r\n            className=\"text-gray-300 hover:text-red-500 transition-colors p-1\"\r\n            title=\"Delete\"\r\n          >\r\n            <Trash2 className=\"w-5 h-5\" />\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Main Content: Single Column Layout (removed confusing per-activity performance panel) */}\r\n      <div className=\"space-y-4\">\r\n        {/* Left: Context */}\r\n        <div className=\"space-y-4\">\r\n          {/* KRA Assignment */}\r\n          <div>\r\n            <Label className=\"text-xs font-bold text-gray-600 uppercase tracking-wide\">KRA Assignment *</Label>\r\n            <Select value={editedKRA || activity.kraId} onValueChange={onKRAChange}>\r\n              <SelectTrigger className={cn(\"w-full mt-1 bg-white border rounded-lg\", kraValidationError ? \"border-red-500\" : \"border-gray-300\")}>\r\n                <SelectValue placeholder=\"Select KRA\" />\r\n              </SelectTrigger>\r\n              <SelectContent>\r\n                {availableKRAs.map((kra) => (\r\n                  <SelectItem key={kra.id} value={kra.id}>\r\n                    {kra.id}: {kra.title}\r\n                  </SelectItem>\r\n                ))}\r\n              </SelectContent>\r\n            </Select>\r\n            {kraValidationError && <p className=\"text-xs text-red-500 mt-1\">{kraValidationError}</p>}\r\n            {mismatches && <p className=\"text-xs text-yellow-600 mt-1\">⚠️ Potential KRA mismatch detected</p>}\r\n          </div>\r\n\r\n          {/* KPI Selection */}\r\n          <div>\r\n            <Label className=\"text-xs font-bold text-gray-600 uppercase tracking-wide\">KPI Selection</Label>\r\n            <div className={cn(\"mt-1 bg-gray-50 rounded-lg border p-3\", kpiValidationError ? \"border-red-500\" : \"border-gray-200\")}>\r\n              <Select value={editedKPI || activity.initiativeId} onValueChange={onKPIChange}>\r\n                <SelectTrigger className=\"w-full bg-white border border-gray-300 rounded-md h-auto min-h-[40px] py-2\">\r\n                  <SelectValue placeholder=\"Select KPI\">\r\n                    {(editedKPI || activity.initiativeId) && (\r\n                      <span className=\"text-left\">{editedKPI || activity.initiativeId}</span>\r\n                    )}\r\n                  </SelectValue>\r\n                </SelectTrigger>\r\n                <SelectContent className=\"max-h-[300px] overflow-y-auto\">\r\n                  {availableKPIs.map((kpi) => (\r\n                    <SelectItem key={kpi.id} value={kpi.id} className=\"cursor-pointer\">\r\n                      <div className=\"py-1\">\r\n                        <div className=\"font-medium text-sm\">{kpi.id}</div>\r\n                        {kpi.title && (\r\n                          <div className=\"text-xs text-gray-500 mt-0.5 whitespace-normal max-w-[350px]\">\r\n                            {kpi.title}\r\n                          </div>\r\n                        )}\r\n                        {kpi.target !== undefined && (\r\n                          <div className=\"text-xs text-blue-600 font-medium mt-0.5\">\r\n                            Target: {kpi.target}{kpi.targetType === 'percentage' ? '%' : ''}\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                    </SelectItem>\r\n                  ))}\r\n                </SelectContent>\r\n              </Select>\r\n              {kpiValidationError && <p className=\"text-xs text-red-500 mt-1\">{kpiValidationError}</p>}\r\n              \r\n              {/* Selected KPI Details */}\r\n              {(editedKPI || activity.initiativeId) && (\r\n                <div className=\"mt-2 pt-2 border-t border-gray-200 space-y-1\">\r\n                  <p className=\"text-xs text-gray-500\">\r\n                    <span className=\"font-medium text-gray-700\">Output:</span> {availableKPIs.find(k => k.id === (editedKPI || activity.initiativeId))?.title || 'N/A'}\r\n                  </p>\r\n                  <p className=\"text-xs\">\r\n                    <span className=\"bg-blue-100 text-blue-700 px-2 py-0.5 rounded font-medium\">Target: {activity.target}</span>\r\n                  </p>\r\n                </div>\r\n              )}\r\n            </div>\r\n            {kraChanged && (\r\n              <span className=\"inline-block mt-1 text-xs bg-yellow-100 text-yellow-700 rounded px-2 py-1 font-semibold\">\r\n                Possible Mismatch\r\n              </span>\r\n            )}\r\n          </div>\r\n\r\n          {/* Evidence - only show if it's a real snippet, not auto-generated text */}\r\n          {activity.evidenceSnippet && \r\n           !activity.evidenceSnippet.startsWith('Target:') && \r\n           activity.evidenceSnippet.length > 10 && (\r\n            <div>\r\n              <Label className=\"text-xs font-bold text-gray-600 uppercase tracking-wide\">Evidence</Label>\r\n              <div className=\"mt-1 flex items-start gap-2 text-xs text-gray-600 bg-gray-50 p-3 rounded border border-dashed border-gray-300\">\r\n                <FileText className=\"w-4 h-4 mt-0.5 shrink-0\" />\r\n                <span className=\"italic\">\"{activity.evidenceSnippet}\"</span>\r\n              </div>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","'use client';\r\n\r\nimport { useState, useEffect } from 'react';\r\nimport {\r\n  Dialog,\r\n  DialogContent,\r\n  DialogHeader,\r\n  DialogTitle,\r\n  DialogFooter,\r\n} from '@/components/ui/dialog';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Label } from '@/components/ui/label';\r\nimport { ScrollArea } from '@/components/ui/scroll-area';\r\nimport { useToast } from '@/hooks/use-toast';\r\nimport { Loader2, CheckCircle, XCircle, Edit2, Target, Lightbulb } from 'lucide-react';\r\nimport AuthService from '@/lib/services/auth-service';\r\nimport strategicPlan from '@/lib/data/strategic_plan.json';\r\nimport { ActivityCardRedesigned } from '@/components/qpro/activity-card-redesigned';\r\nimport { computeAggregatedAchievement, getInitiativeTargetMeta, normalizeKraId } from '@/lib/utils/qpro-aggregation';\r\n\r\n// Interface for structured prescriptive analysis items\r\ninterface PrescriptiveItem {\r\n  title: string;\r\n  issue: string;\r\n  action: string;\r\n  nextStep?: string;\r\n}\r\n\r\n// Parse prescriptive text into structured items (same as qpro-analysis-detail.tsx)\r\nfunction parsePrescriptiveTextToItems(text: string): PrescriptiveItem[] {\r\n  if (typeof text !== 'string') return [];\r\n  const raw = text.replace(/\\r\\n/g, '\\n').trim();\r\n  if (!raw) return [];\r\n\r\n  const lines = raw.split('\\n');\r\n  const items: PrescriptiveItem[] = [];\r\n  let current: Partial<PrescriptiveItem> | null = null;\r\n\r\n  const pushCurrent = () => {\r\n    if (!current) return;\r\n    const title = String(current.title || '').trim();\r\n    const issue = String(current.issue || '').trim();\r\n    const action = String(current.action || '').trim();\r\n    const nextStep = current.nextStep ? String(current.nextStep).trim() : undefined;\r\n    if (title && issue && action) items.push({ title, issue, action, nextStep });\r\n    current = null;\r\n  };\r\n\r\n  for (const line of lines) {\r\n    const trimmed = line.trim();\r\n    if (!trimmed) continue;\r\n\r\n    const headerMatch = trimmed.match(/^\\d+\\.\\s+(.*)$/);\r\n    if (headerMatch) {\r\n      pushCurrent();\r\n      current = { title: headerMatch[1].trim() };\r\n      continue;\r\n    }\r\n\r\n    const fieldMatch = trimmed.match(/^(?:-\\s*)?(Issue|Action|Next\\s*Step)\\s*:\\s*(.*)$/i);\r\n    if (fieldMatch && current) {\r\n      const key = fieldMatch[1].toLowerCase().replace(/\\s+/g, '');\r\n      const value = fieldMatch[2].trim();\r\n      if (key === 'issue') current.issue = value;\r\n      if (key === 'action') current.action = value;\r\n      if (key === 'nextstep') current.nextStep = value;\r\n      continue;\r\n    }\r\n  }\r\n\r\n  pushCurrent();\r\n  return items;\r\n}\r\n\r\n// Format markdown text by removing raw markdown characters (same as qpro-analysis-detail.tsx)\r\nfunction formatMarkdownText(text: any): string {\r\n  if (!text) return '';\r\n  \r\n  if (typeof text !== 'string') {\r\n    if (Array.isArray(text)) {\r\n      return text.map((item: any) => formatMarkdownText(item)).join('\\n');\r\n    }\r\n    if (typeof text === 'object') {\r\n      if (text.action) {\r\n        return `${text.action}${text.timeline ? ` (${text.timeline})` : ''}`;\r\n      }\r\n      if (text.recommendation) {\r\n        return text.recommendation;\r\n      }\r\n      try {\r\n        return JSON.stringify(text);\r\n      } catch {\r\n        return String(text);\r\n      }\r\n    }\r\n    return String(text);\r\n  }\r\n  \r\n  let formatted = text;\r\n  \r\n  try {\r\n    const parsed = JSON.parse(formatted);\r\n    if (Array.isArray(parsed)) {\r\n      return parsed.map((item: any) => {\r\n        if (typeof item === 'string') return item;\r\n        if (item?.action) return item.action;\r\n        if (item?.recommendation) return item.recommendation;\r\n        return String(item);\r\n      }).join('\\n• ');\r\n    }\r\n    if (typeof parsed === 'object' && parsed !== null) {\r\n      if (parsed.action) return parsed.action;\r\n      if (parsed.recommendation) return parsed.recommendation;\r\n    }\r\n  } catch {\r\n    // Not JSON, continue with string processing\r\n  }\r\n  \r\n  formatted = formatted.replace(/^#{1,3}\\s+/gm, '');\r\n  formatted = formatted.replace(/\\*\\*([^*]+)\\*\\*/g, '$1');\r\n  formatted = formatted.replace(/\\*([^*]+)\\*/g, '$1');\r\n  formatted = formatted.replace(/^\\[\"|\"\\]$/g, '');\r\n  formatted = formatted.replace(/\",\"/g, ', ');\r\n  \r\n  return formatted.trim();\r\n}\r\n\r\n// Render formatted text with proper list formatting (same as qpro-analysis-detail.tsx)\r\nfunction renderFormattedText(text: string): React.ReactNode {\r\n  if (!text) return null;\r\n  \r\n  const lines = text.split('\\n').filter(line => line.trim());\r\n  \r\n  const elements: React.ReactNode[] = [];\r\n  let currentList: string[] = [];\r\n  let listType: 'bullet' | 'numbered' | null = null;\r\n  \r\n  const flushList = () => {\r\n    if (currentList.length > 0) {\r\n      if (listType === 'numbered') {\r\n        elements.push(\r\n          <ol key={`ol-${elements.length}`} className=\"list-decimal list-inside space-y-1 ml-2\">\r\n            {currentList.map((item, idx) => (\r\n              <li key={idx}>{formatMarkdownText(item)}</li>\r\n            ))}\r\n          </ol>\r\n        );\r\n      } else {\r\n        elements.push(\r\n          <ul key={`ul-${elements.length}`} className=\"list-disc list-inside space-y-1 ml-2\">\r\n            {currentList.map((item, idx) => (\r\n              <li key={idx}>{formatMarkdownText(item)}</li>\r\n            ))}\r\n          </ul>\r\n        );\r\n      }\r\n      currentList = [];\r\n      listType = null;\r\n    }\r\n  };\r\n  \r\n  lines.forEach((line, idx) => {\r\n    const trimmedLine = line.trim();\r\n    \r\n    if (trimmedLine.startsWith('###') || trimmedLine.startsWith('##') || trimmedLine.startsWith('#')) {\r\n      flushList();\r\n      const headerText = trimmedLine.replace(/^#{1,3}\\s+/, '');\r\n      elements.push(\r\n        <p key={`h-${idx}`} className=\"font-semibold mt-3 first:mt-0\">{formatMarkdownText(headerText)}</p>\r\n      );\r\n      return;\r\n    }\r\n    \r\n    const numberedMatch = trimmedLine.match(/^\\d+\\.\\s+(.+)/);\r\n    if (numberedMatch) {\r\n      if (listType !== 'numbered') {\r\n        flushList();\r\n        listType = 'numbered';\r\n      }\r\n      currentList.push(numberedMatch[1]);\r\n      return;\r\n    }\r\n    \r\n    const bulletMatch = trimmedLine.match(/^[-*]\\s+(.+)/);\r\n    if (bulletMatch) {\r\n      if (listType !== 'bullet') {\r\n        flushList();\r\n        listType = 'bullet';\r\n      }\r\n      currentList.push(bulletMatch[1]);\r\n      return;\r\n    }\r\n    \r\n    flushList();\r\n    if (trimmedLine) {\r\n      elements.push(\r\n        <p key={`p-${idx}`} className=\"mb-2 last:mb-0\">{formatMarkdownText(trimmedLine)}</p>\r\n      );\r\n    }\r\n  });\r\n  \r\n  flushList();\r\n  \r\n  return <div className=\"space-y-2\">{elements}</div>;\r\n}\r\n\r\n// Extract prescriptive value from various data structures\r\nfunction extractPrescriptiveValue(data: any): string | null {\r\n  if (!data) return null;\r\n  if (typeof data === 'string') return data;\r\n  \r\n  if (typeof data === 'object') {\r\n    if (data.recommendations || data.content || data.analysis || data.text) {\r\n      return data.recommendations || data.content || data.analysis || data.text;\r\n    }\r\n    \r\n    const keys = Object.keys(data);\r\n    if (keys.length === 0) return null;\r\n    \r\n    const valueKey = keys.find(k => k.length > 1) || keys[0];\r\n    const value = data[valueKey];\r\n    \r\n    if (typeof value === 'object' && value !== null) {\r\n      if (value.recommendations || value.content || value.analysis) {\r\n        return value.recommendations || value.content || value.analysis;\r\n      }\r\n      return JSON.stringify(value);\r\n    }\r\n    \r\n    return String(value);\r\n  }\r\n  \r\n  return null;\r\n}\r\n\r\n// KRA keywords for mismatch detection\r\nconst KRA_KEYWORDS: { [key: string]: string[] } = {\r\n  'KRA 1': ['curriculum', 'curricula', 'course', 'program design'],\r\n  'KRA 2': ['market', 'industry', 'demand'],\r\n  'KRA 3': ['instruction', 'teaching', 'learning', 'quality', 'student', 'employment', 'graduate'],\r\n  'KRA 4': ['international', 'mou', 'moa', 'global', 'linkage'],\r\n  'KRA 5': ['research', 'publication', 'innovation'],\r\n  'KRA 6': ['research linkage', 'collaboration', 'partnership'],\r\n  'KRA 7': ['research resources', 'funding', 'laboratory'],\r\n  'KRA 8': ['community', 'outreach', 'service'],\r\n  'KRA 11': ['human resources', 'faculty', 'staff'],\r\n  'KRA 12': ['international', 'global', 'stakeholder'],\r\n  'KRA 13': ['competitive', 'human resources'],\r\n  'KRA 14': ['satisfaction', 'satisfaction rating'],\r\n  'KRA 18': ['risk', 'compliance'],\r\n  'KRA 19': ['revenue', 'operational', 'efficiency'],\r\n  'KRA 22': ['financial', 'resources', 'budget'],\r\n};\r\n\r\n// Available KRAs for manual mapping (from LSPU Strategic Plan)\r\nconst AVAILABLE_KRAS = [\r\n  { id: 'KRA 1', title: 'Development of New Curricula Incorporating Emerging Technologies' },\r\n  { id: 'KRA 2', title: 'Market-Driven Program Design and Implementation' },\r\n  { id: 'KRA 3', title: 'Quality and Relevance of Instruction' },\r\n  { id: 'KRA 4', title: 'College and Office International Activities and Projects' },\r\n  { id: 'KRA 5', title: 'Research, Extension, and Innovation Productivity' },\r\n  { id: 'KRA 6', title: 'Research, Extension, and Innovation Linkages' },\r\n  { id: 'KRA 7', title: 'Research, Extension, and Innovation Resources' },\r\n  { id: 'KRA 8', title: 'Service to the Community' },\r\n  { id: 'KRA 9', title: 'Implementation of Sustainable Governance' },\r\n  { id: 'KRA 10', title: 'Transforming into Green University' },\r\n  { id: 'KRA 11', title: 'Judicious Management of Human Resources' },\r\n  { id: 'KRA 12', title: 'Internationalized/Global University Stakeholders' },\r\n  { id: 'KRA 13', title: 'Competitive Human Resources' },\r\n  { id: 'KRA 14', title: 'Improved Satisfaction Rating of the Students, Faculty, and Personnel of the University' },\r\n  { id: 'KRA 15', title: 'Certification and Compliance to Regulatory Requirements' },\r\n  { id: 'KRA 16', title: 'Updating of Learning Materials and Facilities' },\r\n  { id: 'KRA 17', title: 'Digital Transformation and Smart Campus Enablement' },\r\n  { id: 'KRA 18', title: 'Risk Management and Compliance' },\r\n  { id: 'KRA 19', title: 'Revenue Growth and Operational Efficiency' },\r\n  { id: 'KRA 20', title: 'Related IGP Industry Engagement' },\r\n  { id: 'KRA 21', title: 'Responsive Management of Resources' },\r\n  { id: 'KRA 22', title: 'Management of Financial Resources' },\r\n];\r\n\r\ninterface Activity {\r\n  name: string;\r\n  kraId: string;\r\n  initiativeId?: string;\r\n  reported: number;\r\n  target: number;\r\n  achievement: number;\r\n  status: 'MET' | 'MISSED';\r\n  authorizedStrategy?: string;\r\n  evidenceSnippet?: string;\r\n  confidence: number;\r\n  confidenceScore?: number;\r\n  prescriptiveNote?: string;\r\n  prescriptiveAnalysis?: string;\r\n  rootCause?: string;\r\n  aiInsight?: string;\r\n}\r\n\r\ninterface ReviewModalProps {\r\n  isOpen?: boolean;\r\n  onClose: () => void;\r\n  analysisId: string;\r\n  onApprove?: () => void;\r\n  onReject?: () => void;\r\n  forceFullPage?: boolean;\r\n}\r\n\r\nexport default function ReviewQProModal({\r\n  isOpen,\r\n  onClose,\r\n  analysisId,\r\n  onApprove,\r\n  onReject,\r\n  forceFullPage = false,\r\n}: ReviewModalProps) {\r\n  const { toast } = useToast();\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [analysis, setAnalysis] = useState<any>(null);\r\n  const [editedActivities, setEditedActivities] = useState<Activity[]>([]);\r\n  const [isSubmitting, setIsSubmitting] = useState(false);\r\n  const [isApproving, setIsApproving] = useState(false);\r\n  const [isRejecting, setIsRejecting] = useState(false);\r\n  const [isRegenerating, setIsRegenerating] = useState(false);\r\n  const [changedKRAIndices, setChangedKRAIndices] = useState<Set<number>>(new Set());\r\n  const [mismatches, setMismatches] = useState<{ [key: number]: boolean }>({});\r\n  const [kraValidationErrors, setKraValidationErrors] = useState<{ [key: number]: string }>({});\r\n  const [kpiValidationErrors, setKpiValidationErrors] = useState<{ [key: number]: string }>({});\r\n  const [currentProgress, setCurrentProgress] = useState<Map<string, { current: number; target: number }>>(new Map());\r\n  const [isAlreadyApproved, setIsAlreadyApproved] = useState(false);\r\n\r\n  // Fetch current KPI progress to show cumulative achievement\r\n  useEffect(() => {\r\n    if (!analysisId || (!isOpen && !forceFullPage)) return;\r\n\r\n    const fetchCurrentProgress = async () => {\r\n      try {\r\n        const token = await AuthService.getAccessToken();\r\n        \r\n        // First get the analysis to know which KPIs are involved\r\n        const analysisRes = await fetch(`/api/qpro/analyses/${analysisId}`, {\r\n          headers: { Authorization: `Bearer ${token}` }\r\n        });\r\n        \r\n        if (!analysisRes.ok) return;\r\n        \r\n        const analysisData = await analysisRes.json();\r\n        const activities = analysisData.activities || [];\r\n        \r\n        // Get unique KRA IDs from activities\r\n        const kraIds = Array.from(new Set(\r\n          activities\r\n            .map((a: any) => a.kraId)\r\n            .filter(Boolean)\r\n        ));\r\n        \r\n        // Fetch progress for each KRA\r\n        const progressMap = new Map<string, { current: number; target: number }>();\r\n        \r\n        for (const kraId of kraIds) {\r\n          const year = analysisData.year || new Date().getFullYear();\r\n          const progressRes = await fetch(\r\n            `/api/kpi-progress?kraId=${encodeURIComponent(kraId)}&year=${year}`,\r\n            { headers: { Authorization: `Bearer ${token}` } }\r\n          );\r\n          \r\n          if (progressRes.ok) {\r\n            const progressData = await progressRes.json();\r\n            const kraProgress = progressData.data;\r\n            \r\n            // Store current progress for each initiative\r\n            if (kraProgress?.initiatives) {\r\n              for (const initiative of kraProgress.initiatives) {\r\n                // Sum all quarters for the year\r\n                const yearProgress = initiative.progress\r\n                  ?.filter((p: any) => p.year === year)\r\n                  .reduce((sum: number, p: any) => {\r\n                    const val = typeof p.currentValue === 'number' \r\n                      ? p.currentValue \r\n                      : parseFloat(String(p.currentValue)) || 0;\r\n                    return sum + val;\r\n                  }, 0) || 0;\r\n                \r\n                // Get target from first quarter (they should all have same annual target)\r\n                const firstQuarter = initiative.progress?.find((p: any) => p.year === year);\r\n                const target = firstQuarter?.targetValue || 0;\r\n                \r\n                progressMap.set(initiative.id, {\r\n                  current: yearProgress,\r\n                  target: typeof target === 'number' ? target : parseFloat(String(target)) || 0\r\n                });\r\n              }\r\n            }\r\n          }\r\n        }\r\n        \r\n        setCurrentProgress(progressMap);\r\n      } catch (err) {\r\n        console.error('Error fetching current progress:', err);\r\n      }\r\n    };\r\n\r\n    fetchCurrentProgress();\r\n  }, [analysisId, isOpen, forceFullPage]);\r\n\r\n  useEffect(() => {\r\n    if (analysisId && (isOpen || forceFullPage)) {\r\n      fetchAnalysis();\r\n    }\r\n  }, [analysisId, isOpen, forceFullPage]);\r\n\r\n  // Helper to extract flat activities array from API response\r\n  const extractActivitiesFromResponse = (data: any): Activity[] => {\r\n    // Check if activities are directly available\r\n    if (data.activities && Array.isArray(data.activities) && data.activities.length > 0) {\r\n      return data.activities.map((act: any) => ({\r\n        name: act.name || act.title || 'Unnamed Activity',\r\n        kraId: act.kraId || act.kra_id || '',\r\n        initiativeId: act.initiativeId || act.initiative_id || '',\r\n        reported: Number(act.reported) || 0,\r\n        target: Number(act.target) || 0,\r\n        achievement: Number(act.achievement) || 0,\r\n        status: act.status === 'MET' ? 'MET' : 'MISSED',\r\n        authorizedStrategy: act.authorizedStrategy || '',\r\n        evidenceSnippet: act.evidenceSnippet || '',\r\n        confidence: Number(act.confidence) || 0.75,\r\n        confidenceScore: Number(act.confidenceScore) || Number(act.confidence) || 0.75,\r\n        prescriptiveNote: act.prescriptiveNote || '',\r\n        prescriptiveAnalysis: act.prescriptiveAnalysis || '',\r\n        rootCause: act.rootCause || '',\r\n        aiInsight: act.aiInsight || '',\r\n      }));\r\n    }\r\n\r\n    // Extract from organizedActivities (nested KRA → activities structure)\r\n    if (data.organizedActivities && Array.isArray(data.organizedActivities)) {\r\n      const flatActivities: Activity[] = [];\r\n      data.organizedActivities.forEach((kraGroup: any) => {\r\n        const kraId = kraGroup.kraId || '';\r\n        const kpiId = kraGroup.kpiId || '';\r\n        if (kraGroup.activities && Array.isArray(kraGroup.activities)) {\r\n          kraGroup.activities.forEach((act: any) => {\r\n            flatActivities.push({\r\n              name: act.title || act.name || 'Unnamed Activity',\r\n              kraId: kraId,\r\n              initiativeId: act.initiativeId || kpiId || '',\r\n              reported: Number(act.reported) || 0,\r\n              target: Number(act.target) || 0,\r\n              achievement: Number(act.achievement) || 0,\r\n              status: act.status === 'MET' || (Number(act.achievement) >= 100) ? 'MET' : 'MISSED',\r\n              authorizedStrategy: act.authorizedStrategy || '',\r\n              evidenceSnippet: act.evidenceSnippet || act.description || '',\r\n              confidence: Number(act.confidence) || 0.75,\r\n              confidenceScore: Number(act.confidenceScore) || Number(act.confidence) || 0.75,\r\n              prescriptiveNote: act.prescriptiveNote || '',\r\n              prescriptiveAnalysis: act.prescriptiveAnalysis || '',\r\n              rootCause: act.rootCause || '',\r\n              aiInsight: act.aiInsight || '',\r\n            });\r\n          });\r\n        }\r\n      });\r\n      return flatActivities;\r\n    }\r\n\r\n    return [];\r\n  };\r\n\r\n  const fetchAnalysis = async () => {\r\n    try {\r\n      setIsLoading(true);\r\n      const token = await AuthService.getAccessToken();\r\n      const response = await fetch(`/api/qpro/analyses/${analysisId}`, {\r\n        headers: { Authorization: `Bearer ${token}` },\r\n      });\r\n      if (!response.ok) throw new Error('Failed to fetch analysis');\r\n      const data = await response.json();\r\n      setAnalysis(data);\r\n      \r\n      // Check if analysis is already approved\r\n      if (data.status === 'APPROVED') {\r\n        setIsAlreadyApproved(true);\r\n      }\r\n      \r\n      // Extract activities from the response (handles both flat and nested structures)\r\n      const activities = extractActivitiesFromResponse(data);\r\n      setEditedActivities(activities);\r\n    } catch (err) {\r\n      setError(err instanceof Error ? err.message : 'An error occurred');\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const getInitiativesForKRA = (kraId: string) => {\r\n    const kra = strategicPlan.kras.find((k: any) => k.kra_id === kraId);\r\n    if (!kra?.initiatives) return [];\r\n    const currentYear = Number(analysis?.year) || new Date().getFullYear();\r\n    return kra.initiatives.map((i: any) => {\r\n      // Get target for current year from timeline_data\r\n      const timelineData = i.targets?.timeline_data;\r\n      const yearTarget = timelineData?.find((t: any) => t.year === currentYear);\r\n      const targetValue = yearTarget ? parseFloat(yearTarget.target_value) : undefined;\r\n      \r\n      return {\r\n        ...i,\r\n        title: i.key_performance_indicator?.outputs || i.key_performance_indicator?.outcomes || i.description || i.id,\r\n        target: targetValue,\r\n        targetType: i.targets?.type || 'count',\r\n      };\r\n    });\r\n  };\r\n\r\n  const findInitiative = (kraId: string, initiativeId?: string) => {\r\n    if (!initiativeId) return null;\r\n    const initiatives = getInitiativesForKRA(kraId);\r\n    return initiatives.find((i: any) => i.id === initiativeId);\r\n  };\r\n\r\n  const getTargetFromTimelineForYear = (timelineData: any[] | undefined, year: number) => {\r\n    if (!timelineData) return null;\r\n    const target = timelineData.find((t: any) => t.year === year);\r\n    return target ? parseFloat(target.target_value) : null;\r\n  };\r\n\r\n  const handleActivityChange = (index: number, field: keyof Activity, value: any) => {\r\n    const updated = [...editedActivities];\r\n    updated[index] = { ...updated[index], [field]: value };\r\n    \r\n    if (field === 'reported' || field === 'target') {\r\n      const reported = field === 'reported' ? value : updated[index].reported;\r\n      const target = field === 'target' ? value : updated[index].target;\r\n      if (target > 0) {\r\n        updated[index].achievement = (reported / target) * 100;\r\n        updated[index].status = updated[index].achievement >= 100 ? 'MET' : 'MISSED';\r\n      } else {\r\n        updated[index].achievement = 0;\r\n      }\r\n    }\r\n    setEditedActivities(updated);\r\n  };\r\n\r\n  const handleKRAChange = (index: number, kraId: string) => {\r\n    const updated = [...editedActivities];\r\n    updated[index] = { ...updated[index], kraId, initiativeId: undefined };\r\n    setEditedActivities(updated);\r\n    \r\n    const newChanged = new Set(changedKRAIndices);\r\n    newChanged.add(index);\r\n    setChangedKRAIndices(newChanged);\r\n    \r\n    // Check for mismatch\r\n    const keywords = KRA_KEYWORDS[kraId] || [];\r\n    const activityName = updated[index].name.toLowerCase();\r\n    const isMismatch = !keywords.some(k => activityName.includes(k));\r\n    setMismatches(prev => ({ ...prev, [index]: isMismatch }));\r\n  };\r\n\r\n  const handleKPIChange = (index: number, kpiId: string) => {\r\n    const updated = [...editedActivities];\r\n    updated[index] = { ...updated[index], initiativeId: kpiId };\r\n    \r\n    // Auto-set target if available\r\n    const year = Number(analysis?.year) || new Date().getFullYear();\r\n    const kpi = findInitiative(updated[index].kraId, kpiId);\r\n    const target = getTargetFromTimelineForYear(kpi?.targets?.timeline_data, year);\r\n    \r\n    if (target !== null) {\r\n      updated[index].target = target;\r\n      if (target > 0) {\r\n        updated[index].achievement = (updated[index].reported / target) * 100;\r\n        updated[index].status = updated[index].achievement >= 100 ? 'MET' : 'MISSED';\r\n      }\r\n    }\r\n    \r\n    setEditedActivities(updated);\r\n  };\r\n\r\n  const handleDeleteActivity = (index: number) => {\r\n    const updated = editedActivities.filter((_, i) => i !== index);\r\n    setEditedActivities(updated);\r\n  };\r\n\r\n  const validateKRAAssignments = () => {\r\n    const errors: { [key: number]: string } = {};\r\n    editedActivities.forEach((act, idx) => {\r\n      if (!act.kraId) errors[idx] = 'KRA is required';\r\n    });\r\n    setKraValidationErrors(errors);\r\n    return Object.keys(errors).length === 0;\r\n  };\r\n\r\n  const validateKPISelections = () => {\r\n    const errors: { [key: number]: string } = {};\r\n    editedActivities.forEach((act, idx) => {\r\n      if (changedKRAIndices.has(idx) && !act.initiativeId) {\r\n        errors[idx] = 'KPI is required for changed KRA';\r\n      }\r\n    });\r\n    setKpiValidationErrors(errors);\r\n    return Object.keys(errors).length === 0;\r\n  };\r\n\r\n  // Helper to safely extract text from various data structures\r\n  const safeExtractText = (val: any): string | null => {\r\n    if (!val) return null;\r\n    if (typeof val === 'string') return val;\r\n    if (Array.isArray(val)) {\r\n      // If array of objects with title/action/issue fields, format nicely\r\n      return val.map((item, idx) => {\r\n        if (typeof item === 'string') return `${idx + 1}. ${item}`;\r\n        if (typeof item === 'object') {\r\n          const title = item.title || item.issue || item.name || '';\r\n          const action = item.action || item.nextStep || item.recommendation || '';\r\n          if (title && action) return `**${title}**: ${action}`;\r\n          if (title) return `- ${title}`;\r\n          if (action) return `- ${action}`;\r\n          // Fallback: show key fields\r\n          const keys = Object.keys(item).filter(k => typeof item[k] === 'string');\r\n          return keys.map(k => `- **${k}**: ${item[k]}`).join('\\n');\r\n        }\r\n        return String(item);\r\n      }).join('\\n\\n');\r\n    }\r\n    if (typeof val === 'object') {\r\n      // Handle nested object with common fields\r\n      const parts: string[] = [];\r\n      if (val.documentInsight) parts.push(safeExtractText(val.documentInsight) || '');\r\n      if (val.prescriptiveAnalysis) parts.push(safeExtractText(val.prescriptiveAnalysis) || '');\r\n      if (val.summary) parts.push(safeExtractText(val.summary) || '');\r\n      if (val.recommendations) parts.push(safeExtractText(val.recommendations) || '');\r\n      if (val.prescriptiveItems) parts.push(safeExtractText(val.prescriptiveItems) || '');\r\n      if (parts.length > 0) return parts.filter(Boolean).join('\\n\\n');\r\n      // Fallback: iterate object keys\r\n      const entries = Object.entries(val).filter(([, v]) => v && typeof v === 'string');\r\n      if (entries.length > 0) {\r\n        return entries.map(([k, v]) => `**${k}**: ${v}`).join('\\n\\n');\r\n      }\r\n    }\r\n    return null;\r\n  };\r\n\r\n  const extractDocumentLevelInsight = (analysisData: any): string | null => {\r\n    if (!analysisData) return null;\r\n    const val = analysisData.aiInsight || analysisData.documentInsight;\r\n    return safeExtractText(val);\r\n  };\r\n\r\n  const extractDocumentLevelPrescriptive = (analysisData: any): string | null => {\r\n    if (!analysisData) return null;\r\n    const val = analysisData.prescriptiveAnalysis;\r\n    return safeExtractText(val);\r\n  };\r\n\r\n  // Regenerate insights for activities with changed KRAs\r\n  const handleRegenerateInsights = async () => {\r\n    if (changedKRAIndices.size === 0) {\r\n      setError('No KRA changes to regenerate');\r\n      return;\r\n    }\r\n\r\n    if (!validateKPISelections()) {\r\n      setError('Please select the correct KPI for each changed activity before regenerating.');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      setIsRegenerating(true);\r\n      setError(null);\r\n      \r\n      // Show toast notification that regeneration has started\r\n      toast({\r\n        title: 'Regenerating Insights',\r\n        description: 'Analyzing KPI types and generating fresh recommendations...',\r\n        duration: 3000,\r\n      });\r\n\r\n      const token = await AuthService.getAccessToken();\r\n      if (!token) {\r\n        throw new Error('Authentication required');\r\n      }\r\n\r\n      // Get activities with changed KRAs\r\n      const activitiesToRegenerate = editedActivities\r\n        .map((act, idx) => ({\r\n          ...act,\r\n          index: idx,\r\n          // When reviewer regenerates from this screen, treat KPI as explicitly selected.\r\n          // This prevents the regenerate endpoint from overriding initiativeId via LLM matching.\r\n          userSelectedKPI: true,\r\n        }))\r\n        .filter((act) => changedKRAIndices.has(act.index));\r\n\r\n      // Call API to regenerate insights based on new KRAs\r\n      const response = await fetch(`/api/qpro/regenerate-insights`, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          Authorization: `Bearer ${token}`,\r\n        },\r\n        body: JSON.stringify({\r\n          analysisId,\r\n          activities: activitiesToRegenerate,\r\n        }),\r\n      });\r\n\r\n      if (!response.ok) {\r\n        const errorData = await response.json();\r\n        throw new Error(\r\n          errorData.error || 'Failed to regenerate insights'\r\n        );\r\n      }\r\n\r\n      const regeneratedData = await response.json();\r\n\r\n      // CRITICAL FIX: After successful regeneration, refetch the complete analysis from the database\r\n      // to ensure we have the latest data including any server-side computed fields.\r\n      // This prevents stale data issues when user corrects KPI/KRA classifications.\r\n      console.log('[ReviewQProModal] Regeneration successful, refetching fresh analysis data...');\r\n      \r\n      // First, update with regenerated data immediately for responsiveness\r\n      setAnalysis((prev: any) => ({\r\n        ...(prev || {}),\r\n        ...regeneratedData,\r\n        // Mark as freshly regenerated\r\n        _regeneratedAt: new Date().toISOString(),\r\n      }));\r\n\r\n      // Update activities with new insights from response\r\n      setEditedActivities((prev) => {\r\n        const updated = [...prev];\r\n        regeneratedData.activities.forEach((regenerated: Activity) => {\r\n          const origIndex = activitiesToRegenerate.find(\r\n            (a) => a.name === regenerated.name\r\n          )?.index;\r\n          if (origIndex !== undefined) {\r\n            updated[origIndex] = {\r\n              ...updated[origIndex],\r\n              ...regenerated,\r\n            };\r\n          }\r\n        });\r\n        return updated;\r\n      });\r\n\r\n      // Then, refetch the complete analysis to ensure all computed fields are fresh\r\n      // This double-fetch ensures we pick up any server-side computed fields we may have missed\r\n      try {\r\n        const refetchResponse = await fetch(`/api/qpro/analyses/${analysisId}`, {\r\n          headers: { Authorization: `Bearer ${token}` },\r\n          // Add cache-busting to ensure we get fresh data\r\n          cache: 'no-store',\r\n        });\r\n        if (refetchResponse.ok) {\r\n          const freshData = await refetchResponse.json();\r\n          console.log('[ReviewQProModal] Fresh analysis data retrieved after regeneration');\r\n          \r\n          // Update analysis with fresh data from DB, preserving any local edits\r\n          setAnalysis((prev: any) => ({\r\n            ...(prev || {}),\r\n            ...freshData,\r\n            // Preserve the prescriptiveAnalysis from regeneration if freshData doesn't have it\r\n            prescriptiveAnalysis: freshData.prescriptiveAnalysis || regeneratedData.prescriptiveAnalysis || prev?.prescriptiveAnalysis,\r\n          }));\r\n          \r\n          // Re-extract activities from fresh data to ensure consistency\r\n          const freshActivities = extractActivitiesFromResponse(freshData);\r\n          if (freshActivities.length > 0) {\r\n            setEditedActivities(freshActivities);\r\n          }\r\n        }\r\n      } catch (refetchError) {\r\n        // Non-fatal: we already have regenerated data, just log the error\r\n        console.warn('[ReviewQProModal] Could not refetch fresh data after regeneration:', refetchError);\r\n      }\r\n\r\n      // Clear the changed KRA indices since we've regenerated\r\n      setChangedKRAIndices(new Set());\r\n      \r\n      setError(null);\r\n      \r\n      // Show prominent success notification\r\n      toast({\r\n        title: '✓ Success - Insights Regenerated',\r\n        description: `${activitiesToRegenerate.length} ${activitiesToRegenerate.length === 1 ? 'activity' : 'activities'} updated with fresh AI analysis and corrected KPI classifications.`,\r\n        duration: 5000,\r\n        className: 'bg-green-50 border-green-200',\r\n      });\r\n    } catch (err) {\r\n      setError(err instanceof Error ? err.message : 'Failed to regenerate insights');\r\n    } finally {\r\n      setIsRegenerating(false);\r\n    }\r\n  };\r\n\r\n  // Handle approve\r\n  const handleApprove = async () => {\r\n    try {\r\n      setIsApproving(true);\r\n      setError(null);\r\n      \r\n      // Validate all KRAs are assigned before approval\r\n      if (!validateKRAAssignments()) {\r\n        setError('Please assign a KRA to all activities before approval');\r\n        setIsApproving(false);\r\n        return;\r\n      }\r\n\r\n      // If any activity was reclassified, enforce KPI selection under the corrected KRA\r\n      if (!validateKPISelections()) {\r\n        setError('Please select the correct KPI under the corrected KRA before approval');\r\n        setIsApproving(false);\r\n        return;\r\n      }\r\n\r\n      const token = await AuthService.getAccessToken();\r\n      if (!token) {\r\n        throw new Error('Authentication required');\r\n      }\r\n\r\n      // CRITICAL: First update activities with edits - must succeed before approval\r\n      console.log('[ReviewModal] Saving activity edits before approval...');\r\n      const updateResponse = await fetch(`/api/qpro/analyses/${analysisId}`, {\r\n        method: 'PATCH',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          Authorization: `Bearer ${token}`,\r\n        },\r\n        body: JSON.stringify({\r\n          activities: editedActivities,\r\n        }),\r\n      });\r\n\r\n      if (!updateResponse.ok) {\r\n        const updateError = await updateResponse.json().catch(() => ({}));\r\n        throw new Error(updateError.error || 'Failed to save activity edits. Please try again.');\r\n      }\r\n\r\n      console.log('[ReviewModal] Activity edits saved successfully, proceeding with approval...');\r\n\r\n      // Then approve - this will use the updated activities from the database\r\n      const response = await fetch(`/api/qpro/approve/${analysisId}`, {\r\n        method: 'POST',\r\n        headers: {\r\n          Authorization: `Bearer ${token}`,\r\n        },\r\n      });\r\n\r\n      if (!response.ok) {\r\n        const errorData = await response.json();\r\n        throw new Error(errorData.error || 'Failed to approve analysis');\r\n      }\r\n\r\n      console.log('[ReviewModal] Analysis approved successfully');\r\n      console.log('[ReviewModal] Calling onApprove callback to trigger page reload...');\r\n      onApprove?.();\r\n      // Note: Don't call onClose() here as the page will reload anyway\r\n    } catch (err) {\r\n      setError(err instanceof Error ? err.message : 'Failed to approve');\r\n    } finally {\r\n      setIsApproving(false);\r\n    }\r\n  };\r\n\r\n  // Handle reject\r\n  const handleReject = async () => {\r\n    try {\r\n      setIsRejecting(true);\r\n      setError(null);\r\n\r\n      const token = await AuthService.getAccessToken();\r\n      if (!token) {\r\n        throw new Error('Authentication required');\r\n      }\r\n\r\n      const response = await fetch(`/api/qpro/approve/${analysisId}`, {\r\n        method: 'DELETE',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          Authorization: `Bearer ${token}`,\r\n        },\r\n        body: JSON.stringify({\r\n          reason: 'Rejected after review',\r\n        }),\r\n      });\r\n\r\n      if (!response.ok) {\r\n        throw new Error('Failed to reject analysis');\r\n      }\r\n\r\n      onReject?.();\r\n      onClose();\r\n    } catch (err) {\r\n      setError(err instanceof Error ? err.message : 'Failed to reject');\r\n    } finally {\r\n      setIsRejecting(false);\r\n    }\r\n  };\r\n\r\n  // Calculate summary stats using KPI-type-aware aggregation\r\n  // This matches the backend logic in regenerate-insights endpoint\r\n  const summaryStats = (() => {\r\n    const activitiesWithTarget = editedActivities.filter((a) => a.target > 0);\r\n    \r\n    // Group activities by KRA+KPI for proper aggregation (matching backend logic)\r\n    const groups = new Map<string, { kraId: string; initiativeId: string; activities: typeof activitiesWithTarget }>();\r\n    \r\n    for (const act of activitiesWithTarget) {\r\n      const kraId = String(act.kraId || '').trim();\r\n      const initiativeId = String(act.initiativeId || '').trim();\r\n      if (!kraId || !initiativeId) continue;\r\n      \r\n      const key = `${kraId}::${initiativeId}`;\r\n      if (!groups.has(key)) {\r\n        groups.set(key, { kraId, initiativeId, activities: [] });\r\n      }\r\n      groups.get(key)!.activities.push(act);\r\n    }\r\n    \r\n    // Calculate KPI-level achievements using type-aware aggregation\r\n    const allKRAs = (strategicPlan as any).kras || [];\r\n    const year = analysis?.year || 2025;\r\n    \r\n    const kpiAchievements: number[] = [];\r\n    for (const g of groups.values()) {\r\n      // Get target metadata from strategic plan\r\n      const meta = getInitiativeTargetMeta({ kras: allKRAs } as any, g.kraId, g.initiativeId, year);\r\n      \r\n      // Fallback target value\r\n      const fallbackTarget = typeof g.activities?.[0]?.target === 'number' \r\n        ? g.activities[0].target \r\n        : Number(g.activities?.[0]?.target || 0);\r\n      const targetValue = meta.targetValue ?? (Number.isFinite(fallbackTarget) && fallbackTarget > 0 ? fallbackTarget : 0);\r\n      \r\n      // Use the same aggregation logic as backend\r\n      const aggregated = computeAggregatedAchievement({\r\n        targetType: meta.targetType || g.activities?.[0]?.targetType,\r\n        targetValue,\r\n        targetScope: meta.targetScope,\r\n        activities: g.activities.map(a => ({ reported: a.reported, target: a.target })),\r\n      });\r\n      \r\n      // Calculate cumulative achievement including current progress from already approved documents\r\n      let cumulativeAchievement = aggregated.achievementPercent;\r\n      \r\n      if (g.initiativeId && currentProgress.has(g.initiativeId)) {\r\n        const progress = currentProgress.get(g.initiativeId)!;\r\n        const target = progress.target || targetValue || 1;\r\n        \r\n        // Add this document's contribution to current progress\r\n        const newTotal = progress.current + aggregated.totalReported;\r\n        const rawAchievement = target > 0 ? (newTotal / target) * 100 : 0;\r\n        \r\n        // Cap achievement at 100% - don't show excess percentage\r\n        cumulativeAchievement = Math.min(rawAchievement, 100);\r\n        \r\n        console.log(`[Review] KPI ${g.initiativeId}:`);\r\n        console.log(`  Current progress: ${progress.current}, This document adds: ${aggregated.totalReported}`);\r\n        console.log(`  New total: ${newTotal}, Target: ${target}, Raw Achievement: ${rawAchievement.toFixed(1)}%, Displayed: ${cumulativeAchievement.toFixed(1)}%`);\r\n      }\r\n      \r\n      if (cumulativeAchievement >= 0) {\r\n        kpiAchievements.push(cumulativeAchievement);\r\n      }\r\n    }\r\n    \r\n    // Overall achievement is the average of KPI-level cumulative achievements\r\n    const avgAchievement = kpiAchievements.length > 0\r\n      ? kpiAchievements.reduce((sum, pct) => sum + pct, 0) / kpiAchievements.length\r\n      : 0;\r\n    \r\n    // Count activities that met their targets (achievement >= 100%)\r\n    const metCount = activitiesWithTarget.filter((a) => a.achievement >= 100).length;\r\n    const missedCount = activitiesWithTarget.filter((a) => a.achievement < 100).length;\r\n\r\n    return {\r\n      totalActivities: editedActivities.length,\r\n      metCount,\r\n      missedCount,\r\n      avgAchievement,\r\n    };\r\n  })();\r\n\r\n  // Content component for both modal and full-page rendering\r\n  const ReviewContent = () => (\r\n    <>\r\n      {isLoading ? (\r\n        <div className=\"flex items-center justify-center py-12\">\r\n          <Loader2 className=\"w-6 h-6 animate-spin text-blue-600\" />\r\n          <span className=\"ml-2 text-slate-600\">Loading analysis...</span>\r\n        </div>\r\n      ) : error ? (\r\n        <div className=\"p-4 bg-red-50 border border-red-200 rounded-lg\">\r\n          <p className=\"text-red-700\">{error}</p>\r\n        </div>\r\n      ) : (\r\n        <>\r\n          {/* Already Approved Warning Banner */}\r\n          {isAlreadyApproved && (\r\n            <div className=\"p-4 mb-4 bg-amber-50 border border-amber-200 rounded-lg\">\r\n              <p className=\"text-amber-800 font-medium\">\r\n                Only DRAFT analyses can be edited. This analysis is already APPROVED\r\n              </p>\r\n            </div>\r\n          )}\r\n          \r\n          {/* Summary Stats */}\r\n          <div className=\"flex justify-center gap-3 mb-4 flex-wrap\">\r\n            <div className=\"p-3 bg-blue-50 rounded-lg text-center min-w-[100px]\">\r\n              <p className=\"text-2xl font-bold text-blue-700\">\r\n                {summaryStats.avgAchievement.toFixed(1)}%\r\n              </p>\r\n              <p className=\"text-xs text-blue-600\">Overall Achievement</p>\r\n            </div>\r\n            <div className=\"p-3 bg-slate-50 rounded-lg text-center min-w-[100px]\">\r\n              <p className=\"text-2xl font-bold text-slate-900\">\r\n                {summaryStats.totalActivities}\r\n              </p>\r\n              <p className=\"text-xs text-slate-600\">Total Activities</p>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Document-Level AI Review (exactly one insight + one prescriptive analysis per document) */}\r\n          {(() => {\r\n            const documentInsight = extractDocumentLevelInsight(analysis);\r\n            const prescriptiveRaw = extractDocumentLevelPrescriptive(analysis);\r\n\r\n            // Extract structured prescriptive items (same logic as qpro-analysis-detail.tsx)\r\n            const structuredItems: PrescriptiveItem[] = (() => {\r\n              // First, try to get prescriptiveItems directly from prescriptiveAnalysis object\r\n              const fromJson = (() => {\r\n                if (!analysis?.prescriptiveAnalysis || typeof analysis.prescriptiveAnalysis !== 'object') return [];\r\n                const items = (analysis.prescriptiveAnalysis as any).prescriptiveItems;\r\n                if (!Array.isArray(items)) return [];\r\n                return items\r\n                  .filter((x: any) => x && typeof x === 'object')\r\n                  .slice(0, 5)\r\n                  .map((x: any) => ({\r\n                    title: String(x.title || '').trim(),\r\n                    issue: String(x.issue || '').trim(),\r\n                    action: String(x.action || '').trim(),\r\n                    nextStep: x.nextStep ? String(x.nextStep).trim() : undefined,\r\n                  }))\r\n                  .filter((x: any) => x.title && x.issue && x.action);\r\n              })();\r\n\r\n              if (fromJson.length > 0) return fromJson;\r\n              \r\n              // Fallback: parse the prescriptive text into structured items\r\n              return prescriptiveRaw ? parsePrescriptiveTextToItems(prescriptiveRaw).slice(0, 5) : [];\r\n            })();\r\n\r\n            // Get document insight text from prescriptiveAnalysis object if available\r\n            const documentInsightText = (() => {\r\n              const fromJson = (analysis?.prescriptiveAnalysis && typeof analysis.prescriptiveAnalysis === 'object')\r\n                ? (analysis.prescriptiveAnalysis as any).documentInsight\r\n                : null;\r\n              if (typeof fromJson === 'string' && fromJson.trim()) return fromJson.trim();\r\n              return documentInsight || '';\r\n            })();\r\n\r\n            // Get prescriptive text for fallback rendering\r\n            const prescriptiveText = (() => {\r\n              const fromJson = (analysis?.prescriptiveAnalysis && typeof analysis.prescriptiveAnalysis === 'object')\r\n                ? (analysis.prescriptiveAnalysis as any).prescriptiveAnalysis\r\n                : null;\r\n              if (typeof fromJson === 'string' && fromJson.trim()) return fromJson.trim();\r\n              return prescriptiveRaw || '';\r\n            })();\r\n\r\n            const shouldShow = Boolean(documentInsightText || prescriptiveText || structuredItems.length > 0);\r\n            if (!shouldShow) return null;\r\n\r\n            return (\r\n              <div className=\"space-y-4 mb-4\">\r\n                {/* Document Insight Section */}\r\n                {documentInsightText && (\r\n                  <div className=\"p-4 bg-blue-50 border border-blue-200 rounded-lg\">\r\n                    <h4 className=\"font-semibold text-blue-900 mb-2 flex items-center gap-2 text-sm\">\r\n                      <Target className=\"w-4 h-4\" />\r\n                      Document Insight\r\n                    </h4>\r\n                    <div className=\"text-sm text-blue-800 prose prose-sm prose-blue max-w-none\">\r\n                      {renderFormattedText(documentInsightText)}\r\n                    </div>\r\n                  </div>\r\n                )}\r\n\r\n                {/* Prescriptive Analysis Section - Structured Format */}\r\n                {(structuredItems.length > 0 || prescriptiveText) && (\r\n                  <div className=\"p-4 bg-purple-50 border border-purple-200 rounded-lg\">\r\n                    <h4 className=\"font-semibold text-purple-900 mb-2 flex items-center gap-2 text-sm\">\r\n                      <Lightbulb className=\"w-4 h-4\" />\r\n                      Prescriptive Analysis\r\n                    </h4>\r\n                    <div className=\"text-sm text-purple-800 prose prose-sm prose-purple max-w-none\">\r\n                      {structuredItems.length > 0 ? (\r\n                        <ol className=\"list-decimal list-inside space-y-3\">\r\n                          {structuredItems.map((item, idx) => (\r\n                            <li key={idx} className=\"\">\r\n                              <span className=\"font-semibold text-purple-900\">{item.title}</span>\r\n\r\n                              <ul className=\"list-disc ml-6 mt-1 space-y-1\">\r\n                                <li>\r\n                                  <span className=\"font-semibold\">Issue:</span> {item.issue}\r\n                                </li>\r\n                                <li>\r\n                                  <span className=\"font-semibold\">Action:</span> {item.action}\r\n                                </li>\r\n                                {item.nextStep ? (\r\n                                  <li>\r\n                                    <span className=\"font-semibold\">Next Step:</span> {item.nextStep}\r\n                                  </li>\r\n                                ) : null}\r\n                              </ul>\r\n                            </li>\r\n                          ))}\r\n                        </ol>\r\n                      ) : (\r\n                        renderFormattedText(prescriptiveText)\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n                )}\r\n              </div>\r\n            );\r\n          })()}\r\n\r\n          {/* Activities List - Modern Split Layout */}\r\n          <ScrollArea className=\"flex-1\">\r\n            <div className=\"space-y-3 pr-4\">\r\n              {editedActivities.map((activity, idx) => (\r\n                <ActivityCardRedesigned\r\n                  key={activity.name + idx}\r\n                  activity={activity}\r\n                  mismatches={mismatches[idx]}\r\n                  kraValidationError={kraValidationErrors[idx]}\r\n                  kpiValidationError={kpiValidationErrors[idx]}\r\n                  availableKRAs={AVAILABLE_KRAS}\r\n                  availableKPIs={getInitiativesForKRA(activity.kraId)}\r\n                  onKRAChange={(v) => handleKRAChange(idx, v)}\r\n                  onKPIChange={(v) => handleKPIChange(idx, v)}\r\n                  onReportedChange={(v) => handleActivityChange(idx, 'reported', v)}\r\n                  onTargetChange={(v) => handleActivityChange(idx, 'target', v)}\r\n                  onDelete={() => handleDeleteActivity(idx)}\r\n                  kraChanged={changedKRAIndices.has(idx)}\r\n                />\r\n              ))}\r\n            </div>\r\n          </ScrollArea>\r\n        </>\r\n      )}\r\n    </>\r\n  );\r\n\r\n  // Footer component for both modal and full-page rendering\r\n  const ReviewFooter = () => (\r\n    <div className={forceFullPage ? 'mt-6 gap-2 flex flex-col sm:flex-row' : 'gap-2 flex flex-col sm:flex-row'}>\r\n      {/* Info text when KRAs are changed */}\r\n      {changedKRAIndices.size > 0 && !isAlreadyApproved && (\r\n        <div className=\"sm:col-span-2 md:col-span-3 p-3 bg-blue-50 border border-blue-200 rounded-lg mb-2\">\r\n          <p className=\"text-sm text-blue-700\">\r\n            <strong>{changedKRAIndices.size} activity update(s) pending.</strong> Click \"Regenerate Insights\" to update targets and document-level AI analysis based on corrected KRA/KPI selections.\r\n          </p>\r\n        </div>\r\n      )}\r\n      \r\n      <Button variant=\"outline\" onClick={onClose} disabled={isApproving || isRejecting || isRegenerating}>\r\n        Cancel\r\n      </Button>\r\n      \r\n      {/* Regenerate Insights Button - visible when KRAs changed and not already approved */}\r\n      {changedKRAIndices.size > 0 && !isAlreadyApproved && (\r\n        <Button\r\n          onClick={handleRegenerateInsights}\r\n          disabled={isRegenerating || isSubmitting}\r\n          className=\"bg-indigo-600 hover:bg-indigo-700\"\r\n        >\r\n          {isRegenerating ? (\r\n            <Loader2 className=\"w-4 h-4 animate-spin mr-2\" />\r\n          ) : (\r\n            <Edit2 className=\"w-4 h-4 mr-2\" />\r\n          )}\r\n          {isRegenerating ? 'Regenerating...' : 'Regenerate Insights'}\r\n        </Button>\r\n      )}\r\n      \r\n      <Button\r\n        variant=\"destructive\"\r\n        onClick={handleReject}\r\n        disabled={isLoading || isApproving || isRejecting || isRegenerating || isAlreadyApproved}\r\n      >\r\n        {isRejecting ? (\r\n          <>\r\n            <Loader2 className=\"w-4 h-4 animate-spin mr-2\" />\r\n            Rejecting...\r\n          </>\r\n        ) : (\r\n          <>\r\n            <XCircle className=\"w-4 h-4 mr-2\" />\r\n            Reject\r\n          </>\r\n        )}\r\n      </Button>\r\n      <Button\r\n        onClick={handleApprove}\r\n        disabled={isLoading || isApproving || isRejecting || isRegenerating || isAlreadyApproved}\r\n        className=\"bg-green-600 hover:bg-green-700\"\r\n      >\r\n        {isApproving ? (\r\n          <>\r\n            <Loader2 className=\"w-4 h-4 animate-spin mr-2\" />\r\n            Approving...\r\n          </>\r\n        ) : (\r\n          <>\r\n            <CheckCircle className=\"w-4 h-4 mr-2\" />\r\n            Approve & Commit\r\n          </>\r\n        )}\r\n      </Button>\r\n    </div>\r\n  );\r\n\r\n  // Render as full page or modal based on forceFullPage prop\r\n  if (forceFullPage) {\r\n    return (\r\n      <div className=\"space-y-6 relative\">\r\n        <div className=\"flex items-center gap-2\">\r\n          <Edit2 className=\"w-5 h-5\" />\r\n          <h2 className=\"text-2xl font-bold\">Review QPro Analysis</h2>\r\n        </div>\r\n        \r\n        {/* Loading overlay during regeneration */}\r\n        {isRegenerating && (\r\n          <div className=\"fixed inset-0 bg-white/80 backdrop-blur-sm z-50 flex items-center justify-center\">\r\n            <div className=\"bg-white rounded-lg shadow-xl border-2 border-indigo-200 p-8 flex flex-col items-center gap-4 max-w-md mx-4\">\r\n              <Loader2 className=\"w-12 h-12 animate-spin text-indigo-600\" />\r\n              <div className=\"text-center\">\r\n                <p className=\"text-xl font-semibold text-slate-900\">Regenerating Insights</p>\r\n                <p className=\"text-sm text-slate-600 mt-2\">\r\n                  Analyzing KPI types and generating fresh recommendations...\r\n                </p>\r\n                <p className=\"text-xs text-slate-500 mt-2\">\r\n                  This may take a few moments.\r\n                </p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n        \r\n        <ReviewContent />\r\n        <ReviewFooter />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // Default: render as modal\r\n  return (\r\n    <Dialog\r\n      open={!!isOpen}\r\n      onOpenChange={(open) => {\r\n        if (!open) onClose();\r\n      }}\r\n    >\r\n      <DialogContent className=\"w-[95vw] h-[95vh] max-w-[1400px] flex flex-col\">\r\n        <DialogHeader>\r\n          <DialogTitle className=\"flex items-center gap-2\">\r\n            <Edit2 className=\"w-5 h-5\" />\r\n            Review QPro Analysis\r\n          </DialogTitle>\r\n        </DialogHeader>\r\n\r\n        {/* Loading overlay during regeneration */}\r\n        {isRegenerating && (\r\n          <div className=\"absolute inset-0 bg-white/80 backdrop-blur-sm z-50 flex items-center justify-center\">\r\n            <div className=\"bg-white rounded-lg shadow-xl border-2 border-indigo-200 p-8 flex flex-col items-center gap-4 max-w-md\">\r\n              <Loader2 className=\"w-12 h-12 animate-spin text-indigo-600\" />\r\n              <div className=\"text-center\">\r\n                <p className=\"text-xl font-semibold text-slate-900\">Regenerating Insights</p>\r\n                <p className=\"text-sm text-slate-600 mt-2\">\r\n                  Analyzing KPI types and generating fresh recommendations...\r\n                </p>\r\n                <p className=\"text-xs text-slate-500 mt-2\">\r\n                  This may take a few moments.\r\n                </p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        <ReviewContent />\r\n\r\n        <DialogFooter className=\"mt-4 gap-2 flex flex-col sm:flex-row\">\r\n          <ReviewFooter />\r\n        </DialogFooter>\r\n      </DialogContent>\r\n    </Dialog>\r\n  );\r\n}\r\n","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name Pen\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMjEuMTc0IDYuODEyYTEgMSAwIDAgMC0zLjk4Ni0zLjk4N0wzLjg0MiAxNi4xNzRhMiAyIDAgMCAwLS41LjgzbC0xLjMyMSA0LjM1MmEuNS41IDAgMCAwIC42MjMuNjIybDQuMzUzLTEuMzJhMiAyIDAgMCAwIC44My0uNDk3eiIgLz4KPC9zdmc+Cg==) - https://lucide.dev/icons/pen\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Pen = createLucideIcon('Pen', [\n  [\n    'path',\n    {\n      d: 'M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z',\n      key: '1a8usu',\n    },\n  ],\n]);\n\nexport default Pen;\n","/// <reference types=\"resize-observer-browser\" />\n\nimport * as React from 'react';\nimport { Primitive } from '@radix-ui/react-primitive';\nimport { Presence } from '@radix-ui/react-presence';\nimport { createContextScope } from '@radix-ui/react-context';\nimport { useComposedRefs } from '@radix-ui/react-compose-refs';\nimport { useCallbackRef } from '@radix-ui/react-use-callback-ref';\nimport { useDirection } from '@radix-ui/react-direction';\nimport { useLayoutEffect } from '@radix-ui/react-use-layout-effect';\nimport { clamp } from '@radix-ui/number';\nimport { composeEventHandlers } from '@radix-ui/primitive';\nimport { useStateMachine } from './useStateMachine';\n\nimport type { Scope } from '@radix-ui/react-context';\n\ntype Direction = 'ltr' | 'rtl';\ntype Sizes = {\n  content: number;\n  viewport: number;\n  scrollbar: {\n    size: number;\n    paddingStart: number;\n    paddingEnd: number;\n  };\n};\n\n/* -------------------------------------------------------------------------------------------------\n * ScrollArea\n * -----------------------------------------------------------------------------------------------*/\n\nconst SCROLL_AREA_NAME = 'ScrollArea';\n\ntype ScopedProps<P> = P & { __scopeScrollArea?: Scope };\nconst [createScrollAreaContext, createScrollAreaScope] = createContextScope(SCROLL_AREA_NAME);\n\ntype ScrollAreaContextValue = {\n  type: 'auto' | 'always' | 'scroll' | 'hover';\n  dir: Direction;\n  scrollHideDelay: number;\n  scrollArea: ScrollAreaElement | null;\n  viewport: ScrollAreaViewportElement | null;\n  onViewportChange(viewport: ScrollAreaViewportElement | null): void;\n  content: HTMLDivElement | null;\n  onContentChange(content: HTMLDivElement): void;\n  scrollbarX: ScrollAreaScrollbarElement | null;\n  onScrollbarXChange(scrollbar: ScrollAreaScrollbarElement | null): void;\n  scrollbarXEnabled: boolean;\n  onScrollbarXEnabledChange(rendered: boolean): void;\n  scrollbarY: ScrollAreaScrollbarElement | null;\n  onScrollbarYChange(scrollbar: ScrollAreaScrollbarElement | null): void;\n  scrollbarYEnabled: boolean;\n  onScrollbarYEnabledChange(rendered: boolean): void;\n  onCornerWidthChange(width: number): void;\n  onCornerHeightChange(height: number): void;\n};\n\nconst [ScrollAreaProvider, useScrollAreaContext] =\n  createScrollAreaContext<ScrollAreaContextValue>(SCROLL_AREA_NAME);\n\ntype ScrollAreaElement = React.ElementRef<typeof Primitive.div>;\ntype PrimitiveDivProps = React.ComponentPropsWithoutRef<typeof Primitive.div>;\ninterface ScrollAreaProps extends PrimitiveDivProps {\n  type?: ScrollAreaContextValue['type'];\n  dir?: ScrollAreaContextValue['dir'];\n  scrollHideDelay?: number;\n}\n\nconst ScrollArea = React.forwardRef<ScrollAreaElement, ScrollAreaProps>(\n  (props: ScopedProps<ScrollAreaProps>, forwardedRef) => {\n    const {\n      __scopeScrollArea,\n      type = 'hover',\n      dir,\n      scrollHideDelay = 600,\n      ...scrollAreaProps\n    } = props;\n    const [scrollArea, setScrollArea] = React.useState<ScrollAreaElement | null>(null);\n    const [viewport, setViewport] = React.useState<ScrollAreaViewportElement | null>(null);\n    const [content, setContent] = React.useState<HTMLDivElement | null>(null);\n    const [scrollbarX, setScrollbarX] = React.useState<ScrollAreaScrollbarElement | null>(null);\n    const [scrollbarY, setScrollbarY] = React.useState<ScrollAreaScrollbarElement | null>(null);\n    const [cornerWidth, setCornerWidth] = React.useState(0);\n    const [cornerHeight, setCornerHeight] = React.useState(0);\n    const [scrollbarXEnabled, setScrollbarXEnabled] = React.useState(false);\n    const [scrollbarYEnabled, setScrollbarYEnabled] = React.useState(false);\n    const composedRefs = useComposedRefs(forwardedRef, (node) => setScrollArea(node));\n    const direction = useDirection(dir);\n\n    return (\n      <ScrollAreaProvider\n        scope={__scopeScrollArea}\n        type={type}\n        dir={direction}\n        scrollHideDelay={scrollHideDelay}\n        scrollArea={scrollArea}\n        viewport={viewport}\n        onViewportChange={setViewport}\n        content={content}\n        onContentChange={setContent}\n        scrollbarX={scrollbarX}\n        onScrollbarXChange={setScrollbarX}\n        scrollbarXEnabled={scrollbarXEnabled}\n        onScrollbarXEnabledChange={setScrollbarXEnabled}\n        scrollbarY={scrollbarY}\n        onScrollbarYChange={setScrollbarY}\n        scrollbarYEnabled={scrollbarYEnabled}\n        onScrollbarYEnabledChange={setScrollbarYEnabled}\n        onCornerWidthChange={setCornerWidth}\n        onCornerHeightChange={setCornerHeight}\n      >\n        <Primitive.div\n          dir={direction}\n          {...scrollAreaProps}\n          ref={composedRefs}\n          style={{\n            position: 'relative',\n            // Pass corner sizes as CSS vars to reduce re-renders of context consumers\n            ['--radix-scroll-area-corner-width' as any]: cornerWidth + 'px',\n            ['--radix-scroll-area-corner-height' as any]: cornerHeight + 'px',\n            ...props.style,\n          }}\n        />\n      </ScrollAreaProvider>\n    );\n  }\n);\n\nScrollArea.displayName = SCROLL_AREA_NAME;\n\n/* -------------------------------------------------------------------------------------------------\n * ScrollAreaViewport\n * -----------------------------------------------------------------------------------------------*/\n\nconst VIEWPORT_NAME = 'ScrollAreaViewport';\n\ntype ScrollAreaViewportElement = React.ElementRef<typeof Primitive.div>;\ninterface ScrollAreaViewportProps extends PrimitiveDivProps {\n  nonce?: string;\n}\n\nconst ScrollAreaViewport = React.forwardRef<ScrollAreaViewportElement, ScrollAreaViewportProps>(\n  (props: ScopedProps<ScrollAreaViewportProps>, forwardedRef) => {\n    const { __scopeScrollArea, children, nonce, ...viewportProps } = props;\n    const context = useScrollAreaContext(VIEWPORT_NAME, __scopeScrollArea);\n    const ref = React.useRef<ScrollAreaViewportElement>(null);\n    const composedRefs = useComposedRefs(forwardedRef, ref, context.onViewportChange);\n    return (\n      <>\n        {/* Hide scrollbars cross-browser and enable momentum scroll for touch devices */}\n        <style\n          dangerouslySetInnerHTML={{\n            __html: `[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}`,\n          }}\n          nonce={nonce}\n        />\n        <Primitive.div\n          data-radix-scroll-area-viewport=\"\"\n          {...viewportProps}\n          ref={composedRefs}\n          style={{\n            /**\n             * We don't support `visible` because the intention is to have at least one scrollbar\n             * if this component is used and `visible` will behave like `auto` in that case\n             * https://developer.mozilla.org/en-US/docs/Web/CSS/overflow#description\n             *\n             * We don't handle `auto` because the intention is for the native implementation\n             * to be hidden if using this component. We just want to ensure the node is scrollable\n             * so could have used either `scroll` or `auto` here. We picked `scroll` to prevent\n             * the browser from having to work out whether to render native scrollbars or not,\n             * we tell it to with the intention of hiding them in CSS.\n             */\n            overflowX: context.scrollbarXEnabled ? 'scroll' : 'hidden',\n            overflowY: context.scrollbarYEnabled ? 'scroll' : 'hidden',\n            ...props.style,\n          }}\n        >\n          {/**\n           * `display: table` ensures our content div will match the size of its children in both\n           * horizontal and vertical axis so we can determine if scroll width/height changed and\n           * recalculate thumb sizes. This doesn't account for children with *percentage*\n           * widths that change. We'll wait to see what use-cases consumers come up with there\n           * before trying to resolve it.\n           */}\n          <div ref={context.onContentChange} style={{ minWidth: '100%', display: 'table' }}>\n            {children}\n          </div>\n        </Primitive.div>\n      </>\n    );\n  }\n);\n\nScrollAreaViewport.displayName = VIEWPORT_NAME;\n\n/* -------------------------------------------------------------------------------------------------\n * ScrollAreaScrollbar\n * -----------------------------------------------------------------------------------------------*/\n\nconst SCROLLBAR_NAME = 'ScrollAreaScrollbar';\n\ntype ScrollAreaScrollbarElement = ScrollAreaScrollbarVisibleElement;\ninterface ScrollAreaScrollbarProps extends ScrollAreaScrollbarVisibleProps {\n  forceMount?: true;\n}\n\nconst ScrollAreaScrollbar = React.forwardRef<ScrollAreaScrollbarElement, ScrollAreaScrollbarProps>(\n  (props: ScopedProps<ScrollAreaScrollbarProps>, forwardedRef) => {\n    const { forceMount, ...scrollbarProps } = props;\n    const context = useScrollAreaContext(SCROLLBAR_NAME, props.__scopeScrollArea);\n    const { onScrollbarXEnabledChange, onScrollbarYEnabledChange } = context;\n    const isHorizontal = props.orientation === 'horizontal';\n\n    React.useEffect(() => {\n      isHorizontal ? onScrollbarXEnabledChange(true) : onScrollbarYEnabledChange(true);\n      return () => {\n        isHorizontal ? onScrollbarXEnabledChange(false) : onScrollbarYEnabledChange(false);\n      };\n    }, [isHorizontal, onScrollbarXEnabledChange, onScrollbarYEnabledChange]);\n\n    return context.type === 'hover' ? (\n      <ScrollAreaScrollbarHover {...scrollbarProps} ref={forwardedRef} forceMount={forceMount} />\n    ) : context.type === 'scroll' ? (\n      <ScrollAreaScrollbarScroll {...scrollbarProps} ref={forwardedRef} forceMount={forceMount} />\n    ) : context.type === 'auto' ? (\n      <ScrollAreaScrollbarAuto {...scrollbarProps} ref={forwardedRef} forceMount={forceMount} />\n    ) : context.type === 'always' ? (\n      <ScrollAreaScrollbarVisible {...scrollbarProps} ref={forwardedRef} />\n    ) : null;\n  }\n);\n\nScrollAreaScrollbar.displayName = SCROLLBAR_NAME;\n\n/* -----------------------------------------------------------------------------------------------*/\n\ntype ScrollAreaScrollbarHoverElement = ScrollAreaScrollbarAutoElement;\ninterface ScrollAreaScrollbarHoverProps extends ScrollAreaScrollbarAutoProps {\n  forceMount?: true;\n}\n\nconst ScrollAreaScrollbarHover = React.forwardRef<\n  ScrollAreaScrollbarHoverElement,\n  ScrollAreaScrollbarHoverProps\n>((props: ScopedProps<ScrollAreaScrollbarHoverProps>, forwardedRef) => {\n  const { forceMount, ...scrollbarProps } = props;\n  const context = useScrollAreaContext(SCROLLBAR_NAME, props.__scopeScrollArea);\n  const [visible, setVisible] = React.useState(false);\n\n  React.useEffect(() => {\n    const scrollArea = context.scrollArea;\n    let hideTimer = 0;\n    if (scrollArea) {\n      const handlePointerEnter = () => {\n        window.clearTimeout(hideTimer);\n        setVisible(true);\n      };\n      const handlePointerLeave = () => {\n        hideTimer = window.setTimeout(() => setVisible(false), context.scrollHideDelay);\n      };\n      scrollArea.addEventListener('pointerenter', handlePointerEnter);\n      scrollArea.addEventListener('pointerleave', handlePointerLeave);\n      return () => {\n        window.clearTimeout(hideTimer);\n        scrollArea.removeEventListener('pointerenter', handlePointerEnter);\n        scrollArea.removeEventListener('pointerleave', handlePointerLeave);\n      };\n    }\n  }, [context.scrollArea, context.scrollHideDelay]);\n\n  return (\n    <Presence present={forceMount || visible}>\n      <ScrollAreaScrollbarAuto\n        data-state={visible ? 'visible' : 'hidden'}\n        {...scrollbarProps}\n        ref={forwardedRef}\n      />\n    </Presence>\n  );\n});\n\ntype ScrollAreaScrollbarScrollElement = ScrollAreaScrollbarVisibleElement;\ninterface ScrollAreaScrollbarScrollProps extends ScrollAreaScrollbarVisibleProps {\n  forceMount?: true;\n}\n\nconst ScrollAreaScrollbarScroll = React.forwardRef<\n  ScrollAreaScrollbarScrollElement,\n  ScrollAreaScrollbarScrollProps\n>((props: ScopedProps<ScrollAreaScrollbarScrollProps>, forwardedRef) => {\n  const { forceMount, ...scrollbarProps } = props;\n  const context = useScrollAreaContext(SCROLLBAR_NAME, props.__scopeScrollArea);\n  const isHorizontal = props.orientation === 'horizontal';\n  const debounceScrollEnd = useDebounceCallback(() => send('SCROLL_END'), 100);\n  const [state, send] = useStateMachine('hidden', {\n    hidden: {\n      SCROLL: 'scrolling',\n    },\n    scrolling: {\n      SCROLL_END: 'idle',\n      POINTER_ENTER: 'interacting',\n    },\n    interacting: {\n      SCROLL: 'interacting',\n      POINTER_LEAVE: 'idle',\n    },\n    idle: {\n      HIDE: 'hidden',\n      SCROLL: 'scrolling',\n      POINTER_ENTER: 'interacting',\n    },\n  });\n\n  React.useEffect(() => {\n    if (state === 'idle') {\n      const hideTimer = window.setTimeout(() => send('HIDE'), context.scrollHideDelay);\n      return () => window.clearTimeout(hideTimer);\n    }\n  }, [state, context.scrollHideDelay, send]);\n\n  React.useEffect(() => {\n    const viewport = context.viewport;\n    const scrollDirection = isHorizontal ? 'scrollLeft' : 'scrollTop';\n\n    if (viewport) {\n      let prevScrollPos = viewport[scrollDirection];\n      const handleScroll = () => {\n        const scrollPos = viewport[scrollDirection];\n        const hasScrollInDirectionChanged = prevScrollPos !== scrollPos;\n        if (hasScrollInDirectionChanged) {\n          send('SCROLL');\n          debounceScrollEnd();\n        }\n        prevScrollPos = scrollPos;\n      };\n      viewport.addEventListener('scroll', handleScroll);\n      return () => viewport.removeEventListener('scroll', handleScroll);\n    }\n  }, [context.viewport, isHorizontal, send, debounceScrollEnd]);\n\n  return (\n    <Presence present={forceMount || state !== 'hidden'}>\n      <ScrollAreaScrollbarVisible\n        data-state={state === 'hidden' ? 'hidden' : 'visible'}\n        {...scrollbarProps}\n        ref={forwardedRef}\n        onPointerEnter={composeEventHandlers(props.onPointerEnter, () => send('POINTER_ENTER'))}\n        onPointerLeave={composeEventHandlers(props.onPointerLeave, () => send('POINTER_LEAVE'))}\n      />\n    </Presence>\n  );\n});\n\ntype ScrollAreaScrollbarAutoElement = ScrollAreaScrollbarVisibleElement;\ninterface ScrollAreaScrollbarAutoProps extends ScrollAreaScrollbarVisibleProps {\n  forceMount?: true;\n}\n\nconst ScrollAreaScrollbarAuto = React.forwardRef<\n  ScrollAreaScrollbarAutoElement,\n  ScrollAreaScrollbarAutoProps\n>((props: ScopedProps<ScrollAreaScrollbarAutoProps>, forwardedRef) => {\n  const context = useScrollAreaContext(SCROLLBAR_NAME, props.__scopeScrollArea);\n  const { forceMount, ...scrollbarProps } = props;\n  const [visible, setVisible] = React.useState(false);\n  const isHorizontal = props.orientation === 'horizontal';\n  const handleResize = useDebounceCallback(() => {\n    if (context.viewport) {\n      const isOverflowX = context.viewport.offsetWidth < context.viewport.scrollWidth;\n      const isOverflowY = context.viewport.offsetHeight < context.viewport.scrollHeight;\n      setVisible(isHorizontal ? isOverflowX : isOverflowY);\n    }\n  }, 10);\n\n  useResizeObserver(context.viewport, handleResize);\n  useResizeObserver(context.content, handleResize);\n\n  return (\n    <Presence present={forceMount || visible}>\n      <ScrollAreaScrollbarVisible\n        data-state={visible ? 'visible' : 'hidden'}\n        {...scrollbarProps}\n        ref={forwardedRef}\n      />\n    </Presence>\n  );\n});\n\n/* -----------------------------------------------------------------------------------------------*/\n\ntype ScrollAreaScrollbarVisibleElement = ScrollAreaScrollbarAxisElement;\ninterface ScrollAreaScrollbarVisibleProps\n  extends Omit<ScrollAreaScrollbarAxisProps, keyof ScrollAreaScrollbarAxisPrivateProps> {\n  orientation?: 'horizontal' | 'vertical';\n}\n\nconst ScrollAreaScrollbarVisible = React.forwardRef<\n  ScrollAreaScrollbarVisibleElement,\n  ScrollAreaScrollbarVisibleProps\n>((props: ScopedProps<ScrollAreaScrollbarVisibleProps>, forwardedRef) => {\n  const { orientation = 'vertical', ...scrollbarProps } = props;\n  const context = useScrollAreaContext(SCROLLBAR_NAME, props.__scopeScrollArea);\n  const thumbRef = React.useRef<ScrollAreaThumbElement | null>(null);\n  const pointerOffsetRef = React.useRef(0);\n  const [sizes, setSizes] = React.useState<Sizes>({\n    content: 0,\n    viewport: 0,\n    scrollbar: { size: 0, paddingStart: 0, paddingEnd: 0 },\n  });\n  const thumbRatio = getThumbRatio(sizes.viewport, sizes.content);\n\n  type UncommonProps = 'onThumbPositionChange' | 'onDragScroll' | 'onWheelScroll';\n  const commonProps: Omit<ScrollAreaScrollbarAxisPrivateProps, UncommonProps> = {\n    ...scrollbarProps,\n    sizes,\n    onSizesChange: setSizes,\n    hasThumb: Boolean(thumbRatio > 0 && thumbRatio < 1),\n    onThumbChange: (thumb) => (thumbRef.current = thumb),\n    onThumbPointerUp: () => (pointerOffsetRef.current = 0),\n    onThumbPointerDown: (pointerPos) => (pointerOffsetRef.current = pointerPos),\n  };\n\n  function getScrollPosition(pointerPos: number, dir?: Direction) {\n    return getScrollPositionFromPointer(pointerPos, pointerOffsetRef.current, sizes, dir);\n  }\n\n  if (orientation === 'horizontal') {\n    return (\n      <ScrollAreaScrollbarX\n        {...commonProps}\n        ref={forwardedRef}\n        onThumbPositionChange={() => {\n          if (context.viewport && thumbRef.current) {\n            const scrollPos = context.viewport.scrollLeft;\n            const offset = getThumbOffsetFromScroll(scrollPos, sizes, context.dir);\n            thumbRef.current.style.transform = `translate3d(${offset}px, 0, 0)`;\n          }\n        }}\n        onWheelScroll={(scrollPos) => {\n          if (context.viewport) context.viewport.scrollLeft = scrollPos;\n        }}\n        onDragScroll={(pointerPos) => {\n          if (context.viewport) {\n            context.viewport.scrollLeft = getScrollPosition(pointerPos, context.dir);\n          }\n        }}\n      />\n    );\n  }\n\n  if (orientation === 'vertical') {\n    return (\n      <ScrollAreaScrollbarY\n        {...commonProps}\n        ref={forwardedRef}\n        onThumbPositionChange={() => {\n          if (context.viewport && thumbRef.current) {\n            const scrollPos = context.viewport.scrollTop;\n            const offset = getThumbOffsetFromScroll(scrollPos, sizes);\n            thumbRef.current.style.transform = `translate3d(0, ${offset}px, 0)`;\n          }\n        }}\n        onWheelScroll={(scrollPos) => {\n          if (context.viewport) context.viewport.scrollTop = scrollPos;\n        }}\n        onDragScroll={(pointerPos) => {\n          if (context.viewport) context.viewport.scrollTop = getScrollPosition(pointerPos);\n        }}\n      />\n    );\n  }\n\n  return null;\n});\n\n/* -----------------------------------------------------------------------------------------------*/\n\ntype ScrollAreaScrollbarAxisPrivateProps = {\n  hasThumb: boolean;\n  sizes: Sizes;\n  onSizesChange(sizes: Sizes): void;\n  onThumbChange(thumb: ScrollAreaThumbElement | null): void;\n  onThumbPointerDown(pointerPos: number): void;\n  onThumbPointerUp(): void;\n  onThumbPositionChange(): void;\n  onWheelScroll(scrollPos: number): void;\n  onDragScroll(pointerPos: number): void;\n};\n\ntype ScrollAreaScrollbarAxisElement = ScrollAreaScrollbarImplElement;\ninterface ScrollAreaScrollbarAxisProps\n  extends Omit<ScrollAreaScrollbarImplProps, keyof ScrollAreaScrollbarImplPrivateProps>,\n    ScrollAreaScrollbarAxisPrivateProps {}\n\nconst ScrollAreaScrollbarX = React.forwardRef<\n  ScrollAreaScrollbarAxisElement,\n  ScrollAreaScrollbarAxisProps\n>((props: ScopedProps<ScrollAreaScrollbarAxisProps>, forwardedRef) => {\n  const { sizes, onSizesChange, ...scrollbarProps } = props;\n  const context = useScrollAreaContext(SCROLLBAR_NAME, props.__scopeScrollArea);\n  const [computedStyle, setComputedStyle] = React.useState<CSSStyleDeclaration>();\n  const ref = React.useRef<ScrollAreaScrollbarAxisElement>(null);\n  const composeRefs = useComposedRefs(forwardedRef, ref, context.onScrollbarXChange);\n\n  React.useEffect(() => {\n    if (ref.current) setComputedStyle(getComputedStyle(ref.current));\n  }, [ref]);\n\n  return (\n    <ScrollAreaScrollbarImpl\n      data-orientation=\"horizontal\"\n      {...scrollbarProps}\n      ref={composeRefs}\n      sizes={sizes}\n      style={{\n        bottom: 0,\n        left: context.dir === 'rtl' ? 'var(--radix-scroll-area-corner-width)' : 0,\n        right: context.dir === 'ltr' ? 'var(--radix-scroll-area-corner-width)' : 0,\n        ['--radix-scroll-area-thumb-width' as any]: getThumbSize(sizes) + 'px',\n        ...props.style,\n      }}\n      onThumbPointerDown={(pointerPos) => props.onThumbPointerDown(pointerPos.x)}\n      onDragScroll={(pointerPos) => props.onDragScroll(pointerPos.x)}\n      onWheelScroll={(event, maxScrollPos) => {\n        if (context.viewport) {\n          const scrollPos = context.viewport.scrollLeft + event.deltaX;\n          props.onWheelScroll(scrollPos);\n          // prevent window scroll when wheeling on scrollbar\n          if (isScrollingWithinScrollbarBounds(scrollPos, maxScrollPos)) {\n            event.preventDefault();\n          }\n        }\n      }}\n      onResize={() => {\n        if (ref.current && context.viewport && computedStyle) {\n          onSizesChange({\n            content: context.viewport.scrollWidth,\n            viewport: context.viewport.offsetWidth,\n            scrollbar: {\n              size: ref.current.clientWidth,\n              paddingStart: toInt(computedStyle.paddingLeft),\n              paddingEnd: toInt(computedStyle.paddingRight),\n            },\n          });\n        }\n      }}\n    />\n  );\n});\n\nconst ScrollAreaScrollbarY = React.forwardRef<\n  ScrollAreaScrollbarAxisElement,\n  ScrollAreaScrollbarAxisProps\n>((props: ScopedProps<ScrollAreaScrollbarAxisProps>, forwardedRef) => {\n  const { sizes, onSizesChange, ...scrollbarProps } = props;\n  const context = useScrollAreaContext(SCROLLBAR_NAME, props.__scopeScrollArea);\n  const [computedStyle, setComputedStyle] = React.useState<CSSStyleDeclaration>();\n  const ref = React.useRef<ScrollAreaScrollbarAxisElement>(null);\n  const composeRefs = useComposedRefs(forwardedRef, ref, context.onScrollbarYChange);\n\n  React.useEffect(() => {\n    if (ref.current) setComputedStyle(getComputedStyle(ref.current));\n  }, [ref]);\n\n  return (\n    <ScrollAreaScrollbarImpl\n      data-orientation=\"vertical\"\n      {...scrollbarProps}\n      ref={composeRefs}\n      sizes={sizes}\n      style={{\n        top: 0,\n        right: context.dir === 'ltr' ? 0 : undefined,\n        left: context.dir === 'rtl' ? 0 : undefined,\n        bottom: 'var(--radix-scroll-area-corner-height)',\n        ['--radix-scroll-area-thumb-height' as any]: getThumbSize(sizes) + 'px',\n        ...props.style,\n      }}\n      onThumbPointerDown={(pointerPos) => props.onThumbPointerDown(pointerPos.y)}\n      onDragScroll={(pointerPos) => props.onDragScroll(pointerPos.y)}\n      onWheelScroll={(event, maxScrollPos) => {\n        if (context.viewport) {\n          const scrollPos = context.viewport.scrollTop + event.deltaY;\n          props.onWheelScroll(scrollPos);\n          // prevent window scroll when wheeling on scrollbar\n          if (isScrollingWithinScrollbarBounds(scrollPos, maxScrollPos)) {\n            event.preventDefault();\n          }\n        }\n      }}\n      onResize={() => {\n        if (ref.current && context.viewport && computedStyle) {\n          onSizesChange({\n            content: context.viewport.scrollHeight,\n            viewport: context.viewport.offsetHeight,\n            scrollbar: {\n              size: ref.current.clientHeight,\n              paddingStart: toInt(computedStyle.paddingTop),\n              paddingEnd: toInt(computedStyle.paddingBottom),\n            },\n          });\n        }\n      }}\n    />\n  );\n});\n\n/* -----------------------------------------------------------------------------------------------*/\n\ntype ScrollbarContext = {\n  hasThumb: boolean;\n  scrollbar: ScrollAreaScrollbarElement | null;\n  onThumbChange(thumb: ScrollAreaThumbElement | null): void;\n  onThumbPointerUp(): void;\n  onThumbPointerDown(pointerPos: { x: number; y: number }): void;\n  onThumbPositionChange(): void;\n};\n\nconst [ScrollbarProvider, useScrollbarContext] =\n  createScrollAreaContext<ScrollbarContext>(SCROLLBAR_NAME);\n\ntype ScrollAreaScrollbarImplElement = React.ElementRef<typeof Primitive.div>;\ntype ScrollAreaScrollbarImplPrivateProps = {\n  sizes: Sizes;\n  hasThumb: boolean;\n  onThumbChange: ScrollbarContext['onThumbChange'];\n  onThumbPointerUp: ScrollbarContext['onThumbPointerUp'];\n  onThumbPointerDown: ScrollbarContext['onThumbPointerDown'];\n  onThumbPositionChange: ScrollbarContext['onThumbPositionChange'];\n  onWheelScroll(event: WheelEvent, maxScrollPos: number): void;\n  onDragScroll(pointerPos: { x: number; y: number }): void;\n  onResize(): void;\n};\ninterface ScrollAreaScrollbarImplProps\n  extends Omit<PrimitiveDivProps, keyof ScrollAreaScrollbarImplPrivateProps>,\n    ScrollAreaScrollbarImplPrivateProps {}\n\nconst ScrollAreaScrollbarImpl = React.forwardRef<\n  ScrollAreaScrollbarImplElement,\n  ScrollAreaScrollbarImplProps\n>((props: ScopedProps<ScrollAreaScrollbarImplProps>, forwardedRef) => {\n  const {\n    __scopeScrollArea,\n    sizes,\n    hasThumb,\n    onThumbChange,\n    onThumbPointerUp,\n    onThumbPointerDown,\n    onThumbPositionChange,\n    onDragScroll,\n    onWheelScroll,\n    onResize,\n    ...scrollbarProps\n  } = props;\n  const context = useScrollAreaContext(SCROLLBAR_NAME, __scopeScrollArea);\n  const [scrollbar, setScrollbar] = React.useState<ScrollAreaScrollbarElement | null>(null);\n  const composeRefs = useComposedRefs(forwardedRef, (node) => setScrollbar(node));\n  const rectRef = React.useRef<DOMRect | null>(null);\n  const prevWebkitUserSelectRef = React.useRef<string>('');\n  const viewport = context.viewport;\n  const maxScrollPos = sizes.content - sizes.viewport;\n  const handleWheelScroll = useCallbackRef(onWheelScroll);\n  const handleThumbPositionChange = useCallbackRef(onThumbPositionChange);\n  const handleResize = useDebounceCallback(onResize, 10);\n\n  function handleDragScroll(event: React.PointerEvent<HTMLElement>) {\n    if (rectRef.current) {\n      const x = event.clientX - rectRef.current.left;\n      const y = event.clientY - rectRef.current.top;\n      onDragScroll({ x, y });\n    }\n  }\n\n  /**\n   * We bind wheel event imperatively so we can switch off passive\n   * mode for document wheel event to allow it to be prevented\n   */\n  React.useEffect(() => {\n    const handleWheel = (event: WheelEvent) => {\n      const element = event.target as HTMLElement;\n      const isScrollbarWheel = scrollbar?.contains(element);\n      if (isScrollbarWheel) handleWheelScroll(event, maxScrollPos);\n    };\n    document.addEventListener('wheel', handleWheel, { passive: false });\n    return () => document.removeEventListener('wheel', handleWheel, { passive: false } as any);\n  }, [viewport, scrollbar, maxScrollPos, handleWheelScroll]);\n\n  /**\n   * Update thumb position on sizes change\n   */\n  React.useEffect(handleThumbPositionChange, [sizes, handleThumbPositionChange]);\n\n  useResizeObserver(scrollbar, handleResize);\n  useResizeObserver(context.content, handleResize);\n\n  return (\n    <ScrollbarProvider\n      scope={__scopeScrollArea}\n      scrollbar={scrollbar}\n      hasThumb={hasThumb}\n      onThumbChange={useCallbackRef(onThumbChange)}\n      onThumbPointerUp={useCallbackRef(onThumbPointerUp)}\n      onThumbPositionChange={handleThumbPositionChange}\n      onThumbPointerDown={useCallbackRef(onThumbPointerDown)}\n    >\n      <Primitive.div\n        {...scrollbarProps}\n        ref={composeRefs}\n        style={{ position: 'absolute', ...scrollbarProps.style }}\n        onPointerDown={composeEventHandlers(props.onPointerDown, (event) => {\n          const mainPointer = 0;\n          if (event.button === mainPointer) {\n            const element = event.target as HTMLElement;\n            element.setPointerCapture(event.pointerId);\n            rectRef.current = scrollbar!.getBoundingClientRect();\n            // pointer capture doesn't prevent text selection in Safari\n            // so we remove text selection manually when scrolling\n            prevWebkitUserSelectRef.current = document.body.style.webkitUserSelect;\n            document.body.style.webkitUserSelect = 'none';\n            if (context.viewport) context.viewport.style.scrollBehavior = 'auto';\n            handleDragScroll(event);\n          }\n        })}\n        onPointerMove={composeEventHandlers(props.onPointerMove, handleDragScroll)}\n        onPointerUp={composeEventHandlers(props.onPointerUp, (event) => {\n          const element = event.target as HTMLElement;\n          if (element.hasPointerCapture(event.pointerId)) {\n            element.releasePointerCapture(event.pointerId);\n          }\n          document.body.style.webkitUserSelect = prevWebkitUserSelectRef.current;\n          if (context.viewport) context.viewport.style.scrollBehavior = '';\n          rectRef.current = null;\n        })}\n      />\n    </ScrollbarProvider>\n  );\n});\n\n/* -------------------------------------------------------------------------------------------------\n * ScrollAreaThumb\n * -----------------------------------------------------------------------------------------------*/\n\nconst THUMB_NAME = 'ScrollAreaThumb';\n\ntype ScrollAreaThumbElement = ScrollAreaThumbImplElement;\ninterface ScrollAreaThumbProps extends ScrollAreaThumbImplProps {\n  /**\n   * Used to force mounting when more control is needed. Useful when\n   * controlling animation with React animation libraries.\n   */\n  forceMount?: true;\n}\n\nconst ScrollAreaThumb = React.forwardRef<ScrollAreaThumbElement, ScrollAreaThumbProps>(\n  (props: ScopedProps<ScrollAreaThumbProps>, forwardedRef) => {\n    const { forceMount, ...thumbProps } = props;\n    const scrollbarContext = useScrollbarContext(THUMB_NAME, props.__scopeScrollArea);\n    return (\n      <Presence present={forceMount || scrollbarContext.hasThumb}>\n        <ScrollAreaThumbImpl ref={forwardedRef} {...thumbProps} />\n      </Presence>\n    );\n  }\n);\n\ntype ScrollAreaThumbImplElement = React.ElementRef<typeof Primitive.div>;\ninterface ScrollAreaThumbImplProps extends PrimitiveDivProps {}\n\nconst ScrollAreaThumbImpl = React.forwardRef<ScrollAreaThumbImplElement, ScrollAreaThumbImplProps>(\n  (props: ScopedProps<ScrollAreaThumbImplProps>, forwardedRef) => {\n    const { __scopeScrollArea, style, ...thumbProps } = props;\n    const scrollAreaContext = useScrollAreaContext(THUMB_NAME, __scopeScrollArea);\n    const scrollbarContext = useScrollbarContext(THUMB_NAME, __scopeScrollArea);\n    const { onThumbPositionChange } = scrollbarContext;\n    const composedRef = useComposedRefs(forwardedRef, (node) =>\n      scrollbarContext.onThumbChange(node)\n    );\n    const removeUnlinkedScrollListenerRef = React.useRef<() => void>(undefined);\n    const debounceScrollEnd = useDebounceCallback(() => {\n      if (removeUnlinkedScrollListenerRef.current) {\n        removeUnlinkedScrollListenerRef.current();\n        removeUnlinkedScrollListenerRef.current = undefined;\n      }\n    }, 100);\n\n    React.useEffect(() => {\n      const viewport = scrollAreaContext.viewport;\n      if (viewport) {\n        /**\n         * We only bind to native scroll event so we know when scroll starts and ends.\n         * When scroll starts we start a requestAnimationFrame loop that checks for\n         * changes to scroll position. That rAF loop triggers our thumb position change\n         * when relevant to avoid scroll-linked effects. We cancel the loop when scroll ends.\n         * https://developer.mozilla.org/en-US/docs/Mozilla/Performance/Scroll-linked_effects\n         */\n        const handleScroll = () => {\n          debounceScrollEnd();\n          if (!removeUnlinkedScrollListenerRef.current) {\n            const listener = addUnlinkedScrollListener(viewport, onThumbPositionChange);\n            removeUnlinkedScrollListenerRef.current = listener;\n            onThumbPositionChange();\n          }\n        };\n        onThumbPositionChange();\n        viewport.addEventListener('scroll', handleScroll);\n        return () => viewport.removeEventListener('scroll', handleScroll);\n      }\n    }, [scrollAreaContext.viewport, debounceScrollEnd, onThumbPositionChange]);\n\n    return (\n      <Primitive.div\n        data-state={scrollbarContext.hasThumb ? 'visible' : 'hidden'}\n        {...thumbProps}\n        ref={composedRef}\n        style={{\n          width: 'var(--radix-scroll-area-thumb-width)',\n          height: 'var(--radix-scroll-area-thumb-height)',\n          ...style,\n        }}\n        onPointerDownCapture={composeEventHandlers(props.onPointerDownCapture, (event) => {\n          const thumb = event.target as HTMLElement;\n          const thumbRect = thumb.getBoundingClientRect();\n          const x = event.clientX - thumbRect.left;\n          const y = event.clientY - thumbRect.top;\n          scrollbarContext.onThumbPointerDown({ x, y });\n        })}\n        onPointerUp={composeEventHandlers(props.onPointerUp, scrollbarContext.onThumbPointerUp)}\n      />\n    );\n  }\n);\n\nScrollAreaThumb.displayName = THUMB_NAME;\n\n/* -------------------------------------------------------------------------------------------------\n * ScrollAreaCorner\n * -----------------------------------------------------------------------------------------------*/\n\nconst CORNER_NAME = 'ScrollAreaCorner';\n\ntype ScrollAreaCornerElement = ScrollAreaCornerImplElement;\ninterface ScrollAreaCornerProps extends ScrollAreaCornerImplProps {}\n\nconst ScrollAreaCorner = React.forwardRef<ScrollAreaCornerElement, ScrollAreaCornerProps>(\n  (props: ScopedProps<ScrollAreaCornerProps>, forwardedRef) => {\n    const context = useScrollAreaContext(CORNER_NAME, props.__scopeScrollArea);\n    const hasBothScrollbarsVisible = Boolean(context.scrollbarX && context.scrollbarY);\n    const hasCorner = context.type !== 'scroll' && hasBothScrollbarsVisible;\n    return hasCorner ? <ScrollAreaCornerImpl {...props} ref={forwardedRef} /> : null;\n  }\n);\n\nScrollAreaCorner.displayName = CORNER_NAME;\n\n/* -----------------------------------------------------------------------------------------------*/\n\ntype ScrollAreaCornerImplElement = React.ElementRef<typeof Primitive.div>;\ninterface ScrollAreaCornerImplProps extends PrimitiveDivProps {}\n\nconst ScrollAreaCornerImpl = React.forwardRef<\n  ScrollAreaCornerImplElement,\n  ScrollAreaCornerImplProps\n>((props: ScopedProps<ScrollAreaCornerImplProps>, forwardedRef) => {\n  const { __scopeScrollArea, ...cornerProps } = props;\n  const context = useScrollAreaContext(CORNER_NAME, __scopeScrollArea);\n  const [width, setWidth] = React.useState(0);\n  const [height, setHeight] = React.useState(0);\n  const hasSize = Boolean(width && height);\n\n  useResizeObserver(context.scrollbarX, () => {\n    const height = context.scrollbarX?.offsetHeight || 0;\n    context.onCornerHeightChange(height);\n    setHeight(height);\n  });\n\n  useResizeObserver(context.scrollbarY, () => {\n    const width = context.scrollbarY?.offsetWidth || 0;\n    context.onCornerWidthChange(width);\n    setWidth(width);\n  });\n\n  return hasSize ? (\n    <Primitive.div\n      {...cornerProps}\n      ref={forwardedRef}\n      style={{\n        width,\n        height,\n        position: 'absolute',\n        right: context.dir === 'ltr' ? 0 : undefined,\n        left: context.dir === 'rtl' ? 0 : undefined,\n        bottom: 0,\n        ...props.style,\n      }}\n    />\n  ) : null;\n});\n\n/* -----------------------------------------------------------------------------------------------*/\n\nfunction toInt(value?: string) {\n  return value ? parseInt(value, 10) : 0;\n}\n\nfunction getThumbRatio(viewportSize: number, contentSize: number) {\n  const ratio = viewportSize / contentSize;\n  return isNaN(ratio) ? 0 : ratio;\n}\n\nfunction getThumbSize(sizes: Sizes) {\n  const ratio = getThumbRatio(sizes.viewport, sizes.content);\n  const scrollbarPadding = sizes.scrollbar.paddingStart + sizes.scrollbar.paddingEnd;\n  const thumbSize = (sizes.scrollbar.size - scrollbarPadding) * ratio;\n  // minimum of 18 matches macOS minimum\n  return Math.max(thumbSize, 18);\n}\n\nfunction getScrollPositionFromPointer(\n  pointerPos: number,\n  pointerOffset: number,\n  sizes: Sizes,\n  dir: Direction = 'ltr'\n) {\n  const thumbSizePx = getThumbSize(sizes);\n  const thumbCenter = thumbSizePx / 2;\n  const offset = pointerOffset || thumbCenter;\n  const thumbOffsetFromEnd = thumbSizePx - offset;\n  const minPointerPos = sizes.scrollbar.paddingStart + offset;\n  const maxPointerPos = sizes.scrollbar.size - sizes.scrollbar.paddingEnd - thumbOffsetFromEnd;\n  const maxScrollPos = sizes.content - sizes.viewport;\n  const scrollRange = dir === 'ltr' ? [0, maxScrollPos] : [maxScrollPos * -1, 0];\n  const interpolate = linearScale([minPointerPos, maxPointerPos], scrollRange as [number, number]);\n  return interpolate(pointerPos);\n}\n\nfunction getThumbOffsetFromScroll(scrollPos: number, sizes: Sizes, dir: Direction = 'ltr') {\n  const thumbSizePx = getThumbSize(sizes);\n  const scrollbarPadding = sizes.scrollbar.paddingStart + sizes.scrollbar.paddingEnd;\n  const scrollbar = sizes.scrollbar.size - scrollbarPadding;\n  const maxScrollPos = sizes.content - sizes.viewport;\n  const maxThumbPos = scrollbar - thumbSizePx;\n  const scrollClampRange = dir === 'ltr' ? [0, maxScrollPos] : [maxScrollPos * -1, 0];\n  const scrollWithoutMomentum = clamp(scrollPos, scrollClampRange as [number, number]);\n  const interpolate = linearScale([0, maxScrollPos], [0, maxThumbPos]);\n  return interpolate(scrollWithoutMomentum);\n}\n\n// https://github.com/tmcw-up-for-adoption/simple-linear-scale/blob/master/index.js\nfunction linearScale(input: readonly [number, number], output: readonly [number, number]) {\n  return (value: number) => {\n    if (input[0] === input[1] || output[0] === output[1]) return output[0];\n    const ratio = (output[1] - output[0]) / (input[1] - input[0]);\n    return output[0] + ratio * (value - input[0]);\n  };\n}\n\nfunction isScrollingWithinScrollbarBounds(scrollPos: number, maxScrollPos: number) {\n  return scrollPos > 0 && scrollPos < maxScrollPos;\n}\n\n// Custom scroll handler to avoid scroll-linked effects\n// https://developer.mozilla.org/en-US/docs/Mozilla/Performance/Scroll-linked_effects\nconst addUnlinkedScrollListener = (node: HTMLElement, handler = () => {}) => {\n  let prevPosition = { left: node.scrollLeft, top: node.scrollTop };\n  let rAF = 0;\n  (function loop() {\n    const position = { left: node.scrollLeft, top: node.scrollTop };\n    const isHorizontalScroll = prevPosition.left !== position.left;\n    const isVerticalScroll = prevPosition.top !== position.top;\n    if (isHorizontalScroll || isVerticalScroll) handler();\n    prevPosition = position;\n    rAF = window.requestAnimationFrame(loop);\n  })();\n  return () => window.cancelAnimationFrame(rAF);\n};\n\nfunction useDebounceCallback(callback: () => void, delay: number) {\n  const handleCallback = useCallbackRef(callback);\n  const debounceTimerRef = React.useRef(0);\n  React.useEffect(() => () => window.clearTimeout(debounceTimerRef.current), []);\n  return React.useCallback(() => {\n    window.clearTimeout(debounceTimerRef.current);\n    debounceTimerRef.current = window.setTimeout(handleCallback, delay);\n  }, [handleCallback, delay]);\n}\n\nfunction useResizeObserver(element: HTMLElement | null, onResize: () => void) {\n  const handleResize = useCallbackRef(onResize);\n  useLayoutEffect(() => {\n    let rAF = 0;\n    if (element) {\n      /**\n       * Resize Observer will throw an often benign error that says `ResizeObserver loop\n       * completed with undelivered notifications`. This means that ResizeObserver was not\n       * able to deliver all observations within a single animation frame, so we use\n       * `requestAnimationFrame` to ensure we don't deliver unnecessary observations.\n       * Further reading: https://github.com/WICG/resize-observer/issues/38\n       */\n      const resizeObserver = new ResizeObserver(() => {\n        cancelAnimationFrame(rAF);\n        rAF = window.requestAnimationFrame(handleResize);\n      });\n      resizeObserver.observe(element);\n      return () => {\n        window.cancelAnimationFrame(rAF);\n        resizeObserver.unobserve(element);\n      };\n    }\n  }, [element, handleResize]);\n}\n\n/* -----------------------------------------------------------------------------------------------*/\n\nconst Root = ScrollArea;\nconst Viewport = ScrollAreaViewport;\nconst Scrollbar = ScrollAreaScrollbar;\nconst Thumb = ScrollAreaThumb;\nconst Corner = ScrollAreaCorner;\n\nexport {\n  createScrollAreaScope,\n  //\n  ScrollArea,\n  ScrollAreaViewport,\n  ScrollAreaScrollbar,\n  ScrollAreaThumb,\n  ScrollAreaCorner,\n  //\n  Root,\n  Viewport,\n  Scrollbar,\n  Thumb,\n  Corner,\n};\nexport type {\n  ScrollAreaProps,\n  ScrollAreaViewportProps,\n  ScrollAreaScrollbarProps,\n  ScrollAreaThumbProps,\n  ScrollAreaCornerProps,\n};\n"],"names":[],"mappings":"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","ignoreList":[1,5,6]}