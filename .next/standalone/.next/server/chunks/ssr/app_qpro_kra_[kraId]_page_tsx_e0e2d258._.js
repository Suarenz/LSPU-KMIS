module.exports=[38575,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(97895),f=a.i(70106);let g=(0,f.default)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);var h=a.i(92e3),i=a.i(24669),j=a.i(67453),k=a.i(4720),l=a.i(69520);let m=(0,f.default)("ListChecks",[["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"m3 7 2 2 4-4",key:"1obspn"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]]);var n=a.i(67900),o=a.i(54161),p=a.i(40695),q=a.i(23257),r=a.i(21937),s=a.i(50889),t=a.i(70121),u=a.i(50104),v=a.i(7554),w=a.i(25152),x=a.i(77994),y=a.i(3688),z=a.i(77192),A=a.i(30553),B="Checkbox",[C,D]=(0,u.createContextScope)(B),[E,F]=C(B),G=c.forwardRef((a,d)=>{let{__scopeCheckbox:e,name:f,checked:g,defaultChecked:h,required:i,disabled:j,value:k="on",onCheckedChange:l,form:m,...n}=a,[o,p]=c.useState(null),q=(0,t.useComposedRefs)(d,a=>p(a)),r=c.useRef(!1),s=!o||m||!!o.closest("form"),[u=!1,x]=(0,w.useControllableState)({prop:g,defaultProp:h,onChange:l}),y=c.useRef(u);return c.useEffect(()=>{let a=o?.form;if(a){let b=()=>x(y.current);return a.addEventListener("reset",b),()=>a.removeEventListener("reset",b)}},[o,x]),(0,b.jsxs)(E,{scope:e,state:u,disabled:j,children:[(0,b.jsx)(A.Primitive.button,{type:"button",role:"checkbox","aria-checked":K(u)?"mixed":u,"aria-required":i,"data-state":L(u),"data-disabled":j?"":void 0,disabled:j,value:k,...n,ref:q,onKeyDown:(0,v.composeEventHandlers)(a.onKeyDown,a=>{"Enter"===a.key&&a.preventDefault()}),onClick:(0,v.composeEventHandlers)(a.onClick,a=>{x(a=>!!K(a)||!a),s&&(r.current=a.isPropagationStopped(),r.current||a.stopPropagation())})}),s&&(0,b.jsx)(J,{control:o,bubbles:!r.current,name:f,value:k,checked:u,required:i,disabled:j,form:m,style:{transform:"translateX(-100%)"},defaultChecked:!K(h)&&h})]})});G.displayName=B;var H="CheckboxIndicator",I=c.forwardRef((a,c)=>{let{__scopeCheckbox:d,forceMount:e,...f}=a,g=F(H,d);return(0,b.jsx)(z.Presence,{present:e||K(g.state)||!0===g.state,children:(0,b.jsx)(A.Primitive.span,{"data-state":L(g.state),"data-disabled":g.disabled?"":void 0,...f,ref:c,style:{pointerEvents:"none",...a.style}})})});I.displayName=H;var J=a=>{let{control:d,checked:e,bubbles:f=!0,defaultChecked:g,...h}=a,i=c.useRef(null),j=(0,x.usePrevious)(e),k=(0,y.useSize)(d);c.useEffect(()=>{let a=i.current,b=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set;if(j!==e&&b){let c=new Event("click",{bubbles:f});a.indeterminate=K(e),b.call(a,!K(e)&&e),a.dispatchEvent(c)}},[j,e,f]);let l=c.useRef(!K(e)&&e);return(0,b.jsx)("input",{type:"checkbox","aria-hidden":!0,defaultChecked:g??l.current,...h,tabIndex:-1,ref:i,style:{...a.style,...k,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function K(a){return"indeterminate"===a}function L(a){return K(a)?"indeterminate":a?"checked":"unchecked"}var M=a.i(6406);function N({className:a,...c}){return(0,b.jsx)(G,{"data-slot":"checkbox",className:(0,e.cn)("peer border-input dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",a),...c,children:(0,b.jsx)(I,{"data-slot":"checkbox-indicator",className:"flex items-center justify-center text-current transition-none",children:(0,b.jsx)(M.CheckIcon,{className:"size-3.5"})})})}var O=a.i(87682);function P({targetType:a,value:c,onChange:d,placeholder:f="",className:g,disabled:h=!1}){switch(a){case"MILESTONE":return(0,b.jsx)(Q,{value:c,onChange:d,className:g,disabled:h});case"COUNT":return(0,b.jsx)(R,{value:c,onChange:d,placeholder:f,className:g,disabled:h});case"PERCENTAGE":return(0,b.jsx)(S,{value:c,onChange:d,placeholder:f,className:g,disabled:h});case"FINANCIAL":return(0,b.jsx)(T,{value:c,onChange:d,placeholder:f,className:g,disabled:h});case"TEXT_CONDITION":return(0,b.jsx)(U,{value:c,onChange:d,className:g,disabled:h});default:return(0,b.jsx)("input",{type:"text",value:c,onChange:a=>d(a.target.value),placeholder:f,disabled:h,className:(0,e.cn)("w-full px-3 py-2 text-sm border border-gray-300 rounded-md","focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",h&&"bg-gray-100 cursor-not-allowed",g)})}}function Q({value:a,onChange:c,className:d,disabled:f}){let g=1===a||"1"===a;return(0,b.jsxs)("div",{className:(0,e.cn)("flex items-center gap-2",d),children:[(0,b.jsx)(N,{checked:g,onCheckedChange:a=>c(+!!a),disabled:f,className:"h-5 w-5"}),(0,b.jsx)("span",{className:"text-sm text-gray-600",children:g?"Achieved":"Pending"})]})}function R({value:a,onChange:c,placeholder:d,className:f,disabled:g}){return(0,b.jsx)("input",{type:"text",inputMode:"numeric",value:a,onChange:a=>{let b=a.target.value;(""===b||/^\d+$/.test(b))&&c(""===b?"":parseInt(b,10))},placeholder:d||"0",disabled:g,className:(0,e.cn)("w-32 px-3 py-2 text-sm text-right border border-gray-300 rounded-md","focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",g&&"bg-gray-100 cursor-not-allowed",f)})}function S({value:a,onChange:c,placeholder:d,className:f,disabled:g}){return(0,b.jsxs)("div",{className:(0,e.cn)("flex items-center gap-1",f),children:[(0,b.jsx)("input",{type:"text",inputMode:"decimal",value:a,onChange:a=>{let b=a.target.value;if(""===b||/^\d*\.?\d*$/.test(b)){let a=parseFloat(b);(""===b||a>=0&&a<=100)&&c(b)}},placeholder:d||"0",disabled:g,className:(0,e.cn)("w-24 px-3 py-2 text-sm text-right border border-gray-300 rounded-md","focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",g&&"bg-gray-100 cursor-not-allowed")}),(0,b.jsx)("span",{className:"text-sm text-gray-500 font-medium",children:"%"})]})}function T({value:a,onChange:c,placeholder:d,className:f,disabled:g}){let h=(a=>{if(!a&&0!==a)return"";let[b,c]=a.toString().replace(/,/g,"").split("."),d=b.replace(/\B(?=(\d{3})+(?!\d))/g,",");return void 0!==c?`${d}.${c}`:d})(a);return(0,b.jsxs)("div",{className:(0,e.cn)("flex items-center gap-1",f),children:[(0,b.jsx)("span",{className:"text-sm text-gray-500 font-medium",children:"₱"}),(0,b.jsx)("input",{type:"text",inputMode:"decimal",value:h,onChange:a=>{let b=a.target.value.replace(/,/g,"");(""===b||/^\d*\.?\d{0,2}$/.test(b))&&c(b)},placeholder:d||"0.00",disabled:g,className:(0,e.cn)("w-36 px-3 py-2 text-sm text-right border border-gray-300 rounded-md","focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",g&&"bg-gray-100 cursor-not-allowed")})]})}function U({value:a,onChange:c,className:d,disabled:f}){return(0,b.jsxs)(O.Select,{value:a.toString(),onValueChange:c,disabled:f,children:[(0,b.jsx)(O.SelectTrigger,{className:(0,e.cn)("w-40",d),children:(0,b.jsx)(O.SelectValue,{placeholder:"Select status..."})}),(0,b.jsx)(O.SelectContent,{children:[{value:"Met",label:"Met"},{value:"Not Met",label:"Not Met"},{value:"In Progress",label:"In Progress"}].map(a=>(0,b.jsx)(O.SelectItem,{value:a.value,children:a.label},a.value))})]})}function V(a){if(!a)return"COUNT";let b=a.toLowerCase().trim();return b.includes("milestone")||b.includes("binary")||"boolean"===b?"MILESTONE":b.includes("percentage")||b.includes("percent")||b.includes("rate")?"PERCENTAGE":b.includes("currency")||b.includes("financial")||b.includes("budget")||b.includes("revenue")||b.includes("cost")?"FINANCIAL":b.includes("text")||b.includes("condition")||b.includes("status")||b.includes("qualitative")?"TEXT_CONDITION":(b.includes("count")||b.includes("numeric")||b.includes("number")||b.includes("quantity"),"COUNT")}let W=["bg-red-100 text-red-800","bg-blue-100 text-blue-800","bg-green-100 text-green-800","bg-yellow-100 text-yellow-800","bg-purple-100 text-purple-800","bg-pink-100 text-pink-800","bg-indigo-100 text-indigo-800","bg-cyan-100 text-cyan-800","bg-orange-100 text-orange-800","bg-teal-100 text-teal-800","bg-lime-100 text-lime-800","bg-rose-100 text-rose-800","bg-sky-100 text-sky-800","bg-violet-100 text-violet-800","bg-amber-100 text-amber-800","bg-emerald-100 text-emerald-800","bg-fuchsia-100 text-fuchsia-800","bg-cyan-100 text-cyan-800","bg-red-200 text-red-900","bg-blue-200 text-blue-900","bg-green-200 text-green-900","bg-purple-200 text-purple-900"],X=a=>a?Array.isArray(a)?a:"string"==typeof a?[a]:[]:[];function Y(){let a=(0,d.useParams)(),f=(0,d.useRouter)(),{isAuthenticated:t,isLoading:u,user:v}=(0,r.useAuth)(),w=decodeURIComponent(a.kraId),[x,y]=(0,c.useState)(null),[z,A]=(0,c.useState)(!1),[B,C]=(0,c.useState)(null),[D,E]=(0,c.useState)(!1),[F,G]=(0,c.useState)(new Date().getFullYear()),[H,I]=(0,c.useState)(0),[J,K]=(0,c.useState)({}),[L,M]=(0,c.useState)({}),[N,O]=(0,c.useState)(null),[Q,R]=(0,c.useState)({}),[S,T]=(0,c.useState)(null),[U,Y]=(0,c.useState)({}),[Z,$]=(0,c.useState)(null),_=(0,c.useCallback)((a,b,c)=>{if(!B)return 0;let d=B.initiatives?.find(b=>b.id===a);if(!d)return 0;if(!c)return(d.progress?.filter(a=>a.year===b)||[]).reduce((a,b)=>a+("number"==typeof b.currentValue?b.currentValue:parseFloat(String(b.currentValue))||0),0);{let a=d.progress?.find(a=>a.year===b&&a.quarter===c);return a?.currentValue??0}},[B]),aa=(0,c.useCallback)((a,b,c)=>{if(!B)return"none";let d=B.initiatives?.find(b=>b.id===a);if(!d)return"none";if(c){let a=d.progress?.find(a=>a.year===b&&a.quarter===c);return a?.valueSource||"none"}{let a=d.progress?.filter(a=>a.year===b)||[];return a.some(a=>"manual"===a.valueSource)?"manual":a.some(a=>"qpro"===a.valueSource)?"qpro":"none"}},[B]),ab=(0,c.useCallback)(async(a,b,c,d,e,f)=>{let g=`${a}-${b}-${c}`;O(g);try{let h=await s.default.getAccessToken(),i=await fetch("/api/kpi-progress",{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${h}`},body:JSON.stringify({kraId:w,initiativeId:a,year:b,quarter:c,value:d,reason:e,targetType:f})});if(!i.ok){let a={};try{a=await i.json()}catch{a={message:`HTTP ${i.status}`}}return console.error("Failed to save override:",a,"Status:",i.status),!1}M(a=>{let b={...a};return delete b[g],b});let j=new URLSearchParams({kraId:w,year:F.toString(),_t:Date.now().toString()}),k=await fetch(`/api/kpi-progress?${j}`,{headers:{Authorization:`Bearer ${h}`}});if(k.ok){let a=await k.json();C(a.data)}return!0}catch(a){return console.error("Error saving manual override:",a),!1}finally{O(null)}},[w,F]),ac=(0,c.useCallback)((a,b,c,d)=>{let e=`${a}-${b}-${c}`,f=""===d?0:d;M(a=>({...a,[e]:{value:f}}))},[]),ad=(0,c.useCallback)((a,b,c)=>{let d=`${a}-${b}-${c}`;return void 0!==L[d]?L[d].value:_(a,b,c)},[L,_]),ae=(0,c.useCallback)((a,b,c)=>void 0!==L[`${a}-${b}-${c}`],[L]);(0,c.useCallback)(()=>{M({})},[]);let af=(0,c.useCallback)(async()=>{try{let a=await s.default.getAccessToken(),b=new URLSearchParams({kraId:w}),c=await fetch(`/api/kpi-targets?${b}`,{headers:{Authorization:`Bearer ${a}`}});if(c.ok){let a=await c.json(),b={};a.targets?.forEach(a=>{b[`${a.initiative_id}-${a.year}-${a.quarter||"annual"}`]=a}),R(b)}}catch(a){console.error("Error fetching KPI targets:",a)}},[w]),ag=(0,c.useCallback)((a,b,c,d)=>{let e=`${a}-${b}-${c}`;if(void 0!==U[e])return U[e];let f=Q[e];return f?f.target_value:d},[U,Q]),ah=(0,c.useCallback)((a,b,c,d)=>{let e=`${a}-${b}-${c}`;Y(a=>({...a,[e]:d}))},[]),ai=(0,c.useCallback)(async(a,b,c,d,e,f)=>{let g=`${a}-${b}-${c}`;$(g);try{let h=await s.default.getAccessToken(),i=await fetch("/api/kpi-targets",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${h}`},body:JSON.stringify({kra_id:w,initiative_id:a,year:b,quarter:c,target_value:d,target_type:e,description:f})});if(i.ok)return Y(a=>{let b={...a};return delete b[g],b}),await af(),T(null),!0;{let a=await i.json();return console.error("Failed to save target:",a),!1}}catch(a){return console.error("Error saving target:",a),!1}finally{$(null)}},[w,af]),aj=(0,c.useCallback)(()=>{Y({}),T(null)},[]),ak=q.default.kras||[],al=a=>{let b=decodeURIComponent(a),c=b.match(/KRA\s*(\d+)/i);return c?`KRA ${c[1]}`:b},am=al(w),an=ak.find(a=>al(a.kra_id)===am)||null,ao=an?W[(parseInt(an.kra_id.split(" ")[1])-1)%W.length]:W[0],ap=(0,c.useMemo)(()=>{if(!an)return[new Date().getFullYear()];let a=new Set;an.initiatives.forEach(b=>{b.targets?.timeline_data?.forEach(b=>a.add(b.year))});let b=Array.from(a).sort();return b.length>0?b:[new Date().getFullYear()]},[an]);return((0,c.useEffect)(()=>{ap.length>0&&!ap.includes(F)&&G(ap[0])},[ap,F]),(0,c.useEffect)(()=>{!t||u||(async()=>{try{A(!0);let a=await s.default.getAccessToken(),b=await fetch(`/api/qpro-analyses?kraId=${w}`,{headers:{Authorization:`Bearer ${a}`}});if(b.ok){let a=await b.json();y(a)}}catch(a){console.error("Error fetching analysis data:",a)}finally{A(!1)}})()},[w,t,u]),(0,c.useEffect)(()=>{t&&!u&&w&&((async()=>{try{E(!0);let a=await s.default.getAccessToken(),b=new URLSearchParams({kraId:w,year:F.toString(),_t:Date.now().toString()}),c=await fetch(`/api/kpi-progress?${b}`,{headers:{Authorization:`Bearer ${a}`,"Cache-Control":"no-cache"}});if(c.ok){let a=await c.json();C(a.data);let b={};for(let c of a.data.initiatives||[])for(let a of(c.progress||[]).filter(a=>a.year===F))b[`${c.id}-${a.year}-${a.quarter}`]=a.currentValue||0;K(b)}}catch(a){console.error("Error fetching KPI progress:",a)}finally{E(!1)}})(),af())},[w,t,u,F,af,H]),(0,c.useEffect)(()=>{let a=()=>{"visible"===document.visibilityState&&t&&!u&&I(a=>a+1)};return document.addEventListener("visibilitychange",a),()=>document.removeEventListener("visibilitychange",a)},[t,u]),u)?(0,b.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,b.jsx)("div",{className:"text-lg text-gray-600",children:"Loading..."})}):t?an?(0,b.jsxs)("div",{className:"min-h-screen bg-gray-50 p-4 sm:p-8",children:[(0,b.jsxs)(p.Button,{variant:"outline",onClick:()=>f.back(),className:"mb-6",children:[(0,b.jsx)(g,{className:"w-4 h-4 mr-2"}),"Back to Strategic Commitments"]}),(0,b.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 p-6 sm:p-8 mb-8",children:(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-start gap-4",children:[(0,b.jsx)(o.Badge,{className:`${ao} text-lg font-bold w-fit`,children:an.kra_id}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900 mb-3",children:an.kra_title}),(0,b.jsx)("div",{className:"bg-gray-100 rounded p-4",children:(0,b.jsxs)("p",{className:"text-gray-700 text-sm sm:text-base",children:[(0,b.jsx)("span",{className:"font-semibold",children:"Guiding Principle: "}),an.guiding_principle]})})]})]})}),(0,b.jsx)("div",{className:"mb-8",children:(0,b.jsx)("div",{className:"flex items-center gap-2 overflow-x-auto pb-2 no-scrollbar",children:ap.map(a=>(0,b.jsx)("button",{onClick:()=>G(a),className:(0,e.cn)("px-6 py-2 rounded-full text-sm font-medium transition-all whitespace-nowrap",F===a?"bg-blue-600 text-white shadow-md ring-2 ring-blue-600 ring-offset-2":"bg-white text-gray-600 hover:bg-gray-100 border border-gray-200 hover:border-gray-300"),children:a},a))})}),(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Key Performance Indicators (KPIs)"}),an.initiatives&&an.initiatives.length>0?(0,b.jsx)("div",{className:"grid gap-6",children:an.initiatives.map((a,c)=>{let d,f,g,h,o=B?.initiatives?.find(b=>b.id===a.id),q=a.targets?.timeline_data?.find(a=>a.year===F),r=o?.progress?.filter(a=>a.year===F)||[],s=r.reduce((a,b)=>a+("number"==typeof b.currentValue?b.currentValue:parseFloat(String(b.currentValue))||0),0),t=q?function(a){if("number"==typeof a)return a;let b=parseFloat(a.replace(/[₱$,\s]/g,"").replace(/PHP/gi,"").trim());return isNaN(b)?0:b}(q.target_value):0,u=t>0?Math.min(100,Math.round(s/t*100)):0;return(0,b.jsxs)("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden mb-8",children:[(0,b.jsxs)("div",{className:"p-6 border-b border-gray-100",children:[(0,b.jsxs)("div",{className:"flex flex-col md:flex-row md:items-start justify-between gap-4 mb-6",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("h3",{className:"text-xl font-bold text-gray-900",children:a.id}),(0,b.jsxs)("div",{className:"mt-3 space-y-2",children:[(0,b.jsx)("div",{className:"bg-blue-50/50 p-3 rounded-md border border-blue-100",children:(0,b.jsxs)("p",{className:"text-sm text-gray-800",children:[(0,b.jsx)("span",{className:"font-bold text-blue-800 uppercase text-xs tracking-wide block mb-1",children:"Output"}),a.key_performance_indicator?.outputs]})}),(0,b.jsx)("div",{className:"bg-green-50/50 p-3 rounded-md border border-green-100",children:(0,b.jsxs)("p",{className:"text-sm text-gray-800",children:[(0,b.jsx)("span",{className:"font-bold text-green-800 uppercase text-xs tracking-wide block mb-1",children:"Outcome"}),a.key_performance_indicator?.outcomes]})})]})]}),(0,b.jsx)("div",{className:"flex items-center gap-2 shrink-0",children:(0,b.jsxs)(p.Button,{size:"sm",variant:"outline",onClick:()=>I(a=>a+1),disabled:D,className:"flex items-center gap-1 text-blue-600 border-blue-300 hover:bg-blue-50",children:[(0,b.jsx)(l.RefreshCw,{className:`h-3 w-3 ${D?"animate-spin":""}`}),"Refresh"]})})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,b.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 border-l-4 border-purple-500 h-full",children:[(0,b.jsxs)("h4",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-3 flex items-center gap-2",children:[(0,b.jsx)(i.TrendingUp,{className:"w-3 h-3"})," Strategies"]}),(0,b.jsx)("ul",{className:"text-sm text-gray-700 space-y-2 pl-1",children:X(a.strategies).map((a,c)=>(0,b.jsxs)("li",{className:"flex gap-2",children:[(0,b.jsx)("span",{className:"text-purple-400 mt-1",children:"•"}),(0,b.jsx)("span",{children:a})]},c))})]}),(0,b.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 border-l-4 border-blue-500 h-full",children:[(0,b.jsxs)("h4",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-3 flex items-center gap-2",children:[(0,b.jsx)(m,{className:"w-3 h-3"})," Activities"]}),(0,b.jsx)("ul",{className:"text-sm text-gray-700 space-y-2 pl-1",children:X(a.programs_activities).map((a,c)=>(0,b.jsxs)("li",{className:"flex gap-2",children:[(0,b.jsx)("span",{className:"text-blue-400 mt-1",children:"•"}),(0,b.jsx)("span",{children:a})]},c))})]}),(0,b.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 border-l-4 border-green-500 h-full",children:[(0,b.jsxs)("h4",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-3 flex items-center gap-2",children:[(0,b.jsx)(n.Building2,{className:"w-3 h-3"})," Responsible Offices"]}),(0,b.jsx)("ul",{className:"text-sm text-gray-700 space-y-2 pl-1",children:X(a.responsible_offices).map((a,c)=>(0,b.jsxs)("li",{className:"flex gap-2",children:[(0,b.jsx)("span",{className:"text-green-400 mt-1",children:"•"}),(0,b.jsx)("span",{children:a})]},c))})]})]})]}),q?(0,b.jsx)("div",{className:"bg-blue-50/50 p-6 border-b border-gray-100",children:(0,b.jsx)("div",{className:"flex flex-col md:flex-row items-center justify-between gap-8",children:(0,b.jsxs)("div",{className:"flex items-center gap-6",children:[(0,b.jsxs)("div",{className:"relative w-24 h-24 flex items-center justify-center",children:[(0,b.jsxs)("svg",{className:"w-full h-full transform -rotate-90",children:[(0,b.jsx)("circle",{cx:"48",cy:"48",r:"40",stroke:"currentColor",strokeWidth:"8",fill:"transparent",className:"text-gray-200"}),(0,b.jsx)("circle",{cx:"48",cy:"48",r:"40",stroke:"currentColor",strokeWidth:"8",fill:"transparent",strokeDasharray:251.2,strokeDashoffset:251.2-251.2*u/100,className:u>=100?"text-green-500":"text-blue-500"})]}),(0,b.jsx)("div",{className:"absolute inset-0 flex items-center justify-center flex-col",children:(0,b.jsxs)("span",{className:"text-xl font-bold text-gray-900",children:[u,"%"]})})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("h4",{className:"text-lg font-semibold text-gray-900",children:[F," Overview"]}),(0,b.jsxs)("div",{className:"flex items-baseline gap-2 mt-1",children:[(0,b.jsx)("span",{className:"text-3xl font-bold text-gray-900",children:s}),(0,b.jsx)("span",{className:"text-gray-500",children:"/"}),(f=S===(d=`${a.id}-${q.year}-1`),g=ag(a.id,q.year,1,q.target_value),h=v&&("ADMIN"===v.role||"FACULTY"===v.role),f?(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("input",{type:"number",className:"w-24 px-2 py-1 border border-blue-500 rounded text-lg font-bold focus:outline-none",value:U[d]??g,onChange:b=>ah(a.id,q.year,1,parseFloat(b.target.value)||0),autoFocus:!0}),(0,b.jsx)(p.Button,{size:"sm",onClick:()=>ai(a.id,q.year,1,"number"==typeof(U[d]??g)?U[d]??g:parseFloat(String(U[d]??g))||0,V(a.targets?.type||"count"),a.key_performance_indicator?.outputs),disabled:Z===d,children:"Save"}),(0,b.jsx)(p.Button,{size:"sm",variant:"ghost",onClick:aj,children:"Cancel"})]}):(0,b.jsxs)("div",{className:"flex items-center gap-2 group",children:[(0,b.jsx)("span",{className:"text-xl font-medium text-gray-600",children:"number"==typeof g?g.toLocaleString():g}),h&&(0,b.jsx)("button",{onClick:()=>T(d),className:"opacity-0 group-hover:opacity-100 text-blue-600 hover:text-blue-800 transition-opacity",children:(0,b.jsx)(k.FileText,{className:"w-4 h-4"})})]})),(0,b.jsx)("span",{className:"text-sm text-gray-500 ml-1",children:a.targets.unit_basis})]})]})]})})}):(0,b.jsxs)("div",{className:"p-6 text-center text-gray-500",children:["No target data for ",F]}),q&&(0,b.jsx)("div",{className:"p-6 bg-gray-50",children:(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[1,2,3,4].map(c=>{let d=r.find(a=>a.quarter===c),f=ad(a.id,q.year,c),g=d?.valueSource||aa(a.id,q.year,c),h=ae(a.id,q.year,c),i=N===`${a.id}-${q.year}-${c}`;a.targets.type,a.targets.currency,a.targets.low_count_threshold;let k=V(a.targets?.type||"count"),l=0!==f&&"0"!==f&&""!==f&&!h;return(0,b.jsxs)("div",{className:(0,e.cn)("bg-white rounded-lg border p-4 transition-all",l?"border-green-200 shadow-sm":"border-gray-200 shadow-sm","hover:border-blue-300 hover:shadow-md"),children:[(0,b.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,b.jsxs)("span",{className:(0,e.cn)("text-xs font-bold px-2 py-1 rounded uppercase",l?"bg-green-100 text-green-700":"bg-blue-100 text-blue-700"),children:["Q",c]}),"qpro"===g&&(0,b.jsxs)("span",{className:"text-xs text-green-600 font-medium flex items-center gap-1",children:[(0,b.jsx)(j.CheckCircle2,{className:"w-3 h-3"})," QPRO"]})]}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsx)("label",{className:"text-xs font-medium text-gray-500 uppercase",children:"Actual Value"}),(0,b.jsx)("div",{className:"flex items-center gap-2",children:(0,b.jsx)(P,{targetType:k,value:f??"",onChange:b=>ac(a.id,q.year,c,b),placeholder:"0",className:"text-lg font-semibold h-10"})}),h&&(0,b.jsx)(p.Button,{size:"sm",className:"w-full mt-2",onClick:()=>{let b=L[`${a.id}-${q.year}-${c}`]?.value,d=null;if("MILESTONE"===k)d=+(1===b||"1"===b);else if("TEXT_CONDITION"===k)d=b?String(b):null;else{let a="string"==typeof b?parseFloat(b.replace(/,/g,"")):b;d="number"!=typeof a||Number.isNaN(a)?null:a}let e=_(a.id,q.year,c);"number"==typeof d&&0===d&&0===e&&(d=null),ab(a.id,q.year,c,d,void 0,k)},disabled:i,children:i?"Saving...":"Save Changes"})]})]},c)})})})]},c)})}):(0,b.jsx)("div",{className:"bg-white rounded-lg border border-gray-300 p-8 text-center",children:(0,b.jsx)("p",{className:"text-gray-600",children:"No KPIs found for this KRA."})})]})]}):(0,b.jsxs)("div",{className:"min-h-screen bg-gray-50 p-8",children:[(0,b.jsxs)(p.Button,{variant:"outline",onClick:()=>f.back(),className:"mb-4",children:[(0,b.jsx)(g,{className:"w-4 h-4 mr-2"}),"Back to Strategic Commitments"]}),(0,b.jsx)("div",{className:"bg-white rounded-lg border border-gray-300 p-8",children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)(h.AlertCircle,{className:"w-6 h-6 text-red-500"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"KRA Not Found"}),(0,b.jsx)("p",{className:"text-gray-600 mt-1",children:"The requested KRA could not be found."})]})]})})]}):(0,b.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,b.jsx)("div",{className:"text-lg text-gray-600",children:"Please log in to view this page."})})}a.s(["default",()=>Y],38575)}];

//# sourceMappingURL=app_qpro_kra_%5BkraId%5D_page_tsx_e0e2d258._.js.map